{"ast":null,"code":"\"use strict\"; // The MIT License (MIT)\n//\n// Copyright (c) 2017 Firebase\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ObjectBuilder = exports.BucketBuilder = exports._objectWithOptions = exports._bucketWithOptions = exports.object = exports.bucket = exports.service = exports.provider = void 0;\n\nconst cloud_functions_1 = require(\"../cloud-functions\");\n\nconst config_1 = require(\"../config\");\n/** @hidden */\n\n\nexports.provider = 'google.storage';\n/** @hidden */\n\nexports.service = 'storage.googleapis.com';\n/**\n * Registers a Cloud Function scoped to a specific storage bucket.\n *\n * @param bucket Name of the bucket to which this Cloud Function is\n *   scoped.\n *\n * @return Storage bucket builder interface.\n */\n\nfunction bucket(bucket) {\n  return _bucketWithOptions({}, bucket);\n}\n\nexports.bucket = bucket;\n/**\n * Registers a Cloud Function scoped to the default storage bucket for the\n * project.\n *\n * @return Storage object builder interface.\n */\n\nfunction object() {\n  return _objectWithOptions({});\n}\n\nexports.object = object;\n/** @hidden */\n\nfunction _bucketWithOptions(options, bucket) {\n  const resourceGetter = () => {\n    bucket = bucket || config_1.firebaseConfig().storageBucket;\n\n    if (!bucket) {\n      throw new Error('Missing bucket name. If you are unit testing, please provide a bucket name' + ' through `functions.storage.bucket(bucketName)`, or set process.env.FIREBASE_CONFIG.');\n    }\n\n    if (!/^[a-z\\d][a-z\\d\\\\._-]{1,230}[a-z\\d]$/.test(bucket)) {\n      throw new Error(`Invalid bucket name ${bucket}`);\n    }\n\n    return `projects/_/buckets/${bucket}`;\n  };\n\n  return new BucketBuilder(resourceGetter, options);\n}\n\nexports._bucketWithOptions = _bucketWithOptions;\n/** @hidden */\n\nfunction _objectWithOptions(options) {\n  return _bucketWithOptions(options).object();\n}\n\nexports._objectWithOptions = _objectWithOptions;\n/**\n * The Google Cloud Storage bucket builder interface.\n *\n * Access via [`functions.storage.bucket()`](providers_storage_.html#bucket).\n */\n\nclass BucketBuilder {\n  /** @hidden */\n  constructor(triggerResource, options) {\n    this.triggerResource = triggerResource;\n    this.options = options;\n  }\n  /**\n   * Event handler which fires every time a Google Cloud Storage change occurs.\n   *\n   * @return Storage object builder interface scoped to the specified storage\n   *   bucket.\n   */\n\n\n  object() {\n    return new ObjectBuilder(this.triggerResource, this.options);\n  }\n\n}\n\nexports.BucketBuilder = BucketBuilder;\n/**\n * The Google Cloud Storage object builder interface.\n *\n * Access via [`functions.storage.object()`](providers_storage_.html#object).\n */\n\nclass ObjectBuilder {\n  /** @hidden */\n  constructor(triggerResource, options) {\n    this.triggerResource = triggerResource;\n    this.options = options;\n  }\n  /** @hidden */\n\n\n  onChange(handler) {\n    throw new Error('\"onChange\" is now deprecated, please use \"onArchive\", \"onDelete\", ' + '\"onFinalize\", or \"onMetadataUpdate\".');\n  }\n  /**\n   * Event handler sent only when a bucket has enabled object versioning.\n   * This event indicates that the live version of an object has become an\n   * archived version, either because it was archived or because it was\n   * overwritten by the upload of an object of the same name.\n   *\n   * @param handler Event handler which is run every time a Google Cloud Storage\n   *   archival occurs.\n   *\n   * @return A Cloud Function which you can export and deploy.\n   */\n\n\n  onArchive(handler) {\n    return this.onOperation(handler, 'object.archive');\n  }\n  /**\n   * Event handler which fires every time a Google Cloud Storage deletion occurs.\n   *\n   * Sent when an object has been permanently deleted. This includes objects\n   * that are overwritten or are deleted as part of the bucket's lifecycle\n   * configuration. For buckets with object versioning enabled, this is not\n   * sent when an object is archived, even if archival occurs\n   * via the `storage.objects.delete` method.\n   *\n   * @param handler Event handler which is run every time a Google Cloud Storage\n   *   deletion occurs.\n   *\n   * @return A Cloud Function which you can export and deploy.\n   */\n\n\n  onDelete(handler) {\n    return this.onOperation(handler, 'object.delete');\n  }\n  /**\n   * Event handler which fires every time a Google Cloud Storage object\n   * creation occurs.\n   *\n   * Sent when a new object (or a new generation of an existing object)\n   * is successfully created in the bucket. This includes copying or rewriting\n   * an existing object. A failed upload does not trigger this event.\n   *\n   * @param handler Event handler which is run every time a Google Cloud Storage\n   *   object creation occurs.\n   *\n   * @return A Cloud Function which you can export and deploy.\n   */\n\n\n  onFinalize(handler) {\n    return this.onOperation(handler, 'object.finalize');\n  }\n  /**\n   * Event handler which fires every time the metadata of an existing object\n   * changes.\n   *\n   * @param handler Event handler which is run every time a Google Cloud Storage\n   *   metadata update occurs.\n   *\n   * @return A Cloud Function which you can export and deploy.\n   */\n\n\n  onMetadataUpdate(handler) {\n    return this.onOperation(handler, 'object.metadataUpdate');\n  }\n  /** @hidden */\n\n\n  onOperation(handler, eventType) {\n    return cloud_functions_1.makeCloudFunction({\n      handler,\n      provider: exports.provider,\n      service: exports.service,\n      eventType,\n      triggerResource: this.triggerResource,\n      options: this.options\n    });\n  }\n\n}\n\nexports.ObjectBuilder = ObjectBuilder;","map":{"version":3,"sources":["/Users/aep/phd/hearth-mici/node_modules/firebase-functions/lib/providers/storage.js"],"names":["Object","defineProperty","exports","value","ObjectBuilder","BucketBuilder","_objectWithOptions","_bucketWithOptions","object","bucket","service","provider","cloud_functions_1","require","config_1","options","resourceGetter","firebaseConfig","storageBucket","Error","test","constructor","triggerResource","onChange","handler","onArchive","onOperation","onDelete","onFinalize","onMetadataUpdate","eventType","makeCloudFunction"],"mappings":"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","sourcesContent":["\"use strict\";\n// The MIT License (MIT)\n//\n// Copyright (c) 2017 Firebase\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ObjectBuilder = exports.BucketBuilder = exports._objectWithOptions = exports._bucketWithOptions = exports.object = exports.bucket = exports.service = exports.provider = void 0;\nconst cloud_functions_1 = require(\"../cloud-functions\");\nconst config_1 = require(\"../config\");\n/** @hidden */\nexports.provider = 'google.storage';\n/** @hidden */\nexports.service = 'storage.googleapis.com';\n/**\n * Registers a Cloud Function scoped to a specific storage bucket.\n *\n * @param bucket Name of the bucket to which this Cloud Function is\n *   scoped.\n *\n * @return Storage bucket builder interface.\n */\nfunction bucket(bucket) {\n    return _bucketWithOptions({}, bucket);\n}\nexports.bucket = bucket;\n/**\n * Registers a Cloud Function scoped to the default storage bucket for the\n * project.\n *\n * @return Storage object builder interface.\n */\nfunction object() {\n    return _objectWithOptions({});\n}\nexports.object = object;\n/** @hidden */\nfunction _bucketWithOptions(options, bucket) {\n    const resourceGetter = () => {\n        bucket = bucket || config_1.firebaseConfig().storageBucket;\n        if (!bucket) {\n            throw new Error('Missing bucket name. If you are unit testing, please provide a bucket name' +\n                ' through `functions.storage.bucket(bucketName)`, or set process.env.FIREBASE_CONFIG.');\n        }\n        if (!/^[a-z\\d][a-z\\d\\\\._-]{1,230}[a-z\\d]$/.test(bucket)) {\n            throw new Error(`Invalid bucket name ${bucket}`);\n        }\n        return `projects/_/buckets/${bucket}`;\n    };\n    return new BucketBuilder(resourceGetter, options);\n}\nexports._bucketWithOptions = _bucketWithOptions;\n/** @hidden */\nfunction _objectWithOptions(options) {\n    return _bucketWithOptions(options).object();\n}\nexports._objectWithOptions = _objectWithOptions;\n/**\n * The Google Cloud Storage bucket builder interface.\n *\n * Access via [`functions.storage.bucket()`](providers_storage_.html#bucket).\n */\nclass BucketBuilder {\n    /** @hidden */\n    constructor(triggerResource, options) {\n        this.triggerResource = triggerResource;\n        this.options = options;\n    }\n    /**\n     * Event handler which fires every time a Google Cloud Storage change occurs.\n     *\n     * @return Storage object builder interface scoped to the specified storage\n     *   bucket.\n     */\n    object() {\n        return new ObjectBuilder(this.triggerResource, this.options);\n    }\n}\nexports.BucketBuilder = BucketBuilder;\n/**\n * The Google Cloud Storage object builder interface.\n *\n * Access via [`functions.storage.object()`](providers_storage_.html#object).\n */\nclass ObjectBuilder {\n    /** @hidden */\n    constructor(triggerResource, options) {\n        this.triggerResource = triggerResource;\n        this.options = options;\n    }\n    /** @hidden */\n    onChange(handler) {\n        throw new Error('\"onChange\" is now deprecated, please use \"onArchive\", \"onDelete\", ' +\n            '\"onFinalize\", or \"onMetadataUpdate\".');\n    }\n    /**\n     * Event handler sent only when a bucket has enabled object versioning.\n     * This event indicates that the live version of an object has become an\n     * archived version, either because it was archived or because it was\n     * overwritten by the upload of an object of the same name.\n     *\n     * @param handler Event handler which is run every time a Google Cloud Storage\n     *   archival occurs.\n     *\n     * @return A Cloud Function which you can export and deploy.\n     */\n    onArchive(handler) {\n        return this.onOperation(handler, 'object.archive');\n    }\n    /**\n     * Event handler which fires every time a Google Cloud Storage deletion occurs.\n     *\n     * Sent when an object has been permanently deleted. This includes objects\n     * that are overwritten or are deleted as part of the bucket's lifecycle\n     * configuration. For buckets with object versioning enabled, this is not\n     * sent when an object is archived, even if archival occurs\n     * via the `storage.objects.delete` method.\n     *\n     * @param handler Event handler which is run every time a Google Cloud Storage\n     *   deletion occurs.\n     *\n     * @return A Cloud Function which you can export and deploy.\n     */\n    onDelete(handler) {\n        return this.onOperation(handler, 'object.delete');\n    }\n    /**\n     * Event handler which fires every time a Google Cloud Storage object\n     * creation occurs.\n     *\n     * Sent when a new object (or a new generation of an existing object)\n     * is successfully created in the bucket. This includes copying or rewriting\n     * an existing object. A failed upload does not trigger this event.\n     *\n     * @param handler Event handler which is run every time a Google Cloud Storage\n     *   object creation occurs.\n     *\n     * @return A Cloud Function which you can export and deploy.\n     */\n    onFinalize(handler) {\n        return this.onOperation(handler, 'object.finalize');\n    }\n    /**\n     * Event handler which fires every time the metadata of an existing object\n     * changes.\n     *\n     * @param handler Event handler which is run every time a Google Cloud Storage\n     *   metadata update occurs.\n     *\n     * @return A Cloud Function which you can export and deploy.\n     */\n    onMetadataUpdate(handler) {\n        return this.onOperation(handler, 'object.metadataUpdate');\n    }\n    /** @hidden */\n    onOperation(handler, eventType) {\n        return cloud_functions_1.makeCloudFunction({\n            handler,\n            provider: exports.provider,\n            service: exports.service,\n            eventType,\n            triggerResource: this.triggerResource,\n            options: this.options,\n        });\n    }\n}\nexports.ObjectBuilder = ObjectBuilder;\n"]},"metadata":{},"sourceType":"script"}
{"ast":null,"code":"import _classCallCheck from\"/Users/aep/phd/hearth-mici/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/aep/phd/hearth-mici/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _slicedToArray from\"/Users/aep/phd/hearth-mici/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _createForOfIteratorHelper from\"/Users/aep/phd/hearth-mici/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";/* eslint eqeqeq: \"off\", no-unused-vars: \"off\" */ //to fix totalHeight bug, change p5 by changing o-totalHeight to just o\n//todo: fix this on a generic p5 import somehow\n//todo: language stuff\n//todo: buttons\n//todo: creature types\n//todo: card types\n//todo: effect limit\n//ABC test reports, articulate logic for report design\n//make rampiness, variety, controllynes and see when they would be useful\nexport default function sketch(p){var buttons=[];var button_id=1;var effects=[];var current_task_index=0;var task_details=[{id:0,title:\"3 Hunter Cards\",instruction:\"Design three cards for hunter\",num_cards:3,class:\"hunter\"},{id:1,title:\"3 Warrior Cards\",instruction:\"Design three cards for warrior\",num_cards:3,class:\"warrior\"},{id:2,title:\"3 Mage Cards\",instruction:\"Design three cards for mage\",num_cards:3,class:\"mage\"},{id:3,title:\"3 Neutral Cards\",instruction:\"Design three neutral cards\",num_cards:3,class:\"all\"}];var user=\"\";var tasks=[];var card_types=[\"spell\",\"minion\",\"weapon\"];var method_names=[\"randomly\",\"targeted\",\"all\"];var target_names=[\"minions\",\"heroes\",\"minions or heroes\",\"pirates\",\"beasts\",\"elementals\",\"totems\",\"weapons\"];var target_names_singular=[\"minion\",\"hero\",\"minion or hero\",\"pirate\",\"beast\",\"elemental\",\"totem\",\"weapon\"];var filter_names=[\"enemy\",\"friendly\",\"all\"];var duration_names=[\"turn\",\"permanently\"];var param_format_names=[\"x\",\"x/x\",\"k\",\"c\"];var effect_names=[\"Deal damage\",\"Destroy\",\"Restore health\",\"Gain armour\",\"Change stats\",\"Set stats\",\"Give keyword\",\"Return to hand\",\"Draw\",\"Gain mana\",\"Summon: \",\"Battlecry: \",\"Deathrattle: \"];var keywords=[\"Taunt\",\"Charge\",\"Lifesteal\",\"Spell damage +1\",\"Divine shield\",\"Poisonous\",\"Windfury\",\"Frozen\"];var all_creature_types=[\"pirate\",\"beast\",\"elemental\",\"totem\",\"dragon\",\"pirate\",\"mech\",\"elemental\"];var creature_types=[\"Pirate\",\"Beast\",\"Elemental\",\"Totem\"];var survey_topics=[\"none\",\"methods\",\"filters\",\"targets\",\"duration\",\"params\"];var current_survey_topic=0;var survey_drop_target=null;var font_pixels_large=32;var font_pixels=24;var font_pixels_small=20;var hearthstone_font;var mouse_padding=1;var w_padding,h_padding;var grid_w_padding,grid_h_padding;var rect_mask,ellipse_mask;var blank_spell_img,blank_creature_img,blank_weapon_img,full_blank_creature_img;var bg;var gan_imgs=[];var the_mouse;var setup_done=false;var hovered_option=-1;var editing=\"none\";var editing_card=null;var effect_to_remove=null;var editX=0;var editY=0;var sending=false;var send_start_time=-10000;var estimated_send_duration=3000;//over-estimate\nvar sent=false;var mouse_over_queuer;var mouse_over_next;var mouse_over_prev;var props;p.myCustomRedrawAccordingToNewPropsHandler=function(_props){props=_props;};p.preload=function(){bg=p.loadImage(props.bg_img);blank_spell_img=p.loadImage(props.spell_img);blank_weapon_img=p.loadImage(props.weapon_img);blank_creature_img=p.loadImage(props.creature_img);full_blank_creature_img=p.loadImage(props.full_blank_creature_img);hearthstone_font=p.loadFont(props.hs_font);var _iterator=_createForOfIteratorHelper(props.gan_imgs),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var im=_step.value;gan_imgs.push(p.loadImage(im));}}catch(err){_iterator.e(err);}finally{_iterator.f();}};p.setup=function(){var _p$getURLParams$user;p.createCanvas(p.windowWidth,p.windowHeight);user=(_p$getURLParams$user=p.getURLParams().user)!==null&&_p$getURLParams$user!==void 0?_p$getURLParams$user:2;the_mouse=new p.FancyMouse();h_padding=p.height*0.1;w_padding=p.width*0.2;grid_h_padding=p.height*0.2;grid_w_padding=p.width*0.1;p.imageMode(p.CENTER);p.rectMode(p.CENTER);p.textFont(hearthstone_font);p.textSize(font_pixels);p.fill(255);p.noStroke();p.register_all();var _iterator2=_createForOfIteratorHelper(task_details),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var task=_step2.value;tasks[task.id]=[];for(var card_id=0;card_id<task.num_cards;card_id++){tasks[task.id].push(new p.Card(card_id,task.id,task.class));}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}p.load_save();//loads save file from google sheets if it exists\np.resize_all();setup_done=true;};p.draw=function(){p.resize_all();p.background(255);p.textAlign(p.LEFT,p.CENTER);p.image(bg,p.width/2,p.height/2,p.width,p.height);if(current_task_index<task_details.length){var _iterator3=_createForOfIteratorHelper(tasks[current_task_index]),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var c=_step3.value;c.run();}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}var _iterator4=_createForOfIteratorHelper(buttons),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var b=_step4.value;b.run();}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}p.textSize(font_pixels+4);p.text(\"Base attributes:\",w_padding/2,h_padding);p.text(\"Battlecrys:\",w_padding/2,p.map(3,0,16,h_padding,p.height-h_padding));}if(the_mouse.busy&&current_survey_topic==0){p.push();p.translate(p.mouseX-the_mouse.xOffset,p.mouseY-the_mouse.yOffset);p.textSize(28);p.text(the_mouse.effect.label_name,0,0);p.pop();}p.draw_edit_overlay();p.draw_task_controls();if(current_task_index==task_details.length){p.send_overlay();}else{p.draw_task_overlay();}if(survey_topics[current_survey_topic]!=\"none\"){p.draw_survey();}};p.draw_task_controls=function(){var next_x=p.width-w_padding;var next_y=p.height-h_padding;mouse_over_next=p.dist(p.mouseX,p.mouseY,next_x,next_y)<75;p.push();p.translate(next_x,next_y);p.fill(255,current_task_index==task_details.length?0:mouse_over_next?255:100);p.triangle(0,-25,0,25,75,0);p.pop();var prev_x=p.map(1,0,3,w_padding,p.width-w_padding);mouse_over_prev=p.dist(p.mouseX,p.mouseY,prev_x,next_y)<75;p.push();p.translate(prev_x,next_y);p.fill(255,current_task_index==0?50:mouse_over_prev?255:100);p.triangle(0,-25,0,25,-75,0);p.pop();};p.draw_task_overlay=function(){p.textAlign(p.RIGHT,p.CENTER);p.textSize(font_pixels);p.text(task_details[current_task_index].instruction,p.width-w_padding/2,h_padding);p.fill(0);p.textAlign(p.CENTER,p.CENTER);p.text(\"Task \".concat(current_task_index+1,\" \\\\ \").concat(task_details.length),p.map(2,0,3,w_padding,p.width-w_padding),p.height-h_padding);};p.draw_survey=function(){p.push();p.textAlign(p.CENTER,p.CENTER);p.textSize(font_pixels);p.rectMode(p.CENTER);p.background(0,100);var setting=the_mouse.effect.settings[survey_topics[current_survey_topic]];var options=setting[0];if(setting[0][0]==\"x\"){options=[1,2,3,4,5,6,7,8,9,10];}else if(setting[0][0]==\"k\"){options=keywords;}else if(setting[0][0]==\"c\"){options=creature_types;}if(options[0]==\"x/x\"){for(var attack=0;attack<=10;attack++){for(var defense=0;defense<=10;defense++){var xPos=p.map(attack,0,10,grid_w_padding,p.width-grid_w_padding);var yPos=p.map(defense,0,10,grid_h_padding,p.height-grid_h_padding);var box_width=(p.width-grid_w_padding*2)/10;var box_height=(p.height-grid_h_padding*2)/10;if(p.mouseX>xPos-box_width/2&&p.mouseX<xPos+box_width/2&&p.mouseY>yPos-box_height/2&&p.mouseY<yPos+box_height/2){p.fill(255,100);}else{p.fill(255,0);}p.rect(xPos,yPos,box_width,box_height);p.fill(255);p.text(attack+\"/\"+defense,xPos,yPos-10);}}}else{p.textSize(40);p.fill(255);p.text(the_mouse.effect.label_name+\"...\",p.width/2,p.height*0.1);p.textSize(font_pixels);p.rectMode(p.CENTER);var option_button_width=p.width/options.length*0.5;var option_button_height=p.height*0.10;var option_buttons_padding=p.width*0.25;var _iterator5=_createForOfIteratorHelper(options.entries()),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _step5$value=_slicedToArray(_step5.value,2),index=_step5$value[0],option=_step5$value[1];var _xPos=p.map(index,0,options.length-1,option_buttons_padding,p.width-option_buttons_padding);if(p.mouseX>_xPos-option_button_width/2&&p.mouseX<_xPos+option_button_width/2){p.fill(255,100);hovered_option=index;}else{p.fill(255,50);}p.rect(_xPos,p.height*0.5,option_button_width,option_button_height,16);p.fill(255);var option_string=option.toString();option_string=option_string[0].toUpperCase()+option_string.substring(1);option_string=option_string.split(\" \").join(\"\\n\");p.text(option_string,_xPos,p.height/2);}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}}p.pop();};p.mouse_pressed_while_surveying=function(){if(p.progress_survey_through_issues()){return;}var setting=the_mouse.effect.settings[survey_topics[current_survey_topic]];var options=setting[0];if(options[0]==\"x\"){options=[1,2,3,4,5,6,7,8,9,10];}else if(options[0]==\"k\"){options=keywords;}else if(options[0]==\"c\"){options=creature_types;}if(options[0]==\"x/x\"){var selectedAttack=0;var selectedDefense=0;for(var attack=0;attack<=10;attack++){for(var defense=0;defense<=10;defense++){var xPos=p.map(attack,0,10,grid_w_padding,p.width-grid_w_padding);var yPos=p.map(defense,0,10,grid_h_padding,p.height-grid_h_padding);var box_width=(p.width-grid_w_padding*2)/10;var box_height=(p.height-grid_h_padding*2)/10;if(p.mouseX>xPos-box_width/2&&p.mouseX<xPos+box_width/2&&p.mouseY>yPos-box_height/2&&p.mouseY<yPos+box_height/2){selectedAttack=attack;selectedDefense=defense;break;}}}setting[1]=\"\".concat(selectedAttack,\"/\").concat(selectedDefense);}else{setting[1]=options[hovered_option];}current_survey_topic++;if(p.progress_survey_through_issues()){return;}};p.mouse_pressed_while_not_surveying=function(){var clicked_card=null;if(current_task_index<task_details.length){var _iterator6=_createForOfIteratorHelper(tasks[current_task_index]),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var c=_step6.value;if(c.mouseInImg()){clicked_card=c;}}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}}if(clicked_card){if(the_mouse.busy){//dropping effect onto a card\np.drop_effect_on_card(clicked_card);}else{//clicking on a card generally\np.click_to_edit_card(clicked_card);}}else{if(the_mouse.busy){//clicked away to drop label\nthe_mouse.busy=false;the_mouse.setOffset(0,0);the_mouse.effect=null;}else{//other clicks\nif(mouse_over_next&&current_task_index<task_details.length){current_task_index++;}else if(mouse_over_prev&&current_task_index>0){current_task_index--;}if(mouse_over_queuer&&current_task_index==task_details.length&&!sending){p.submit();}p.mouse_click_while_editing();var _iterator7=_createForOfIteratorHelper(buttons),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var b=_step7.value;//clicking on a button with an empty hand\nif(b.mouseInRegion()){the_mouse.busy=true;the_mouse.setOffset(b.text_x,b.text_y);the_mouse.effect=JSON.parse(JSON.stringify(effects[b.button_name]));break;}}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}}}};//returns true if you need to return out of mouse\np.progress_survey_through_issues=function(){if(current_survey_topic==survey_topics.length){p.finished_survey();return true;}for(var i=0;i<survey_topics.length;i++){if(the_mouse.effect.settings[survey_topics[current_survey_topic]][0]==null||!param_format_names.includes(the_mouse.effect.settings[survey_topics[current_survey_topic]][0][0])&&the_mouse.effect.settings[survey_topics[current_survey_topic]][0].length==1){current_survey_topic++;if(current_survey_topic==survey_topics.length){p.finished_survey();return true;}}}if(current_survey_topic==survey_topics.length){p.finished_survey();return true;}return false;};p.drop_effect_on_card=function(c){current_survey_topic=1;survey_drop_target=c;if(p.progress_survey_through_issues()){return;}};p.click_to_edit_card=function(c){if(c.mouse_over_mana){editing=\"mana\";editing_card=c;}else if(c.mouse_over_power){editing=\"power\";editing_card=c;}else if(c.mouse_over_toughness&&!(editing==\"effect\"&&p.dist(p.mouseX,p.mouseY,editX,editY)<10)){editing=\"toughness\";editing_card=c;}else if(c.mouse_over_card_effect&&!(editing==\"effect\"&&p.dist(p.mouseX,p.mouseY,editX,editY)<10)){editing=\"effect\";editX=c.hovered_effect.x+blank_spell_img.width*p.min(p.width*0.0005,0.75)*0.75;editY=c.hovered_effect.y+c.hovered_effect.effect_string_height/2;editing_card=c;effect_to_remove=c.hovered_effect;}else if(editing==\"effect\"&&p.dist(p.mouseX,p.mouseY,editX,editY)<10){editing_card.effects.splice(editing_card.effects.indexOf(effect_to_remove),1);editing=\"none\";}else{editing=\"none\";}};p.mouse_click_while_editing=function(){if(editing==\"mana\"){if(p.dist(p.mouseX,p.mouseY,editX-60,editY-50)<40){editing_card.mana--;}else if(p.dist(p.mouseX,p.mouseY,editX+60,editY-50)<40){editing_card.mana++;}else{editing=\"none\";}editing_card.mana=p.constrain(editing_card.mana,0,10);}else if(editing==\"power\"){if(p.dist(p.mouseX,p.mouseY,editX-60,editY+50)<40){editing_card.power--;}else if(p.dist(p.mouseX,p.mouseY,editX+60,editY+50)<40){editing_card.power++;}else{editing=\"none\";}editing_card.power=p.constrain(editing_card.power,0,10);}else if(editing==\"toughness\"){if(p.dist(p.mouseX,p.mouseY,editX-60,editY+50)<40){editing_card.toughness--;}else if(p.dist(p.mouseX,p.mouseY,editX+60,editY+50)<40){editing_card.toughness++;}else{editing=\"none\";}editing_card.toughness=p.constrain(editing_card.toughness,1,10);}else if(editing==\"effect\"){editing=\"none\";}};p.draw_edit_overlay=function(){p.push();if(editing!=\"none\"){p.translate(editX,editY);p.noStroke();if(editing==\"effect\"){p.rotate(p.QUARTER_PI);p.fill(0);p.rect(0,0,22,6);p.rect(0,0,6,22);p.fill(255);p.rect(0,0,20,4);p.rect(0,0,4,20);}else{p.fill(0);p.rect(-60,editing==\"mana\"?-50:75,32,8);p.rect(60,editing==\"mana\"?-50:75,32,8);p.rect(60,editing==\"mana\"?-50:75,8,32);p.fill(255);p.rect(-60,editing==\"mana\"?-50:75,30,6);p.rect(60,editing==\"mana\"?-50:75,30,6);p.rect(60,editing==\"mana\"?-50:75,6,30);}}p.pop();};p.mousePressed=function(){if(setup_done){if(survey_topics[current_survey_topic]!=\"none\"){p.mouse_pressed_while_surveying();}else{p.mouse_pressed_while_not_surveying();}}};p.finished_survey=function(){survey_drop_target.effects.push(JSON.parse(JSON.stringify(the_mouse.effect)));current_survey_topic=0;the_mouse.effect=null;the_mouse.busy=false;};p.keyPressed=function(){};p.windowResized=function(){p.resizeCanvas(p.windowWidth,p.windowHeight);p.resize_all();};p.ease_out_cubic=function(x){return 1-p.pow(1-x,3);};p.send_overlay=function(){p.text(\"Thank you for completing the tasks,\\nPlease hit the button to save your responses.\",p.width/2,p.height/2);p.push();var queur_x=p.width-w_padding;var queur_y=p.height-h_padding;mouse_over_queuer=p.mouseX>queur_x-100&&p.mouseX<queur_x+100&&p.mouseY>queur_y-30&&p.mouseY<queur_y+30;p.translate(queur_x,queur_y);if(sending){var q=p.map(p.millis(),send_start_time,send_start_time+estimated_send_duration,0,1,true);q=p.ease_out_cubic(q);p.fill(255,p.map(q,0,1,50,100));p.rect(p.map(q,0,1,-100,0),0,p.map(q,0,1,0,200),60,4);p.rect(0,0,200,60,4);}else{p.fill(255,mouse_over_queuer?255:100);p.rect(0,0,200,60,4);}p.fill(0,255);p.textAlign(p.CENTER,p.CENTER);p.text(sending?sent?\"Saving again...\":\"Saving...\":sent?mouse_over_queuer?\"Save again\":\"Done.\":\"Save to system\",0,-4);p.pop();};p.submit=function(){if(!sending){sending=true;send_start_time=p.millis();var submissions=p.generate_submissions();props.send_to_google_sheets(submissions).then(function(result){console.log(result);sending=false;sent=true;});}};p.load_save=function(){props.load_from_google_sheets(user).then(function(result){if(result.data.r){var loaded_save=result.data.r.data.values[0];if(loaded_save[2]){tasks=JSON.parse(loaded_save[2]);var _iterator8=_createForOfIteratorHelper(tasks),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var t=_step8.value;var _iterator9=_createForOfIteratorHelper(t),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var c=_step9.value;c.__proto__=p.Card.prototype;}}catch(err){_iterator9.e(err);}finally{_iterator9.f();}}}catch(err){_iterator8.e(err);}finally{_iterator8.f();}p.resize_all();}}else{console.log(result.data.e);}});};p.make_save=function(){var asString=JSON.stringify(tasks);props.save_to_google_sheets([user,asString]).then(function(result){console.log(result);});};p.generate_submissions=function(){var submissions=[];p.make_save();var _iterator10=_createForOfIteratorHelper(tasks),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var t=_step10.value;var _iterator11=_createForOfIteratorHelper(t),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var c=_step11.value;var card_submission={id:c.card_id,task:c.card_task_index,user:user,p:c.power,t:c.toughness,m:c.mana};var repeat_checker={};var _iterator12=_createForOfIteratorHelper(c.effects),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var e=_step12.value;if(repeat_checker[e.effect_short]==undefined){repeat_checker[e.effect_short]=0;}else{repeat_checker[e.effect_short]++;}if(e.settings.methods[0]!=null)card_submission[e.effect_short+\"-method-\"+repeat_checker[e.effect_short]]=e.settings.methods[1];if(e.settings.params[0]!=null)card_submission[e.effect_short+\"-param-\"+repeat_checker[e.effect_short]]=e.settings.params[1];if(e.settings.targets[0]!=null)card_submission[e.effect_short+\"-target-\"+repeat_checker[e.effect_short]]=e.settings.targets[1];if(e.settings.filters[0]!=null)card_submission[e.effect_short+\"-filter-\"+repeat_checker[e.effect_short]]=e.settings.filters[1];if(e.settings.duration[0]!=null)card_submission[e.effect_short+\"-duration-\"+repeat_checker[e.effect_short]]=e.settings.duration[1];}}catch(err){_iterator12.e(err);}finally{_iterator12.f();}submissions[c.card_task_index+\"-\"+c.card_id]=card_submission;}}catch(err){_iterator11.e(err);}finally{_iterator11.f();}}}catch(err){_iterator10.e(err);}finally{_iterator10.f();}return submissions;};p.resize_all=function(){h_padding=p.height*0.1;w_padding=p.width*0.2;grid_h_padding=p.height*0.2;grid_w_padding=p.width*0.1;font_pixels_large=p.min(p.width*32*0.0008,32);font_pixels=p.min(p.width*24*0.0008,24);font_pixels_small=p.min(p.width*20*0.0008,20);var _iterator13=_createForOfIteratorHelper(buttons),_step13;try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){var b=_step13.value;b.resized();}}catch(err){_iterator13.e(err);}finally{_iterator13.f();}var _iterator14=_createForOfIteratorHelper(tasks),_step14;try{for(_iterator14.s();!(_step14=_iterator14.n()).done;){var t=_step14.value;var _iterator16=_createForOfIteratorHelper(t),_step16;try{for(_iterator16.s();!(_step16=_iterator16.n()).done;){var c=_step16.value;c.resized();}}catch(err){_iterator16.e(err);}finally{_iterator16.f();}}}catch(err){_iterator14.e(err);}finally{_iterator14.f();}var _iterator15=_createForOfIteratorHelper(effects),_step15;try{for(_iterator15.s();!(_step15=_iterator15.n()).done;){var e=_step15.value;e.resized();}}catch(err){_iterator15.e(err);}finally{_iterator15.f();}p.generate_masks();};p.generate_masks=function(){ellipse_mask=p.createGraphics(250,250);ellipse_mask.ellipse(ellipse_mask.width/2,ellipse_mask.height/2,200,200);rect_mask=p.createGraphics(250,250);rect_mask.rectMode(p.CENTER);rect_mask.rect(rect_mask.width/2,rect_mask.height/2,200,160);};p.register_effect=function(effect_text,effect_short,method,param,targets,filters,duration){effects[effect_text]=new p.Effect(effect_text,effect_short,method,param,targets,filters,duration);buttons.push(new p.Button(effect_text,button_id++));if(button_id==3){button_id++;}};p.register_all=function(){p.register_effect(\"Keywords\",\"key\",null,[\"k\"],null,null,null);p.register_effect(\"Creature types\",\"cre\",null,[\"c\"],null,null,null);p.register_effect(\"Draw cards\",\"dra\",null,[\"x\"],null,[\"enemy\",\"friendly\",\"all\"],null);p.register_effect(\"Deal damage\",\"dam\",[\"randomly\",\"targeted\",\"all\"],[\"x\"],[\"minions\",\"heroes\",\"minions or heroes\",\"pirates\",\"beasts\",\"elementals\",\"totems\"],[\"enemy\",\"friendly\",\"all\"],null);p.register_effect(\"Gain armour\",\"arm\",null,[\"x\"],null,[\"enemy\",\"friendly\",\"all\"],null);p.register_effect(\"Restore health\",\"hea\",[\"randomly\",\"targeted\",\"all\"],[\"x\"],[\"minions\",\"heroes\",\"minions or heroes\",\"pirates\",\"beasts\",\"elementals\",\"totems\"],[\"enemy\",\"friendly\",\"all\"],null);p.register_effect(\"Return to hand\",\"ret\",[\"randomly\",\"targeted\",\"all\"],null,[\"minions\",\"pirates\",\"beasts\",\"elementals\",\"totems\"],[\"enemy\",\"friendly\",\"all\"],null);p.register_effect(\"Summon token\",\"sum\",null,[\"x/x\"],null,null,null);p.register_effect(\"Destroy minions\",\"des\",[\"randomly\",\"targeted\",\"all\"],null,[\"minions\",\"pirates\",\"beasts\",\"elementals\",\"totems\",\"weapons\"],[\"enemy\",\"friendly\",\"all\"],null);p.register_effect(\"Gain mana crystals\",\"gai\",null,[\"x\"],null,[\"enemy\",\"friendly\",\"all\"],null);p.register_effect(\"Set stats\",\"set\",[\"randomly\",\"targeted\",\"all\"],[\"x/x\"],[\"minions\",\"pirates\",\"beasts\",\"elementals\",\"totems\"],[\"enemy\",\"friendly\",\"all\"],[\"turn\",\"permanently\"]);p.register_effect(\"Give stats\",\"cha\",[\"randomly\",\"targeted\",\"all\"],[\"x/x\"],[\"minions\",\"pirates\",\"beasts\",\"elementals\",\"totems\"],[\"enemy\",\"friendly\",\"all\"],[\"turn\",\"permanently\"]);p.register_effect(\"Give keyword\",\"giv\",[\"randomly\",\"targeted\",\"all\"],[\"k\"],[\"minions\",\"pirates\",\"beasts\",\"elementals\",\"totems\"],[\"enemy\",\"friendly\",\"all\"],[\"turn\",\"permanently\"]);};p.FancyMouse=/*#__PURE__*/function(){function _class(){_classCallCheck(this,_class);}_createClass(_class,[{key:\"constuctor\",value:function constuctor(){this.busy=false;this.xOffset=0;this.yOffset=0;this.effect=null;}},{key:\"setOffset\",value:function setOffset(buttonX,buttonY){this.xOffset=p.mouseX-buttonX;this.yOffset=p.mouseY-buttonY;}}]);return _class;}();p.Effect=/*#__PURE__*/function(){function _class2(label_name,effect_short,methods,param_format,targets,filters,duration){_classCallCheck(this,_class2);this.x=0;this.y=0;this.effect_string=\"\";this.effect_string_height=0;this.effect_string_width=blank_spell_img.width*p.min(p.width*0.0005,0.75)/2;this.label_name=label_name;this.effect_short=effect_short;this.settings={methods:[methods,\"\"],params:[param_format,\"\"],targets:[targets,\"\"],filters:[filters,\"\"],duration:[duration,\"\"]};}return _class2;}();p.Card=/*#__PURE__*/function(){function _class3(card_id,card_task_index,card_class){_classCallCheck(this,_class3);this.y=0;this.x=0;this.w=blank_spell_img.width*0.75;this.h=blank_spell_img.height*0.75;this.oversized=false;this.class=card_class;this.type_id=1;//creature\nthis.card_id=card_id;this.card_task_index=card_task_index;this.flav_img_index=p.floor(p.random(gan_imgs.length));this.mana=5;this.power=5;this.toughness=5;this.effects=[];this.hovered_effect=null;this.mouse_over_card_effect=false;this.mouse_over_mana=false;this.mouse_over_power=false;this.mouse_over_toughness=false;}_createClass(_class3,[{key:\"resized\",value:function resized(){if(tasks[this.card_task_index].length==1){this.x=p.map(2,0,3,w_padding,p.width-w_padding);}else if(tasks[this.card_task_index].length==2){this.x=p.map(this.card_id==0?1.5:2.5,0,3,w_padding,p.width-w_padding);}else{this.x=p.map(this.card_id+1,0,3,w_padding,p.width-w_padding);}this.y=p.height/2;this.w=blank_spell_img.width*p.min(p.width*0.0005,0.75);this.h=blank_spell_img.height*p.min(p.width*0.0005,0.75);var _iterator17=_createForOfIteratorHelper(this.effects),_step17;try{for(_iterator17.s();!(_step17=_iterator17.n()).done;){var e=_step17.value;e.effect_string_width=blank_spell_img.width*p.min(p.width*0.0005,0.75)*0.75;p.textSize(font_pixels_small);var num_lines=p.textWidth(e.effect_string)/e.effect_string_width;e.effect_string_height=font_pixels_small*p.ceil(num_lines)+font_pixels_small;}}catch(err){_iterator17.e(err);}finally{_iterator17.f();}}},{key:\"run\",value:function run(){this.generate_effect_text();this.check_mouse_hovers();this.display();}},{key:\"generate_effect_text\",value:function generate_effect_text(){var _iterator18=_createForOfIteratorHelper(this.effects),_step18;try{for(_iterator18.s();!(_step18=_iterator18.n()).done;){var e=_step18.value;e.effect_string=\"\";if(e.label_name==\"Keywords\"||e.label_name==\"Creature types\"){e.effect_string=e.settings.params[1];}else if(e.label_name==\"Deal damage\"){if(e.settings.methods[1]==\"randomly\"){e.effect_string=\"Battlecry: Deal \"+e.settings.params[1]+\" damage to a random \";}else if(e.settings.methods[1]==\"targeted\"){e.effect_string=\"Battlecry: Deal \"+e.settings.params[1]+\" damage to target \";}else{e.effect_string=\"Battlecry: Deal \"+e.settings.params[1]+\" damage to all \";}e.effect_string+=e.settings.filters[1]==\"all\"?\"\":e.settings.filters[1]+\" \";//remove \"all all\"\nif(e.settings.methods[1]==\"all\"){e.effect_string+=e.settings.targets[1];}else{e.effect_string+=target_names_singular[target_names.indexOf(e.settings.targets[1])];}}else if(e.label_name==\"Destroy minions\"){if(e.settings.methods[1]==\"randomly\"){e.effect_string=\"Battlecry: Destroy a random \";}else if(e.settings.methods[1]==\"targeted\"){e.effect_string=\"Battlecry: Destroy a target \";}else{e.effect_string=\"Battlecry: Destroy all \";}e.effect_string+=e.settings.filters[1]==\"all\"?\"\":e.settings.filters[1]+\" \";//remove \"all all\"\nif(e.settings.methods[1]==\"all\"){e.effect_string+=e.settings.targets[1];}else{e.effect_string+=target_names_singular[target_names.indexOf(e.settings.targets[1])];}}else if(e.label_name==\"Restore health\"){if(e.settings.methods[1]==\"randomly\"){e.effect_string=\"Battlecry: Restore \"+e.settings.params[1]+\" health to a random \";}else if(e.settings.methods[1]==\"targeted\"){e.effect_string=\"Battlecry: Restore \"+e.settings.params[1]+\" health to a target \";}else{e.effect_string=\"Battlecry: Restore \"+e.settings.params[1]+\" health to all \";}e.effect_string+=e.settings.filters[1]==\"all\"?\"\":e.settings.filters[1]+\" \";//remove \"all all\"\nif(e.settings.methods[1]==\"all\"){e.effect_string+=e.settings.targets[1];}else{e.effect_string+=target_names_singular[target_names.indexOf(e.settings.targets[1])];}}else if(e.label_name==\"Draw cards\"){if(e.settings.filters[1]==\"enemy\"){e.effect_string=\"Battlecry: Enemy draws \"+e.settings.params[1]+\" cards\";}else if(e.settings.filters[1]==\"friendly\"){e.effect_string=\"Battlecry: Draw \"+e.settings.params[1]+\" cards\";}else{e.effect_string=\"Battlecry: Both players draw \"+e.settings.params[1]+\" cards\";}}else if(e.label_name==\"Gain armour\"){if(e.settings.filters[1]==\"enemy\"){e.effect_string=\"Battlecry: Enemy gains \"+e.settings.params[1]+\" armour\";}else if(e.settings.filters[1]==\"friendly\"){e.effect_string=\"Battlecry: Gain \"+e.settings.params[1]+\" armour\";}else{e.effect_string=\"Battlecry: Both players gain \"+e.settings.params[1]+\" armour\";}}else if(e.label_name==\"Return to hand\"){if(e.settings.methods[1]==\"randomly\"){e.effect_string=\"Battlecry: Return a random \";}else if(e.settings.methods[1]==\"targeted\"){e.effect_string=\"Battlecry: Return a target \";}else{e.effect_string=\"Battlecry: Return all \";}e.effect_string+=e.settings.filters[1]==\"all\"?\"\":e.settings.filters[1]+\" \";//remove \"all all\"\nif(e.settings.methods[1]==\"all\"){e.effect_string+=e.settings.targets[1];}else{e.effect_string+=target_names_singular[target_names.indexOf(e.settings.targets[1])];}e.effect_string+=\" to their owners hand.\";}else if(e.label_name==\"Summon token\"){e.effect_string=\"Battlecry: Summon a \"+e.settings.params[1]+\" minion\";}else if(e.label_name==\"Gain mana crystals\"){if(e.settings.filters[1]==\"enemy\"){e.effect_string=\"Battlecry: Enemy gains \"+e.settings.params[1]+\" mana crystals\";}else if(e.settings.filters[1]==\"friendly\"){e.effect_string=\"Battlecry: Gain \"+e.settings.params[1]+\" mana crystals\";}else{e.effect_string=\"Battlecry: Both players gain \"+e.settings.params[1]+\" empty mana crystals\";}}else if(e.label_name==\"Set stats\"){if(e.settings.methods[1]==\"randomly\"){e.effect_string=\"Battlecry: Set a random \";}else if(e.settings.methods[1]==\"targeted\"){e.effect_string=\"Battlecry: Set a target \";}else{e.effect_string=\"Battlecry: Set all \";}e.effect_string+=e.settings.filters[1]==\"all\"?\"\":e.settings.filters[1]+\" \";//remove \"all all\"\nif(e.settings.methods[1]==\"all\"){e.effect_string+=e.settings.targets[1];}else{e.effect_string+=target_names_singular[target_names.indexOf(e.settings.targets[1])];}e.effect_string+=\" to \"+e.settings.params[1];if(e.settings.duration==\"turn\"){e.effect_string+=\" for this turn\";}else{e.effect_string+=\" permanently\";}}else if(e.label_name==\"Give stats\"){if(e.settings.methods[1]==\"randomly\"){e.effect_string=\"Battlecry: Give a random \";}else if(e.settings.methods[1]==\"targeted\"){e.effect_string=\"Battlecry: Give a target \";}else{e.effect_string=\"Battlecry: Give all \";}e.effect_string+=e.settings.filters[1]==\"all\"?\"\":e.settings.filters[1]+\" \";//remove \"all all\"\nif(e.settings.methods[1]==\"all\"){e.effect_string+=e.settings.targets[1];}else{e.effect_string+=target_names_singular[target_names.indexOf(e.settings.targets[1])];}e.effect_string+=\" +\"+e.settings.params[1].split(\"/\")[0]+\"/+\"+e.settings.params[1].split(\"/\")[1];if(e.settings.duration==\"turn\"){e.effect_string+=\" for this turn\";}else{e.effect_string+=\" permanently\";}}else if(e.label_name==\"Give keyword\"){if(e.settings.methods[1]==\"randomly\"){e.effect_string=\"Battlecry: Give a random \";}else if(e.settings.methods[1]==\"targeted\"){e.effect_string=\"Battlecry: Give a target \";}else{e.effect_string=\"Battlecry: Give all \";}e.effect_string+=e.settings.filters[1]==\"all\"?\"\":e.settings.filters[1]+\" \";//remove \"all all\"\nif(e.settings.methods[1]==\"all\"){e.effect_string+=e.settings.targets[1];}else{e.effect_string+=target_names_singular[target_names.indexOf(e.settings.targets[1])];}e.effect_string+=\" \"+e.settings.params[1].toLowerCase();if(e.settings.duration==\"turn\"){e.effect_string+=\" for this turn\";}else{e.effect_string+=\" permanently\";}}else{e.effect_string=e.label_name;}p.textSize(font_pixels_small);var num_lines=(p.textWidth(e.effect_string)+150)/e.effect_string_width;e.effect_string_height=font_pixels_small*p.ceil(num_lines)+font_pixels_small;}}catch(err){_iterator18.e(err);}finally{_iterator18.f();}}},{key:\"display\",value:function display(){p.push();p.fill(0);p.textAlign(p.CENTER,p.CENTER);if(this.effects.length>1){this.oversized=true;}else{this.oversized=false;}var flav=gan_imgs[this.flav_img_index].get();var forg;if(card_types[this.type_id]==\"spell\"){flav.mask(rect_mask);forg=blank_spell_img;}else if(card_types[this.type_id]==\"minion\"){flav.mask(ellipse_mask);forg=this.oversized?full_blank_creature_img:blank_creature_img;}else{flav.mask(rect_mask);forg=blank_weapon_img;}if(!this.oversized){p.image(flav,this.x,this.y-this.h*0.20,this.w*0.7,this.h*0.7);}p.image(forg,this.x,this.y,this.w,this.h);p.push();p.textSize(font_pixels_large*2);p.fill(255);p.strokeWeight(3);p.stroke(0);if(card_types[this.type_id]==\"minion\"){p.text(this.power,this.x-this.w/2.99,this.y+this.h/2.8);p.text(this.toughness,this.x+this.w/2.6,this.y+this.h/2.8);}p.text(this.mana,this.x-this.w/2.99,this.y-this.h/2.3);p.pop();p.push();p.fill(0);var translation_offset_y;if(this.oversized){translation_offset_y=this.y-this.h*0.3;p.translate(this.x,this.y-this.h*0.3);}else{translation_offset_y=this.y+this.h*0.1;p.translate(this.x,this.y+this.h*0.1);}this.mouse_over_card_effect=false;this.hovered_effect=null;var _iterator19=_createForOfIteratorHelper(this.effects),_step19;try{for(_iterator19.s();!(_step19=_iterator19.n()).done;){var e=_step19.value;translation_offset_y+=e.effect_string_height/2;p.translate(0,e.effect_string_height/2);if(p.mouseY>translation_offset_y-e.effect_string_height/2&&p.mouseY<translation_offset_y+e.effect_string_height/2&&p.mouseX>this.x-e.effect_string_width/2&&p.mouseX<this.x+e.effect_string_width/2){this.mouse_over_card_effect=true;this.hovered_effect=e;this.hovered_effect.x=this.x-e.effect_string_width/2;this.hovered_effect.y=translation_offset_y-e.effect_string_height;p.fill(0,100);}else{p.fill(0,50);}p.rect(0,0,e.effect_string_width,e.effect_string_height,4,4);p.fill(255,255);p.textSize(font_pixels_small);p.textAlign(p.LEFT,p.TOP);p.text(e.effect_string,0,0,e.effect_string_width,e.effect_string_height);translation_offset_y+=e.effect_string_height/2+5;p.translate(0,e.effect_string_height/2+5);}}catch(err){_iterator19.e(err);}finally{_iterator19.f();}p.pop();p.push();if(editing_card==this){if(editing==\"mana\"){editX=this.x-this.w/2.99;editY=this.y-this.h/2.3;}else if(editing==\"power\"){editX=this.x-this.w/2.99;editY=this.y+this.h/2.8;}else if(editing==\"toughness\"){editX=this.x+this.w/2.6;editY=this.y+this.h/2.8;}}p.pop();p.pop();}},{key:\"mouseInImg\",value:function mouseInImg(){return p.mouseX>this.x-this.w/2-mouse_padding&&p.mouseX<this.x+this.w/2+mouse_padding&&p.mouseY>this.y-this.h/2-mouse_padding&&p.mouseY<this.y+this.h/2+mouse_padding;}},{key:\"check_mouse_hovers\",value:function check_mouse_hovers(){if(card_types[this.type_id]==\"minion\"){this.mouse_over_power=p.dist(p.mouseX,p.mouseY,this.x-this.w/2.99,this.y+this.h/2.8)<50;this.mouse_over_toughness=p.dist(p.mouseX,p.mouseY,this.x+this.w/2.6,this.y+this.h/2.8)<50;}this.mouse_over_mana=p.dist(p.mouseX,p.mouseY,this.x-this.w/2.99,this.y-this.h/2.3)<50;}}]);return _class3;}();p.Button=/*#__PURE__*/function(){function _class4(button_name,button_id){_classCallCheck(this,_class4);this.button_name=button_name;this.button_id=button_id;this.x=0;this.y=0;this.w=p.textWidth(button_name)+14;this.h=font_pixels+10;this.fillAlpha=100;this.text_x=0;this.text_y=0;}_createClass(_class4,[{key:\"mouseInRegion\",value:function mouseInRegion(){return p.mouseX>this.x-this.w/2-mouse_padding&&p.mouseX<this.x+this.w/2+mouse_padding&&p.mouseY>this.y-this.h/2-mouse_padding&&p.mouseY<this.y+this.h/2+mouse_padding;}},{key:\"resized\",value:function resized(){this.w=p.textWidth(this.button_name)+14;this.h=font_pixels+10;this.x=w_padding/2+this.w/2-7;this.y=p.map(this.button_id,0,15,h_padding,p.height-h_padding);this.text_x=this.x-this.w/2+7;this.text_y=this.y-6;}},{key:\"run\",value:function run(){this.update();this.display();}},{key:\"update\",value:function update(){if(this.mouseInRegion()&&current_survey_topic==0){this.fillAlpha=255;}else{this.fillAlpha=100;}}},{key:\"display\",value:function display(){p.textSize(font_pixels);p.textAlign(p.LEFT,p.CENTER);p.fill(255,this.fillAlpha);p.rect(this.x,this.y,this.w,this.h,4,4);p.fill(0,255);p.text(this.button_name,this.text_x,this.text_y);}}]);return _class4;}();document.oncontextmenu=function(){return false;};}","map":{"version":3,"sources":["/Users/aep/phd/hearth-mici/src/code/sketch.js"],"names":["sketch","p","buttons","button_id","effects","current_task_index","task_details","id","title","instruction","num_cards","class","user","tasks","card_types","method_names","target_names","target_names_singular","filter_names","duration_names","param_format_names","effect_names","keywords","all_creature_types","creature_types","survey_topics","current_survey_topic","survey_drop_target","font_pixels_large","font_pixels","font_pixels_small","hearthstone_font","mouse_padding","w_padding","h_padding","grid_w_padding","grid_h_padding","rect_mask","ellipse_mask","blank_spell_img","blank_creature_img","blank_weapon_img","full_blank_creature_img","bg","gan_imgs","the_mouse","setup_done","hovered_option","editing","editing_card","effect_to_remove","editX","editY","sending","send_start_time","estimated_send_duration","sent","mouse_over_queuer","mouse_over_next","mouse_over_prev","props","myCustomRedrawAccordingToNewPropsHandler","_props","preload","loadImage","bg_img","spell_img","weapon_img","creature_img","loadFont","hs_font","im","push","setup","createCanvas","windowWidth","windowHeight","getURLParams","FancyMouse","height","width","imageMode","CENTER","rectMode","textFont","textSize","fill","noStroke","register_all","task","card_id","Card","load_save","resize_all","draw","background","textAlign","LEFT","image","length","c","run","b","text","map","busy","translate","mouseX","xOffset","mouseY","yOffset","effect","label_name","pop","draw_edit_overlay","draw_task_controls","send_overlay","draw_task_overlay","draw_survey","next_x","next_y","dist","triangle","prev_x","RIGHT","setting","settings","options","attack","defense","xPos","yPos","box_width","box_height","rect","option_button_width","option_button_height","option_buttons_padding","entries","index","option","option_string","toString","toUpperCase","substring","split","join","mouse_pressed_while_surveying","progress_survey_through_issues","selectedAttack","selectedDefense","mouse_pressed_while_not_surveying","clicked_card","mouseInImg","drop_effect_on_card","click_to_edit_card","setOffset","submit","mouse_click_while_editing","mouseInRegion","text_x","text_y","JSON","parse","stringify","button_name","finished_survey","i","includes","mouse_over_mana","mouse_over_power","mouse_over_toughness","mouse_over_card_effect","hovered_effect","x","min","y","effect_string_height","splice","indexOf","mana","constrain","power","toughness","rotate","QUARTER_PI","mousePressed","keyPressed","windowResized","resizeCanvas","ease_out_cubic","pow","queur_x","queur_y","q","millis","submissions","generate_submissions","send_to_google_sheets","then","result","console","log","load_from_google_sheets","data","r","loaded_save","values","t","__proto__","prototype","e","make_save","asString","save_to_google_sheets","card_submission","card_task_index","m","repeat_checker","effect_short","undefined","methods","params","targets","filters","duration","resized","generate_masks","createGraphics","ellipse","register_effect","effect_text","method","param","Effect","Button","buttonX","buttonY","param_format","effect_string","effect_string_width","card_class","w","h","oversized","type_id","flav_img_index","floor","random","num_lines","textWidth","ceil","generate_effect_text","check_mouse_hovers","display","toLowerCase","flav","get","forg","mask","strokeWeight","stroke","translation_offset_y","TOP","fillAlpha","update","document","oncontextmenu"],"mappings":"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","sourcesContent":["/* eslint eqeqeq: \"off\", no-unused-vars: \"off\" */\n\n\n//to fix totalHeight bug, change p5 by changing o-totalHeight to just o\n//todo: fix this on a generic p5 import somehow\n\n\n//todo: language stuff\n//todo: buttons\n//todo: creature types\n//todo: card types\n//todo: effect limit\n//ABC test reports, articulate logic for report design\n\n//make rampiness, variety, controllynes and see when they would be useful\n\nexport default function sketch(p) {\n\n\n  const buttons = [];\n  let button_id = 1;\n\n  const effects = [];\n\n\n  let current_task_index = 0;\n  const task_details = [{\n    id: 0,\n    title: \"3 Hunter Cards\",\n    instruction: \"Design three cards for hunter\",\n    num_cards: 3,\n    class: \"hunter\"\n  },\n  {\n    id: 1,\n    title: \"3 Warrior Cards\",\n    instruction: \"Design three cards for warrior\",\n    num_cards: 3,\n    class: \"warrior\"\n  },\n  {\n    id: 2,\n    title: \"3 Mage Cards\",\n    instruction: \"Design three cards for mage\",\n    num_cards: 3,\n    class: \"mage\"\n  },\n  {\n    id: 3,\n    title: \"3 Neutral Cards\",\n    instruction: \"Design three neutral cards\",\n    num_cards: 3,\n    class: \"all\"\n  }\n  ]\n\n\n\n  let user = \"\"\n\n  let tasks = [];\n  const card_types = [\"spell\", \"minion\", \"weapon\"]\n\n  const method_names = [\"randomly\", \"targeted\", \"all\"];\n  const target_names = [\"minions\", \"heroes\", \"minions or heroes\", \"pirates\", \"beasts\", \"elementals\", \"totems\", \"weapons\"];\n  const target_names_singular = [\"minion\", \"hero\", \"minion or hero\", \"pirate\", \"beast\", \"elemental\", \"totem\", \"weapon\"]\n  const filter_names = [\"enemy\", \"friendly\", \"all\"];\n  const duration_names = [\"turn\", \"permanently\"];\n  const param_format_names = [\"x\", \"x/x\", \"k\", \"c\"];\n  const effect_names = [\"Deal damage\", \"Destroy\", \"Restore health\", \"Gain armour\", \"Change stats\", \"Set stats\", \"Give keyword\", \"Return to hand\", \"Draw\", \"Gain mana\", \"Summon: \", \"Battlecry: \", \"Deathrattle: \"]\n  const keywords = [\"Taunt\", \"Charge\", \"Lifesteal\", \"Spell damage +1\", \"Divine shield\", \"Poisonous\", \"Windfury\", \"Frozen\"]\n  const all_creature_types = [\"pirate\", \"beast\", \"elemental\", \"totem\", \"dragon\", \"pirate\", \"mech\", \"elemental\"]\n  const creature_types = [\"Pirate\", \"Beast\", \"Elemental\", \"Totem\"]\n\n  const survey_topics = [\"none\", \"methods\", \"filters\", \"targets\", \"duration\", \"params\"];\n  let current_survey_topic = 0;\n\n  let survey_drop_target = null;\n\n  let font_pixels_large = 32;\n  let font_pixels = 24;\n  let font_pixels_small = 20;\n\n  let hearthstone_font;\n  const mouse_padding = 1;\n  let w_padding, h_padding;\n  let grid_w_padding, grid_h_padding;\n\n  let rect_mask, ellipse_mask;\n  let blank_spell_img, blank_creature_img, blank_weapon_img, full_blank_creature_img;\n  let bg;\n  let gan_imgs = [];\n\n\n  let the_mouse;\n  let setup_done = false;\n  let hovered_option = -1;\n\n  let editing = \"none\";\n  let editing_card = null;\n  let effect_to_remove = null;\n  let editX = 0;\n  let editY = 0;\n\n  let sending = false;\n  let send_start_time = -10000;\n  const estimated_send_duration = 3000; //over-estimate\n  let sent = false;\n\n  let mouse_over_queuer;\n  let mouse_over_next;\n  let mouse_over_prev;\n\n\n  let props;\n\n\n  p.myCustomRedrawAccordingToNewPropsHandler = (_props) => {\n    props = _props;\n  }\n\n  p.preload = () => {\n    bg = p.loadImage(props.bg_img)\n    blank_spell_img = p.loadImage(props.spell_img);\n    blank_weapon_img = p.loadImage(props.weapon_img)\n    blank_creature_img = p.loadImage(props.creature_img)\n    full_blank_creature_img = p.loadImage(props.full_blank_creature_img);\n    hearthstone_font = p.loadFont(props.hs_font);\n    for (let im of props.gan_imgs) {\n      gan_imgs.push(p.loadImage(im))\n    }\n  }\n\n\n  p.setup = () => {\n    p.createCanvas(p.windowWidth, p.windowHeight);\n    user = p.getURLParams().user ?? 2;\n\n\n   \n    the_mouse = new p.FancyMouse();\n\n\n    h_padding = p.height * 0.1;\n    w_padding = p.width * 0.2;\n    grid_h_padding = p.height * 0.2;\n    grid_w_padding = p.width * 0.1;\n    p.imageMode(p.CENTER)\n    p.rectMode(p.CENTER);\n    p.textFont(hearthstone_font);\n    p.textSize(font_pixels);\n    p.fill(255);\n    p.noStroke();\n\n    p.register_all();\n\n\n    for (let task of task_details) {\n      tasks[task.id] = [];\n      for (let card_id = 0; card_id < task.num_cards; card_id++) {\n        tasks[task.id].push(new p.Card(card_id, task.id, task.class));\n      }\n    }\n\n    p.load_save(); //loads save file from google sheets if it exists\n\n    p.resize_all();\n\n\n\n    setup_done = true;\n\n  }\n\n\n  p.draw = () => {\n    p.resize_all();\n    p.background(255)\n    p.textAlign(p.LEFT, p.CENTER);\n    p.image(bg, p.width / 2, p.height / 2, p.width, p.height);\n\n\n    if (current_task_index < task_details.length) {\n      for (let c of tasks[current_task_index]) {\n        c.run();\n      }\n    \n\n    for (let b of buttons) {\n      b.run();\n    }\n  \n    p.textSize(font_pixels+4)\n    p.text(\"Base attributes:\", w_padding/2, h_padding)\n    p.text(\"Battlecrys:\", w_padding/2, p.map(3, 0, 16, h_padding, p.height - h_padding))\n  }\n\n\n    if (the_mouse.busy && current_survey_topic == 0) {\n      p.push();\n      p.translate(p.mouseX - the_mouse.xOffset, p.mouseY - the_mouse.yOffset)\n      p.textSize(28)\n      p.text(the_mouse.effect.label_name, 0, 0)\n      p.pop();\n    }\n\n    p.draw_edit_overlay();\n    p.draw_task_controls();\n\n\n    if (current_task_index == task_details.length) {\n      p.send_overlay();\n    } else {\n      p.draw_task_overlay();\n\n    }\n\n\n    if (survey_topics[current_survey_topic] != \"none\") {\n      p.draw_survey();\n    }\n\n  }\n\n  p.draw_task_controls = () => {\n\n\n    let next_x = p.width - w_padding;\n    let next_y = p.height - h_padding;\n    mouse_over_next = p.dist(p.mouseX, p.mouseY, next_x, next_y) < 75;\n\n    p.push();\n    p.translate(next_x, next_y)\n    p.fill(255, current_task_index == task_details.length ? 0 : mouse_over_next ? 255 : 100)\n    p.triangle(0, -25, 0, 25, 75, 0);\n    p.pop();\n\n    let prev_x = p.map(1, 0, 3, w_padding, p.width - w_padding)\n    mouse_over_prev = p.dist(p.mouseX, p.mouseY, prev_x, next_y) < 75;\n\n    p.push();\n    p.translate(prev_x, next_y)\n    p.fill(255, current_task_index == 0 ? 50 : mouse_over_prev ? 255 : 100)\n    p.triangle(0, -25, 0, 25, -75, 0);\n    p.pop();\n\n  }\n\n  p.draw_task_overlay = () => {\n    p.textAlign(p.RIGHT, p.CENTER)\n    p.textSize(font_pixels);\n    p.text(task_details[current_task_index].instruction, p.width - w_padding / 2, h_padding)\n\n\n    p.fill(0);\n    p.textAlign(p.CENTER, p.CENTER);\n    p.text(`Task ${current_task_index + 1} \\\\ ${task_details.length}`, p.map(2, 0, 3, w_padding, p.width - w_padding), p.height - h_padding)\n  }\n\n\n\n  p.draw_survey = () => {\n    p.push();\n    p.textAlign(p.CENTER, p.CENTER)\n    p.textSize(font_pixels)\n\n    p.rectMode(p.CENTER)\n    p.background(0, 100)\n\n    let setting = the_mouse.effect.settings[survey_topics[current_survey_topic]]\n    let options = setting[0]\n\n\n    if (setting[0][0] == \"x\") {\n      options = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];\n    } else if (setting[0][0] == \"k\") {\n      options = keywords\n    } else if (setting[0][0] == \"c\") {\n      options = creature_types;\n    }\n\n\n    if (options[0] == \"x/x\") {\n      for (let attack = 0; attack <= 10; attack++) {\n        for (let defense = 0; defense <= 10; defense++) {\n          let xPos = p.map(attack, 0, 10, grid_w_padding, p.width - grid_w_padding);\n          let yPos = p.map(defense, 0, 10, grid_h_padding, p.height - grid_h_padding);\n          let box_width = (p.width - grid_w_padding * 2) / 10;\n          let box_height = (p.height - grid_h_padding * 2) / 10;\n\n          if (p.mouseX > xPos - box_width / 2 && p.mouseX < xPos + box_width / 2 &&\n            p.mouseY > yPos - box_height / 2 && p.mouseY < yPos + box_height / 2) {\n            p.fill(255, 100);\n          } else {\n            p.fill(255, 0);\n          }\n          p.rect(xPos, yPos, box_width, box_height);\n          p.fill(255);\n          p.text(attack + \"/\" + defense, xPos, yPos - 10)\n        }\n      }\n    } else {\n\n\n      p.textSize(40);\n      p.fill(255)\n      p.text(the_mouse.effect.label_name + \"...\", p.width / 2, p.height * 0.1);\n\n      p.textSize(font_pixels)\n      p.rectMode(p.CENTER)\n\n      let option_button_width = (p.width / options.length) * 0.5;\n      let option_button_height = p.height * 0.10;\n      let option_buttons_padding = p.width * 0.25;\n\n      for (let [index, option] of options.entries()) {\n        let xPos = p.map(index, 0, options.length - 1, option_buttons_padding, p.width - option_buttons_padding);\n        if (p.mouseX > xPos - option_button_width / 2 && p.mouseX < xPos + option_button_width / 2) {\n          p.fill(255, 100)\n          hovered_option = index;\n        } else {\n          p.fill(255, 50)\n        }\n        p.rect(xPos, p.height * 0.5, option_button_width, option_button_height, 16);\n        p.fill(255);\n\n        let option_string = option.toString();\n        option_string = option_string[0].toUpperCase() + option_string.substring(1)\n        option_string = option_string.split(\" \").join(\"\\n\");\n\n        p.text(option_string, xPos, p.height / 2)\n      }\n    }\n\n    p.pop();\n  }\n\n\n  p.mouse_pressed_while_surveying = () => {\n    if (p.progress_survey_through_issues()) {\n      return\n    }\n\n\n    let setting = the_mouse.effect.settings[survey_topics[current_survey_topic]];\n    let options = setting[0]\n    if (options[0] == \"x\") {\n      options = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n    } else if (options[0] == \"k\") {\n      options = keywords;\n    } else if (options[0] == \"c\") {\n      options = creature_types;\n    }\n\n    if (options[0] == \"x/x\") {\n      let selectedAttack = 0;\n      let selectedDefense = 0;\n      for (let attack = 0; attack <= 10; attack++) {\n        for (let defense = 0; defense <= 10; defense++) {\n          let xPos = p.map(attack, 0, 10, grid_w_padding, p.width - grid_w_padding);\n          let yPos = p.map(defense, 0, 10, grid_h_padding, p.height - grid_h_padding);\n          let box_width = (p.width - grid_w_padding * 2) / 10;\n          let box_height = (p.height - grid_h_padding * 2) / 10;\n\n          if (p.mouseX > xPos - box_width / 2 && p.mouseX < xPos + box_width / 2 &&\n            p.mouseY > yPos - box_height / 2 && p.mouseY < yPos + box_height / 2) {\n              selectedAttack = attack;\n              selectedDefense = defense;\n              break;\n            }\n          }\n        }\n\n      setting[1] = `${selectedAttack}/${selectedDefense}`;\n    } else {\n      setting[1] = options[hovered_option]\n    }\n\n\n\n    current_survey_topic++;\n\n    if (p.progress_survey_through_issues()) {\n      return\n    }\n\n  }\n\n\n  p.mouse_pressed_while_not_surveying = () => {\n    let clicked_card = null;\n\n    if (current_task_index < task_details.length) {\n      for (let c of tasks[current_task_index]) {\n        if (c.mouseInImg()) {\n          clicked_card = c;\n        }\n      }\n    }\n\n\n    if (clicked_card) {\n      if (the_mouse.busy) { //dropping effect onto a card\n        p.drop_effect_on_card(clicked_card)\n      } else { //clicking on a card generally\n        p.click_to_edit_card(clicked_card)\n      }\n    } else {\n      if (the_mouse.busy) { //clicked away to drop label\n        the_mouse.busy = false;\n        the_mouse.setOffset(0, 0);\n        the_mouse.effect = null;\n      } else { //other clicks\n\n\n        if (mouse_over_next && current_task_index < task_details.length) {\n          current_task_index++;\n        } else if (mouse_over_prev && current_task_index > 0) {\n          current_task_index--;\n        }\n\n        if (mouse_over_queuer && current_task_index == task_details.length && !sending) {\n          p.submit();\n        }\n\n        p.mouse_click_while_editing();\n\n\n        for (let b of buttons) { //clicking on a button with an empty hand\n          if (b.mouseInRegion()) {\n            the_mouse.busy = true;\n            the_mouse.setOffset(b.text_x, b.text_y);\n            the_mouse.effect = JSON.parse(JSON.stringify(effects[b.button_name]));\n\n            break;\n          }\n        }\n      }\n    }\n\n  }\n\n\n\n  //returns true if you need to return out of mouse\n  p.progress_survey_through_issues = () => {\n    if (current_survey_topic == survey_topics.length) {\n      p.finished_survey();\n      return true;\n    }\n\n    for (let i = 0; i < survey_topics.length; i++) {\n      if (the_mouse.effect.settings[survey_topics[current_survey_topic]][0] == null ||\n        (!param_format_names.includes(the_mouse.effect.settings[survey_topics[current_survey_topic]][0][0]) &&\n          the_mouse.effect.settings[survey_topics[current_survey_topic]][0].length == 1)) {\n        current_survey_topic++;\n        if (current_survey_topic == survey_topics.length) {\n          p.finished_survey();\n          return true;\n        }\n      }\n    }\n\n\n    if (current_survey_topic == survey_topics.length) {\n      p.finished_survey();\n      return true;\n    }\n\n\n    return false;\n  }\n\n  p.drop_effect_on_card = (c) => {\n    current_survey_topic = 1;\n    survey_drop_target = c;\n\n    if (p.progress_survey_through_issues()) {\n\n      return\n    }\n  }\n\n\n  p.click_to_edit_card = (c) => {\n\n    if (c.mouse_over_mana) {\n      editing = \"mana\";\n      editing_card = c;\n    } else if (c.mouse_over_power) {\n      editing = \"power\";\n      editing_card = c;\n    } else if (c.mouse_over_toughness && !(editing == \"effect\" && p.dist(p.mouseX, p.mouseY, editX, editY) < 10)) {\n      editing = \"toughness\";\n      editing_card = c;\n    } else if (c.mouse_over_card_effect && !(editing == \"effect\" && p.dist(p.mouseX, p.mouseY, editX, editY) < 10)) {\n      editing = \"effect\";\n      editX = c.hovered_effect.x + blank_spell_img.width * p.min(p.width*0.0005, 0.75)*0.75;\n      editY = c.hovered_effect.y + c.hovered_effect.effect_string_height / 2;\n      editing_card = c;\n      effect_to_remove = c.hovered_effect;\n    } else if (editing == \"effect\" && p.dist(p.mouseX, p.mouseY, editX, editY) < 10) {\n      editing_card.effects.splice(editing_card.effects.indexOf(effect_to_remove), 1);\n      editing = \"none\";\n    } else {\n      editing = \"none\";\n    }\n  }\n\n\n  p.mouse_click_while_editing = () => {\n    if (editing == \"mana\") {\n      if (p.dist(p.mouseX, p.mouseY, editX - 60, editY - 50) < 40) {\n        editing_card.mana--;\n      } else if (p.dist(p.mouseX, p.mouseY, editX + 60, editY - 50) < 40) {\n        editing_card.mana++;\n      } else {\n        editing = \"none\"\n      }\n      editing_card.mana = p.constrain(editing_card.mana, 0, 10)\n    } else if (editing == \"power\") {\n\n      if (p.dist(p.mouseX, p.mouseY, editX - 60, editY + 50) < 40) {\n        editing_card.power--;\n      } else if (p.dist(p.mouseX, p.mouseY, editX + 60, editY + 50) < 40) {\n        editing_card.power++;\n      } else {\n        editing = \"none\"\n      }\n      editing_card.power = p.constrain(editing_card.power, 0, 10)\n    } else if (editing == \"toughness\") {\n\n      if (p.dist(p.mouseX, p.mouseY, editX - 60, editY + 50) < 40) {\n        editing_card.toughness--;\n      } else if (p.dist(p.mouseX, p.mouseY, editX + 60, editY + 50) < 40) {\n        editing_card.toughness++;\n      } else {\n        editing = \"none\"\n      }\n      editing_card.toughness = p.constrain(editing_card.toughness, 1, 10)\n    } else if (editing == \"effect\") {\n      editing = \"none\";\n    }\n  }\n\n\n  p.draw_edit_overlay = () => {\n    p.push();\n    if (editing != \"none\") {\n      p.translate(editX, editY)\n      p.noStroke();\n      if (editing == \"effect\") {\n        p.rotate(p.QUARTER_PI);\n        p.fill(0);\n        p.rect(0, 0, 22, 6);\n        p.rect(0, 0, 6, 22);\n        p.fill(255);\n        p.rect(0, 0, 20, 4);\n        p.rect(0, 0, 4, 20);\n\n      } else {\n        p.fill(0);\n        p.rect(-60, editing == \"mana\" ? -50 : 75, 32, 8);\n        p.rect(60, editing == \"mana\" ? -50 : 75, 32, 8);\n        p.rect(60, editing == \"mana\" ? -50 : 75, 8, 32);\n        p.fill(255);\n        p.rect(-60, editing == \"mana\" ? -50 : 75, 30, 6);\n        p.rect(60, editing == \"mana\" ? -50 : 75, 30, 6);\n        p.rect(60, editing == \"mana\" ? -50 : 75, 6, 30);\n      }\n    }\n    p.pop();\n  }\n\n  p.mousePressed = () => {\n    if (setup_done) {\n      if (survey_topics[current_survey_topic] != \"none\") {\n        p.mouse_pressed_while_surveying();\n      } else {\n        p.mouse_pressed_while_not_surveying();\n      }\n    }\n  }\n\n  p.finished_survey = () => {\n\n    survey_drop_target.effects.push(JSON.parse(JSON.stringify(the_mouse.effect)))\n    current_survey_topic = 0;\n    the_mouse.effect = null;\n    the_mouse.busy = false;\n  }\n\n  p.keyPressed = () => {\n\n\n  }\n\n  p.windowResized = () => {\n    p.resizeCanvas(p.windowWidth, p.windowHeight);\n    p.resize_all();\n  }\n\n  p.ease_out_cubic = (x) => {\n    return 1 - p.pow(1 - x, 3);\n  }\n\n\n  p.send_overlay = () => {\n\n    p.text(\"Thank you for completing the tasks,\\nPlease hit the button to save your responses.\", p.width/2, p.height/2)\n    p.push();\n    let queur_x = p.width - w_padding;\n    let queur_y = p.height - h_padding;\n    mouse_over_queuer = (p.mouseX > queur_x - 100 && p.mouseX < queur_x + 100 && p.mouseY > queur_y - 30 && p.mouseY < queur_y + 30)\n\n    p.translate(queur_x, queur_y);\n\n    if (sending) {\n      let q = p.map(p.millis(), send_start_time, send_start_time + estimated_send_duration, 0, 1, true)\n      q = p.ease_out_cubic(q);\n\n      p.fill(255, p.map(q, 0, 1, 50, 100));\n      p.rect(p.map(q, 0, 1, -100, 0), 0, p.map(q, 0, 1, 0, 200), 60, 4);\n      p.rect(0, 0, 200, 60, 4);\n    } else {\n      p.fill(255, mouse_over_queuer ? 255 : 100);\n      p.rect(0, 0, 200, 60, 4)\n    }\n\n\n\n    p.fill(0, 255);\n    p.textAlign(p.CENTER, p.CENTER)\n    p.text(sending ? sent ? \"Saving again...\" : \"Saving...\" : sent ? mouse_over_queuer ? \"Save again\" : \"Done.\" : \"Save to system\", 0, -4)\n    p.pop();\n\n  }\n\n  p.submit = () => {\n    if (!sending) {\n      sending = true;\n      send_start_time = p.millis();\n\n      const submissions = p.generate_submissions();\n\n      props.send_to_google_sheets(submissions).then((result) => {\n        console.log(result);\n        sending = false;\n        sent = true;\n\n      })\n    }\n  }\n\n  p.load_save = () => {\n    props.load_from_google_sheets(user).then((result) => {\n      if(result.data.r){\n        let loaded_save = result.data.r.data.values[0];\n        if(loaded_save[2]){\n          tasks = JSON.parse(loaded_save[2]);\n          for(let t of tasks){\n            for(let c of t){\n              c.__proto__ = p.Card.prototype;\n            }\n          }\n          p.resize_all();\n        }\n      } else {\n        console.log(result.data.e)\n      }\n    });\n  }\n\n  p.make_save = () => {\n    let asString = JSON.stringify(tasks)\n\n    props.save_to_google_sheets([user, asString]).then((result) => {\n      console.log(result);\n    })\n  }\n\n  p.generate_submissions = () => {\n    const submissions = [];\n    p.make_save();\n\n    for (let t of tasks) {\n      for (let c of t) {\n        let card_submission = {\n          id: c.card_id,\n          task: c.card_task_index,\n          user: user,\n          p: c.power,\n          t: c.toughness,\n          m: c.mana,\n        }\n\n\n        let repeat_checker = {};\n\n        for (let e of c.effects) {\n          if (repeat_checker[e.effect_short] == undefined) {\n            repeat_checker[e.effect_short] = 0;\n          } else {\n            repeat_checker[e.effect_short]++;\n          }\n\n          if (e.settings.methods[0] != null) card_submission[e.effect_short + \"-method-\" + repeat_checker[e.effect_short]] = e.settings.methods[1];\n          if (e.settings.params[0] != null) card_submission[e.effect_short + \"-param-\" + repeat_checker[e.effect_short]] = e.settings.params[1];\n          if (e.settings.targets[0] != null) card_submission[e.effect_short + \"-target-\" + repeat_checker[e.effect_short]] = e.settings.targets[1];\n          if (e.settings.filters[0] != null) card_submission[e.effect_short + \"-filter-\" + repeat_checker[e.effect_short]] = e.settings.filters[1];\n          if (e.settings.duration[0] != null) card_submission[e.effect_short + \"-duration-\" + repeat_checker[e.effect_short]] = e.settings.duration[1];\n\n        }\n        submissions[c.card_task_index + \"-\" + c.card_id] = card_submission;\n      }\n    }\n\n    return submissions;\n  }\n\n  p.resize_all = () => {\n    \n    h_padding = p.height * 0.1;\n    w_padding = p.width * 0.2;\n    grid_h_padding = p.height * 0.2;\n    grid_w_padding = p.width * 0.1;\n\n    font_pixels_large = p.min(p.width*32*0.0008, 32);\n    font_pixels = p.min(p.width*24*0.0008, 24);\n    font_pixels_small = p.min(p.width*20*0.0008, 20);\n\n    for (let b of buttons) {\n      b.resized();\n    }\n\n    for (let t of tasks) {\n      for (let c of t) {\n        c.resized();\n        \n      }\n    }\n\n    for(let e of effects){\n      e.resized();\n    }\n\n    p.generate_masks();\n\n  }\n\n  p.generate_masks = () => {\n    ellipse_mask = p.createGraphics(250, 250);\n    ellipse_mask.ellipse(ellipse_mask.width / 2, ellipse_mask.height / 2, 200, 200)\n\n    rect_mask = p.createGraphics(250, 250);\n    rect_mask.rectMode(p.CENTER);\n    rect_mask.rect(rect_mask.width / 2, rect_mask.height / 2, 200, 160)\n  }\n\n  p.register_effect = (effect_text, effect_short, method, param, targets, filters, duration) => {\n\n    effects[effect_text] = new p.Effect(effect_text, effect_short, method, param, targets, filters, duration);\n    buttons.push(new p.Button(effect_text, button_id++));\n    if(button_id == 3){\n      button_id++;\n    }\n  }\n\n  p.register_all = () => {\n\n   \n\n    p.register_effect(\"Keywords\", \"key\",\n      null,\n      [\"k\"],\n      null,\n      null,\n      null);\n\n    p.register_effect(\"Creature types\", \"cre\",\n      null,\n      [\"c\"],\n      null,\n      null,\n      null);\n     \n\n    p.register_effect(\"Draw cards\", \"dra\",\n    null,\n    [\"x\"],\n    null,\n    [\"enemy\", \"friendly\", \"all\"],\n    null);\n\n   \n    p.register_effect(\"Deal damage\", \"dam\",\n      [\"randomly\", \"targeted\", \"all\"],\n      [\"x\"],\n      [\"minions\", \"heroes\", \"minions or heroes\", \"pirates\", \"beasts\", \"elementals\", \"totems\"],\n      [\"enemy\", \"friendly\", \"all\"],\n      null);\n      p.register_effect(\"Gain armour\", \"arm\",\n      null,\n      [\"x\"],\n      null,\n      [\"enemy\", \"friendly\", \"all\"],\n      null);\n      p.register_effect(\"Restore health\", \"hea\",\n      [\"randomly\", \"targeted\", \"all\"],\n      [\"x\"],\n      [\"minions\", \"heroes\", \"minions or heroes\", \"pirates\", \"beasts\", \"elementals\", \"totems\"],\n      [\"enemy\", \"friendly\", \"all\"],\n      null);\n    p.register_effect(\"Return to hand\", \"ret\",\n    [\"randomly\", \"targeted\", \"all\"],\n    null,\n    [\"minions\", \"pirates\", \"beasts\", \"elementals\", \"totems\"],\n    [\"enemy\", \"friendly\", \"all\"],\n    null);\n\n\n\n  p.register_effect(\"Summon token\", \"sum\",\n  null,\n  [\"x/x\"],\n  null,\n  null,\n  null);\n    p.register_effect(\"Destroy minions\", \"des\",\n      [\"randomly\", \"targeted\", \"all\"],\n      null,\n      [\"minions\", \"pirates\", \"beasts\", \"elementals\", \"totems\", \"weapons\"],\n      [\"enemy\", \"friendly\", \"all\"],\n      null);\n\n    \n\n\n\n\n\n  p.register_effect(\"Gain mana crystals\", \"gai\",\n    null,\n    [\"x\"],\n    null,\n    [\"enemy\", \"friendly\", \"all\"],\n    null);\n\n\n    p.register_effect(\"Set stats\", \"set\",\n      [\"randomly\", \"targeted\", \"all\"],\n      [\"x/x\"],\n      [\"minions\", \"pirates\", \"beasts\", \"elementals\", \"totems\"],\n      [\"enemy\", \"friendly\", \"all\"],\n      [\"turn\", \"permanently\"]);\n\n    p.register_effect(\"Give stats\", \"cha\",\n      [\"randomly\", \"targeted\", \"all\"],\n      [\"x/x\"],\n      [\"minions\", \"pirates\", \"beasts\", \"elementals\", \"totems\"],\n      [\"enemy\", \"friendly\", \"all\"],\n      [\"turn\", \"permanently\"]);\n\n\n    p.register_effect(\"Give keyword\", \"giv\",\n      [\"randomly\", \"targeted\", \"all\"],\n      [\"k\"],\n      [\"minions\", \"pirates\", \"beasts\", \"elementals\", \"totems\"],\n      [\"enemy\", \"friendly\", \"all\"],\n      [\"turn\", \"permanently\"]);\n\n\n\n  }\n\n\n  p.FancyMouse = class {\n    constuctor() {\n      this.busy = false;\n      this.xOffset = 0;\n      this.yOffset = 0;\n      this.effect = null;\n    }\n    setOffset(buttonX, buttonY) {\n      this.xOffset = p.mouseX - buttonX;\n      this.yOffset = p.mouseY - buttonY;\n    }\n  }\n\n\n\n\n\n  p.Effect = class {\n    constructor(label_name, effect_short, methods, param_format, targets, filters, duration) {\n      this.x = 0;\n      this.y = 0;\n\n      this.effect_string = \"\";\n      this.effect_string_height = 0;\n      this.effect_string_width = blank_spell_img.width * p.min(p.width*0.0005, 0.75)/2;\n      this.label_name = label_name;\n      this.effect_short = effect_short;\n\n      this.settings = {\n        methods: [methods, \"\"],\n        params: [param_format, \"\"],\n        targets: [targets, \"\"],\n        filters: [filters, \"\"],\n        duration: [duration, \"\"]\n      };\n    }\n    \n  }\n\n\n  p.Card = class {\n    constructor(card_id, card_task_index, card_class) {\n      this.y = 0;\n      this.x = 0;\n      this.w = blank_spell_img.width * 0.75;\n      this.h = blank_spell_img.height * 0.75;\n      this.oversized = false;\n\n\n      this.class = card_class;\n      this.type_id = 1; //creature\n      this.card_id = card_id;\n      this.card_task_index = card_task_index;\n\n\n      this.flav_img_index = p.floor(p.random(gan_imgs.length));\n      this.mana = 5;\n      this.power = 5;\n      this.toughness = 5;\n      this.effects = [];\n\n      this.hovered_effect = null;\n      this.mouse_over_card_effect = false;\n      this.mouse_over_mana = false;\n      this.mouse_over_power = false;\n      this.mouse_over_toughness = false;\n\n\n    }\n\n    resized() {\n      if (tasks[this.card_task_index].length == 1) {\n        this.x = p.map(2, 0, 3, w_padding, p.width - w_padding)\n      } else if (tasks[this.card_task_index].length == 2) {\n        this.x = p.map(this.card_id == 0 ? 1.5 : 2.5, 0, 3, w_padding, p.width - w_padding)\n      } else {\n        this.x = p.map(this.card_id + 1, 0, 3, w_padding, p.width - w_padding)\n      }\n      \n      this.y = p.height / 2;\n      this.w = blank_spell_img.width * p.min(p.width*0.0005, 0.75);\n      this.h = blank_spell_img.height * p.min(p.width*0.0005, 0.75);\n\n      for(let e of this.effects){\n        e.effect_string_width = blank_spell_img.width * p.min(p.width*0.0005, 0.75)*0.75;\n        p.textSize(font_pixels_small)\n        let num_lines = p.textWidth(e.effect_string)/e.effect_string_width;\n        e.effect_string_height = font_pixels_small * p.ceil(num_lines) + font_pixels_small;\n      }\n    }\n\n    run() {\n      this.generate_effect_text();\n      this.check_mouse_hovers();\n      this.display();\n    }\n\n    generate_effect_text() {\n      for (let e of this.effects) {\n        e.effect_string = \"\";\n        if (e.label_name == \"Keywords\" || e.label_name == \"Creature types\") {\n          e.effect_string = e.settings.params[1];\n        } else if (e.label_name == \"Deal damage\") {\n          if (e.settings.methods[1] == \"randomly\") {\n            e.effect_string = \"Battlecry: Deal \" + e.settings.params[1] + \" damage to a random \";\n          } else if (e.settings.methods[1] == \"targeted\") {\n            e.effect_string = \"Battlecry: Deal \" + e.settings.params[1] + \" damage to target \";\n          } else {\n            e.effect_string = \"Battlecry: Deal \" + e.settings.params[1] + \" damage to all \"\n          }\n\n          e.effect_string += e.settings.filters[1] == \"all\" ? \"\" : e.settings.filters[1] + \" \" //remove \"all all\"\n          if (e.settings.methods[1] == \"all\") {\n            e.effect_string += e.settings.targets[1]\n          } else {\n            e.effect_string += target_names_singular[target_names.indexOf(e.settings.targets[1])]\n          }\n        } else if (e.label_name == \"Destroy minions\") {\n          if (e.settings.methods[1] == \"randomly\") {\n            e.effect_string = \"Battlecry: Destroy a random \";\n          } else if (e.settings.methods[1] == \"targeted\") {\n            e.effect_string = \"Battlecry: Destroy a target \";\n          } else {\n            e.effect_string = \"Battlecry: Destroy all \"\n          }\n          e.effect_string += e.settings.filters[1] == \"all\" ? \"\" : e.settings.filters[1] + \" \" //remove \"all all\"\n          if (e.settings.methods[1] == \"all\") {\n            e.effect_string += e.settings.targets[1]\n          } else {\n            e.effect_string += target_names_singular[target_names.indexOf(e.settings.targets[1])]\n          }\n        } else if (e.label_name == \"Restore health\") {\n          if (e.settings.methods[1] == \"randomly\") {\n            e.effect_string = \"Battlecry: Restore \" + e.settings.params[1] + \" health to a random \";\n          } else if (e.settings.methods[1] == \"targeted\") {\n            e.effect_string = \"Battlecry: Restore \" + e.settings.params[1] + \" health to a target \";\n          } else {\n            e.effect_string = \"Battlecry: Restore \" + e.settings.params[1] + \" health to all \";\n          }\n          e.effect_string += e.settings.filters[1] == \"all\" ? \"\" : e.settings.filters[1] + \" \" //remove \"all all\"\n          if (e.settings.methods[1] == \"all\") {\n            e.effect_string += e.settings.targets[1]\n          } else {\n            e.effect_string += target_names_singular[target_names.indexOf(e.settings.targets[1])]\n          }\n        } else if (e.label_name == \"Draw cards\") {\n          if (e.settings.filters[1] == \"enemy\") {\n            e.effect_string = \"Battlecry: Enemy draws \" + e.settings.params[1] + \" cards\";\n          } else if (e.settings.filters[1] == \"friendly\") {\n            e.effect_string = \"Battlecry: Draw \" + e.settings.params[1] + \" cards\";\n          } else {\n            e.effect_string = \"Battlecry: Both players draw \" + e.settings.params[1] + \" cards\";\n          }       \n        } else if (e.label_name == \"Gain armour\") {\n          if (e.settings.filters[1] == \"enemy\") {\n            e.effect_string = \"Battlecry: Enemy gains \" + e.settings.params[1] + \" armour\";\n          } else if (e.settings.filters[1] == \"friendly\") {\n            e.effect_string = \"Battlecry: Gain \" + e.settings.params[1] + \" armour\";\n          } else {\n            e.effect_string = \"Battlecry: Both players gain \" + e.settings.params[1] + \" armour\";\n          }       \n         } else if (e.label_name == \"Return to hand\") {\n          if (e.settings.methods[1] == \"randomly\") {\n            e.effect_string = \"Battlecry: Return a random \";\n          } else if (e.settings.methods[1] == \"targeted\") {\n            e.effect_string = \"Battlecry: Return a target \";\n          } else {\n            e.effect_string = \"Battlecry: Return all \"\n          }\n          e.effect_string += e.settings.filters[1] == \"all\" ? \"\" : e.settings.filters[1] + \" \" //remove \"all all\"\n          if (e.settings.methods[1] == \"all\") {\n            e.effect_string += e.settings.targets[1]\n          } else {\n            e.effect_string += target_names_singular[target_names.indexOf(e.settings.targets[1])]\n          }\n          e.effect_string += \" to their owners hand.\"\n        } else if (e.label_name == \"Summon token\") {\n          e.effect_string = \"Battlecry: Summon a \" + e.settings.params[1] + \" minion\";\n        } else if (e.label_name == \"Gain mana crystals\") {\n          if (e.settings.filters[1] == \"enemy\") {\n            e.effect_string = \"Battlecry: Enemy gains \" + e.settings.params[1] + \" mana crystals\";\n          } else if (e.settings.filters[1] == \"friendly\") {\n            e.effect_string = \"Battlecry: Gain \" + e.settings.params[1] + \" mana crystals\";\n          } else {\n            e.effect_string = \"Battlecry: Both players gain \" + e.settings.params[1] + \" empty mana crystals\";\n          }       \n        } else if (e.label_name == \"Set stats\") {\n          if (e.settings.methods[1] == \"randomly\") {\n            e.effect_string = \"Battlecry: Set a random \";\n          } else if (e.settings.methods[1] == \"targeted\") {\n            e.effect_string = \"Battlecry: Set a target \";\n          } else {\n            e.effect_string = \"Battlecry: Set all \"\n          }\n          e.effect_string += e.settings.filters[1] == \"all\" ? \"\" : e.settings.filters[1] + \" \" //remove \"all all\"\n          if (e.settings.methods[1] == \"all\") {\n            e.effect_string += e.settings.targets[1]\n          } else {\n            e.effect_string += target_names_singular[target_names.indexOf(e.settings.targets[1])]\n          }\n          e.effect_string += \" to \" + e.settings.params[1]\n          if(e.settings.duration == \"turn\"){\n            e.effect_string += \" for this turn\"\n          } else {\n            e.effect_string += \" permanently\"\n\n          }\n        } else if (e.label_name == \"Give stats\") {\n          if (e.settings.methods[1] == \"randomly\") {\n            e.effect_string = \"Battlecry: Give a random \";\n          } else if (e.settings.methods[1] == \"targeted\") {\n            e.effect_string = \"Battlecry: Give a target \";\n          } else {\n            e.effect_string = \"Battlecry: Give all \"\n          }\n          e.effect_string += e.settings.filters[1] == \"all\" ? \"\" : e.settings.filters[1] + \" \" //remove \"all all\"\n          if (e.settings.methods[1] == \"all\") {\n            e.effect_string += e.settings.targets[1]\n          } else {\n            e.effect_string += target_names_singular[target_names.indexOf(e.settings.targets[1])]\n          }\n          e.effect_string += \" +\"+e.settings.params[1].split(\"/\")[0]+\"/+\"+e.settings.params[1].split(\"/\")[1]\n          if(e.settings.duration == \"turn\"){\n            e.effect_string += \" for this turn\"\n          } else {\n            e.effect_string += \" permanently\"\n\n          }\n        } else if (e.label_name == \"Give keyword\") {\n          if (e.settings.methods[1] == \"randomly\") {\n            e.effect_string = \"Battlecry: Give a random \";\n          } else if (e.settings.methods[1] == \"targeted\") {\n            e.effect_string = \"Battlecry: Give a target \";\n          } else {\n            e.effect_string = \"Battlecry: Give all \"\n          }\n          e.effect_string += e.settings.filters[1] == \"all\" ? \"\" : e.settings.filters[1] + \" \" //remove \"all all\"\n          if (e.settings.methods[1] == \"all\") {\n            e.effect_string += e.settings.targets[1]\n          } else {\n            e.effect_string += target_names_singular[target_names.indexOf(e.settings.targets[1])]\n          }\n          e.effect_string += \" \"+e.settings.params[1].toLowerCase()\n          if(e.settings.duration == \"turn\"){\n            e.effect_string += \" for this turn\"\n          } else {\n            e.effect_string += \" permanently\"\n\n          }\n        } else {\n          e.effect_string = e.label_name\n        }\n\n\n        p.textSize(font_pixels_small)\n        let num_lines = (p.textWidth(e.effect_string)+150)/e.effect_string_width;\n        e.effect_string_height = font_pixels_small * p.ceil(num_lines) + font_pixels_small;\n\n      }\n\n    }\n\n    display() {\n\n      p.push();\n      p.fill(0);\n      p.textAlign(p.CENTER, p.CENTER)\n      if (this.effects.length > 1) {\n        this.oversized = true;\n      } else {\n        this.oversized = false;\n      }\n\n\n      let flav = gan_imgs[this.flav_img_index].get();\n      let forg;\n\n      if (card_types[this.type_id] == \"spell\") {\n        flav.mask(rect_mask)\n        forg = blank_spell_img;\n      } else if (card_types[this.type_id] == \"minion\") {\n        flav.mask(ellipse_mask)\n        forg = this.oversized ? full_blank_creature_img : blank_creature_img;\n      } else {\n        flav.mask(rect_mask)\n        forg = blank_weapon_img;\n      }\n\n      if (!this.oversized) {\n        p.image(flav, this.x, this.y - this.h*0.20, this.w*0.7, this.h*0.7)\n      }\n      \n      p.image(forg, this.x, this.y, this.w, this.h);\n\n      p.push();\n      p.textSize(font_pixels_large*2);\n      p.fill(255);\n      p.strokeWeight(3);\n      p.stroke(0);\n\n      if (card_types[this.type_id] == \"minion\") {\n        p.text(this.power, this.x - this.w / 2.99, this.y + this.h / 2.8)\n        p.text(this.toughness, this.x + this.w / 2.6, this.y + this.h / 2.8)\n      }\n\n\n      p.text(this.mana, this.x - this.w / 2.99, this.y - this.h / 2.3)\n\n      p.pop();\n\n\n      p.push();\n      p.fill(0);\n      let translation_offset_y;\n      if (this.oversized) {\n        translation_offset_y = this.y - this.h *0.3;\n        p.translate(this.x, this.y - this.h * 0.3);\n      } else {\n        translation_offset_y = this.y + this.h*0.1;\n        p.translate(this.x, this.y + this.h*0.1);\n      }\n\n      this.mouse_over_card_effect = false;\n      this.hovered_effect = null;\n\n      for (let e of this.effects) {\n\n        translation_offset_y += e.effect_string_height / 2;\n        p.translate(0, e.effect_string_height / 2)\n\n        if (p.mouseY > translation_offset_y - e.effect_string_height / 2 &&\n          p.mouseY < translation_offset_y + e.effect_string_height / 2 &&\n          p.mouseX > this.x - e.effect_string_width / 2 &&\n          p.mouseX < this.x + e.effect_string_width / 2) {\n\n          this.mouse_over_card_effect = true;\n\n          this.hovered_effect = e;\n          this.hovered_effect.x = this.x - e.effect_string_width / 2;\n          this.hovered_effect.y = translation_offset_y - e.effect_string_height;\n          p.fill(0, 100);\n        } else {\n          p.fill(0, 50)\n        }\n        p.rect(0, 0, e.effect_string_width, e.effect_string_height, 4, 4)\n        p.fill(255, 255)\n        p.textSize(font_pixels_small)\n\n        p.textAlign(p.LEFT, p.TOP)\n        p.text(e.effect_string, 0, 0, e.effect_string_width, e.effect_string_height)\n        translation_offset_y += e.effect_string_height / 2 + 5;\n        p.translate(0, e.effect_string_height / 2 + 5)\n\n      }\n      p.pop();\n\n\n      p.push();\n\n      if (editing_card == this) {\n        if (editing == \"mana\") {\n          editX = this.x - this.w / 2.99;\n          editY = this.y - this.h / 2.3;\n        } else if (editing == \"power\") {\n          editX = this.x - this.w / 2.99;\n          editY = this.y + this.h / 2.8;\n        } else if (editing == \"toughness\") {\n          editX = this.x + this.w / 2.6;\n          editY = this.y + this.h / 2.8;\n        }\n      }\n\n      p.pop();\n      p.pop();\n    }\n\n\n    mouseInImg() {\n      return (p.mouseX > this.x - this.w / 2 - mouse_padding &&\n        p.mouseX < this.x + this.w / 2 + mouse_padding &&\n        p.mouseY > this.y - this.h / 2 - mouse_padding &&\n        p.mouseY < this.y + this.h / 2 + mouse_padding);\n\n    }\n    check_mouse_hovers() {\n      if (card_types[this.type_id] == \"minion\") {\n        this.mouse_over_power = p.dist(p.mouseX, p.mouseY, this.x - this.w / 2.99, this.y + this.h / 2.8) < 50\n        this.mouse_over_toughness = p.dist(p.mouseX, p.mouseY, this.x + this.w / 2.6, this.y + this.h / 2.8) < 50\n      }\n      this.mouse_over_mana = p.dist(p.mouseX, p.mouseY, this.x - this.w / 2.99, this.y - this.h / 2.3) < 50\n    }\n  }\n\n\n\n\n\n  p.Button = class {\n\n    constructor(button_name, button_id) {\n      this.button_name = button_name;\n      this.button_id = button_id;\n\n      this.x = 0;\n      this.y = 0;\n      this.w = p.textWidth(button_name) + 14;\n      this.h = font_pixels + 10;\n      this.fillAlpha = 100;\n\n      this.text_x = 0;\n      this.text_y = 0;\n    }\n    mouseInRegion() {\n      return (p.mouseX > this.x - this.w / 2 - mouse_padding &&\n        p.mouseX < this.x + this.w / 2 + mouse_padding &&\n        p.mouseY > this.y - this.h / 2 - mouse_padding &&\n        p.mouseY < this.y + this.h / 2 + mouse_padding);\n    }\n\n    resized() {\n      this.w = p.textWidth(this.button_name) + 14;\n      this.h = font_pixels + 10;\n\n      this.x = w_padding/2 + this.w / 2 - 7;\n      this.y = p.map(this.button_id, 0, 15, h_padding, p.height - h_padding);\n      this.text_x = this.x - this.w / 2 + 7;\n      this.text_y = this.y - 6;\n\n   \n    }\n\n    run() {\n      this.update();\n      this.display();\n    }\n\n    update() {\n\n      if (this.mouseInRegion() && current_survey_topic == 0) {\n        this.fillAlpha = 255;\n      } else {\n        this.fillAlpha = 100;\n      }\n\n    }\n\n    display() {\n\n\n      p.textSize(font_pixels)\n      p.textAlign(p.LEFT, p.CENTER)\n      p.fill(255, this.fillAlpha);\n      p.rect(this.x, this.y, this.w, this.h, 4, 4);\n      p.fill(0, 255);\n      p.text(this.button_name, this.text_x, this.text_y);\n    }\n\n\n  }\n\n\n  document.oncontextmenu = function () {\n    return false;\n  }\n\n\n}"]},"metadata":{},"sourceType":"module"}
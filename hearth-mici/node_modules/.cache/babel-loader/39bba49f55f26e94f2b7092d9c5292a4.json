{"ast":null,"code":"import _slicedToArray from\"/Users/aep/phd/hearth-mici/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _createForOfIteratorHelper from\"/Users/aep/phd/hearth-mici/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";export default function sketch(p){var _this=this;var blank_spell_img,blank_creature_img,blank_weapon_img,full_blank_creature_img;var bg;var GAN_imgs=[];var flavour_img,masked_flavour_ellipse,masked_flavour_rect;var buttons=[];var button_id=0;var effects=[];var experiments=[\"mvw\",\"2mur\",\"longer_game\"];var user=\"\";var cards=[];var card_num=3;var card_types=[\"spell\",\"minion\",\"weapon\"];var method_names=[\"randomly\",\"targeted\",\"all\",\"aura\"];var target_names=[\"minions\",\"heroes\",\"minions or heroes\",\"murlocs\",\"beasts\",\"demons\",\"totems\",\"weapons\"];var target_names_singular=[\"minion\",\"hero\",\"minion or hero\",\"murloc\",\"beast\",\"demon\",\"totem\",\"weapon\"];var filter_names=[\"enemy\",\"friendly\",\"all\"];var duration_names=[\"turn\",\"permanently\"];var param_format_names=[\"x\",\"x/x\",\"k\",\"c\"];var effect_names=[\"Deal damage\",\"Destroy\",\"Heal\",\"Gain armour\",\"Change stats\",\"Set stats\",\"Give keyword\",\"Return to hand\",\"Draw\",\"Gain mana\",\"Summon: \",\"Battlecry: \",\"Deathrattle: \"];var keywords=[\"Taunt\",\"Charge\",\"Lifesteal\",\"Spell damage +1\",\"Divine shield\",\"Poisonous\",\"Windfury\",\"Frozen\"];var all_creature_types=[\"murloc\",\"beast\",\"demon\",\"totem\",\"dragon\",\"pirate\",\"mech\",\"elemental\"];var creature_types=[\"Murloc\",\"Beast\",\"Demon\",\"Totem\"];var survey_topics=[\"none\",\"methods\",\"filters\",\"targets\",\"duration\",\"params\"];var current_survey_topic=0;var survey_drop_target=null;var font_pixels=24;var smaller_font_size=20;var hearthstone_font;var mouse_padding=1;var w_padding,h_padding;var grid_w_padding,grid_h_padding;var theMouse;var hoveredOption=-1;var editing=\"none\";var editing_card=null;var effect_to_remove=null;var editX=0;var editY=0;var simCount=3;var simulating=false;var simDuration=2000;var simTime=-simDuration;var mouse_over_queuer;var simResults=null;var simTurns=null;p.preload=function(){blank_spell_img=p.loadImage(\"blank_cards/spell.png\");blank_weapon_img=p.loadImage(\"blank_cards/weapon.png\");blank_creature_img=p.loadImage(\"blank_cards/creature.png\");full_blank_creature_img=p.loadImage(\"blank_cards/fullBlankCreature.png\");GAN_imgs.push(p.loadImage(\"gan_samples/sample_\"+p.floor(p.random(1000))+\".jpg\"));flavour_img=p.random(GAN_imgs);hearthstone_font=p.loadFont(\"BelweBoldBT.otf\");bg=p.loadImage(\"../images/bigger_paper.jpg\");};p.setup=function(){p.createCanvas(p.windowWidth,p.windowHeight);user=p.getURLParams().user;h_padding=p.height*0.1;w_padding=p.width*0.2;grid_h_padding=p.height*0.2;grid_w_padding=p.width*0.1;p.imageMode(p.CENTER);p.rectMode(p.CENTER);p.textFont(hearthstone_font);p.textSize(font_pixels);p.fill(255);p.noStroke();theMouse=new p.FancyMouse();p.register_all();for(var i=0;i<card_num;i++){cards.push(new p.Card(i,\"mvw\"));}p.resize_all();var ellipse_mask=p.createGraphics(p.width,p.height);p.ellipse_mask.ellipse(p.width/2,p.height/2+50,900,840);var rect_mask=p.createGraphics(p.width,p.height);p.rect_mask.rect(p.width/2-450,p.height/2-300,900,800);masked_flavour_ellipse=flavour_img.get();masked_flavour_ellipse.mask(ellipse_mask);masked_flavour_rect=flavour_img.get();masked_flavour_rect.mask(rect_mask);};p.draw=function(){p.background(255);p.textAlign(p.LEFT,p.CENTER);p.image(bg,p.width/2,p.height/2,p.width,p.height);var _iterator=_createForOfIteratorHelper(cards),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var c=_step.value;c.run();}}catch(err){_iterator.e(err);}finally{_iterator.f();}var _iterator2=_createForOfIteratorHelper(buttons),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var b=_step2.value;b.run();}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}if(theMouse.busy&&current_survey_topic==0){p.push();p.translate(p.mouseX-theMouse.xOffset,p.mouseY-theMouse.yOffset);p.textSize(28);p.text(theMouse.effect.label_name,0,0);p.pop();}p.draw_edit_overlay();p.sim_overlay();if(survey_topics[current_survey_topic]!=\"none\"){p.draw_survey();}};p.draw_survey=function(){p.push();p.textAlign(p.CENTER,p.CENTER);p.textSize(font_pixels);p.rectMode(p.CENTER);p.background(0,100);var setting=theMouse.effect.settings[survey_topics[current_survey_topic]];var options=setting[0];if(setting[0][0]==\"x\"){options=[1,2,3,4,5,6,7,8,9,10];}else if(setting[0][0]==\"k\"){options=keywords;}else if(setting[0][0]==\"c\"){options=creature_types;}if(options[0]==\"x/x\"){for(var attack=1;attack<11;attack++){for(var defense=1;defense<11;defense++){var xPos=p.map(attack,1,10,grid_w_padding,p.width-grid_w_padding);var yPos=p.map(defense,1,10,grid_h_padding,p.height-grid_h_padding);var boxWidth=(p.width-grid_w_padding*2)/10;var boxHeight=(p.height-grid_h_padding*2)/10;if(p.mouseX>xPos-boxWidth/2&&p.mouseX<xPos+boxWidth/2&&p.mouseY>yPos-boxHeight/2&&p.mouseY<yPos+boxHeight/2){p.fill(255,100);}else{p.fill(255,0);}p.rect(xPos,yPos,boxWidth,boxHeight);p.fill(255);p.text(attack+\"/\"+defense,xPos,yPos-10);}}}else{p.textSize(40);p.fill(255);p.text(theMouse.effect.label_name+\"...\",p.width/2,p.height*0.1);p.textSize(font_pixels);p.rectMode(p.CENTER);var optionButtonWidth=p.width/options.length*0.5;var optionButtonHeight=p.height*0.10;var optionButtonsPadding=p.width*0.25;var _iterator3=_createForOfIteratorHelper(options.entries()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_slicedToArray(_step3.value,2),index=_step3$value[0],option=_step3$value[1];var _xPos=p.map(index,0,options.length-1,optionButtonsPadding,p.width-optionButtonsPadding);if(p.mouseX>_xPos-optionButtonWidth/2&&p.mouseX<_xPos+optionButtonWidth/2){p.fill(255,100);hoveredOption=index;}else{p.fill(255,50);}p.rect(_xPos,p.height*0.5,optionButtonWidth,optionButtonHeight,16);p.fill(255);var optionString=option.toString();optionString=optionString[0].toUpperCase()+optionString.substring(1);optionString=optionString.split(\" \").join(\"\\n\");p.text(optionString,_xPos,p.height/2);}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}}p.pop();};p.mousePressedWhileSurveying=function(){if(p.progressSurveyThroughIssues()){return;}var setting=theMouse.effect.settings[survey_topics[current_survey_topic]];var options=setting[0];if(options[0]==\"x\"){options=[1,2,3,4,5,6,7,8,9,10];}else if(options[0]==\"k\"){options=keywords;}else if(options[0]==\"c\"){options=creature_types;}if(options[0]==\"x/x\"){setting[1]={x:p.floor(p.map(p.mouseX,0,p.width,1,11)),y:p.floor(p.map(p.mouseY,0,p.height,1,11))};}else{setting[1]=options[hoveredOption];}current_survey_topic++;if(p.progressSurveyThroughIssues()){return;}};p.mousePressedWhileNotSurveying=function(){var clickedCard=null;var _iterator4=_createForOfIteratorHelper(cards),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var c=_step4.value;if(c.mouseInImg()){clickedCard=c;}}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}if(clickedCard){if(theMouse.busy){//dropping effect onto a card\np.dropEffectOnCard(clickedCard);}else{//clicking on a card generally\np.clickToEditCard(clickedCard);}}else{if(theMouse.busy){//clicked away to drop label\ntheMouse.busy=false;theMouse.setOffset(0,0);theMouse.effect=null;}else{//other clicks\nif(mouse_over_queuer){p.add_to_queue();}p.mouse_click_while_editing();var _iterator5=_createForOfIteratorHelper(buttons),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var b=_step5.value;//clicking on a button with an empty hand\nif(b.mouseInRegion()){theMouse.busy=true;theMouse.setOffset(b.text_x,b.text_y);theMouse.effect=JSON.parse(JSON.stringify(effects[b.button_name]));break;}}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}}}};//returns true if you need to return out of mouse\np.progressSurveyThroughIssues=function(){if(current_survey_topic==survey_topics.length){p.finished_survey();return true;}for(var i=0;i<survey_topics.length;i++){if(theMouse.effect.settings[survey_topics[current_survey_topic]][0]==null||!param_format_names.includes(theMouse.effect.settings[survey_topics[current_survey_topic]][0][0])&&theMouse.effect.settings[survey_topics[current_survey_topic]][0].length==1){current_survey_topic++;if(current_survey_topic==survey_topics.length){p.finished_survey();return true;}}}if(current_survey_topic==survey_topics.length){p.finished_survey();return true;}return false;};p.dropEffectOnCard=function(c){current_survey_topic=1;survey_drop_target=c;if(p.progressSurveyThroughIssues()){return;}};p.clickToEditCard=function(c){if(c.mouse_over_mana){editing=\"mana\";editing_card=c;}else if(c.mouse_over_power){editing=\"power\";editing_card=c;}else if(c.mouse_over_toughness&&!(editing==\"effect\"&&p.dist(p.mouseX,p.mouseY,editX,editY)<10)){editing=\"toughness\";editing_card=c;}else if(c.mouse_over_card_effect&&!(editing==\"effect\"&&p.dist(p.mouseX,p.mouseY,editX,editY)<10)){editing=\"effect\";editX=c.hovered_effect.x+blank_spell_img.width/2;editY=c.hovered_effect.y+c.hovered_effect.effect_string_height/2;editing_card=c;effect_to_remove=c.hovered_effect;}else if(editing==\"effect\"&&p.dist(p.mouseX,p.mouseY,editX,editY)<10){editing_card.effects.splice(editing_card.effects.indexOf(effect_to_remove),1);editing=\"none\";}else{editing=\"none\";}};p.mouse_click_while_editing=function(){if(editing==\"mana\"){if(p.dist(p.mouseX,p.mouseY,editX-60,editY-50)<40){editing_card.mana--;}else if(p.dist(p.mouseX,p.mouseY,editX+60,editY-50)<40){editing_card.mana++;}else{editing=\"none\";}editing_card.mana=p.constrain(editing_card.mana,0,10);}else if(editing==\"power\"){if(p.dist(p.mouseX,p.mouseY,editX-60,editY+50)<40){editing_card.power--;}else if(p.dist(p.mouseX,p.mouseY,editX+60,editY+50)<40){editing_card.power++;}else{editing=\"none\";}editing_card.power=p.constrain(editing_card.power,0,10);}else if(editing==\"toughness\"){if(p.dist(p.mouseX,p.mouseY,editX-60,editY+50)<40){editing_card.toughness--;}else if(p.dist(p.mouseX,p.mouseY,editX+60,editY+50)<40){editing_card.toughness++;}else{editing=\"none\";}editing_card.toughness=p.constrain(editing_card.toughness,1,10);}else if(editing=\"effect\"){editing=\"none\";}};p.draw_edit_overlay=function(){p.push();if(editing!=\"none\"){p.translate(editX,editY);p.noStroke();if(editing==\"effect\"){p.rotate(p.QUARTER_PI);p.fill(0);p.rect(0,0,22,6);p.rect(0,0,6,22);p.fill(255);p.rect(0,0,20,4);p.rect(0,0,4,20);}else{p.fill(0);p.rect(-60,editing==\"mana\"?-50:75,32,8);p.rect(60,editing==\"mana\"?-50:75,32,8);p.rect(60,editing==\"mana\"?-50:75,8,32);p.fill(255);p.rect(-60,editing==\"mana\"?-50:75,30,6);p.rect(60,editing==\"mana\"?-50:75,30,6);p.rect(60,editing==\"mana\"?-50:75,6,30);}}p.pop();};p.mousePressed=function(){if(survey_topics[current_survey_topic]!=\"none\"){p.mousePressedWhileSurveying();}else{p.mousePressedWhileNotSurveying();}};p.finished_survey=function(){survey_drop_target.effects.push(JSON.parse(JSON.stringify(theMouse.effect)));current_survey_topic=0;theMouse.effect=null;theMouse.busy=false;};p.keyPressed=function(){if(p.key==' '&&!simulating){simResults=null;simTurns=null;simulating=true;simTime=simCount;p.submit();}};p.windowResized=function(){p.resizeCanvas(p.windowWidth,p.windowHeight);p.resize_all();};p.add_to_queue=function(){if(!simulating){simulating=true;simTime=p.millis();p.submit();}};p.sim_overlay=function(){p.push();var queur_x=p.map(2,0,3,w_padding,p.width-w_padding);var queur_y=p.height*0.85;mouse_over_queuer=p.mouseX>queur_x-100&&p.mouseX<queur_x+100&&p.mouseY>queur_y-30&&p.mouseY<queur_y+30;p.translate(queur_x,queur_y);if(mouse_over_queuer&&!simulating){p.fill(255,255);}else{p.fill(p.map(p.millis(),simTime,simTime+simDuration,100,255,true),100);}p.rect(0,0,200,60,4);p.fill(0,255);p.textAlign(p.CENTER,p.CENTER);p.text(simulating?\"Adding...\":\"Add to queue\",0,-4);p.rectMode(p.CORNER);// if(simulating)\n// p.fill(0)\n// p.rect(-100, -30, map(millis(), simTime, simTime+simDuration, 0, 200, true), 60, 4)\np.pop();if(simulating){if(p.millis()>simTime+simDuration){simulating=false;}}// if (simulating) {\n//   simTime = constrain(simTime - random(0.001, 0.002), 0, simCount);\n//   let lw = map(simTime, 0, simCount, 0, 200);\n//   noStroke();\n//   p.fill(200);\n//   p.rect(width * 0.5 - 100, height * 0.85 - 16, 200, 40)\n//   p.fill(0)\n//   p.rect(width * 0.5 - 100, height * 0.85 - 16, lw, 40)\n//   p.fill(255);\n//   text(\"Simulating...\", width * 0.5, height * 0.85)\n// } else {\n//   text(\"Press Spacebar to simulate\", width / 2, height * 0.9);\n// }\n// if (simResults != null) {\n//   text(\"The win rate with your card is: \" + simResults +\n//     \"%\\n\" + \"The average game lasted \" + simTurns +\n//     \" turns.\", width * 0.5, height * 0.10);\n// }\n};p.submit=function(){var submissions=[];var _iterator6=_createForOfIteratorHelper(cards),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var c=_step6.value;var card_submission={id:c.card_id,exp:c.card_experiment,user:user,p:c.power,t:c.toughness,m:c.mana};var repeat_checker={};var _iterator7=_createForOfIteratorHelper(c.effects),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var e=_step7.value;if(repeat_checker[e.effect_short]==undefined){repeat_checker[e.effect_short]=0;}else{repeat_checker[e.effect_short]++;}if(e.settings.methods[0]!=null)card_submission[e.effect_short+\"-method-\"+repeat_checker[e.effect_short]]=e.settings.methods[1];if(e.settings.params[0]!=null)card_submission[e.effect_short+\"-param-\"+repeat_checker[e.effect_short]]=e.settings.params[1];if(e.settings.targets[0]!=null)card_submission[e.effect_short+\"-target-\"+repeat_checker[e.effect_short]]=e.settings.targets[1];if(e.settings.filters[0]!=null)card_submission[e.effect_short+\"-filter-\"+repeat_checker[e.effect_short]]=e.settings.filters[1];if(e.settings.duration[0]!=null)card_submission[e.effect_short+\"-duration-\"+repeat_checker[e.effect_short]]=e.settings.duration[1];}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}submissions[c.card_experiment+\"-\"+c.card_id]=card_submission;}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}p.send_to_google_sheets(submissions);};p.send_to_google_sheets=function(submissions){var _iterator8=_createForOfIteratorHelper(submissions),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var submission=_step8.value;}// gapi.load('client', ()=>{\n//   gapi.client.init({ 'apiKey':  config.sheets_api_key}).then(()=>{\n//     gapi.client.sheets.spreadsheets.values.get({\n//       spreadsheetId: config.sheet_id,\n//       range: \"queue!A1:D5\"\n//     }).then((response) => {\n//       var result = response.result;\n//       var numRows = result.values ? result.values.length : 0;\n//       console.log(`${numRows} rows retrieved.`);\n//     });\n//   }); \n// });\n// httpPost('https://hearth-mici-backend.loca.lt/get_winrates', submission, (response) => {\n//   simulating = false;\n//   simResults = round(JSON.parse(response).win_rate, 2);\n//   simTurns = round(JSON.parse(response).num_turns, 2);\n//   console.log(simResults, simTurns)\n// });\n// httpPost('https://sheets.googleapis.com/v4/spreadsheets/1TlgFYV4zwkyfwGq1DNU39Sq1kOsOaL3jfppokpmgX0w/values/queue!A1:E1:append?key='+config.sheets_api_key, {\n//   range: \"queue!A1:E1\",\n//   key: config.sheets_api_key,\n//   majorDimension: \"ROWS\",\n//   values: [\n//     [\"Door\", \"$15\", \"2\", \"3/15/2016\"],\n//     [\"Engine\", \"$100\", \"1\", \"3/20/2016\"],\n//   ],\n// }, (response) => {\n//   console.log(response)\n// });\n}catch(err){_iterator8.e(err);}finally{_iterator8.f();}};p.resize_all=function(){var _iterator9=_createForOfIteratorHelper(buttons),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var b=_step9.value;b.resized();}}catch(err){_iterator9.e(err);}finally{_iterator9.f();}var _iterator10=_createForOfIteratorHelper(cards),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var c=_step10.value;c.resized();}}catch(err){_iterator10.e(err);}finally{_iterator10.f();}};p.register_effect=function(effect_text,effect_short,method,param,targets,filters,duration){effects[effect_text]=new p.Effect(effect_text,effect_short,method,param,targets,filters,duration);buttons.push(new p.Button(effect_text,button_id++));};p.register_all=function(){p.register_effect(\"Deal damage\",\"dam\",[\"randomly\",\"targeted\",\"all\"],[\"x\"],[\"minions\",\"heroes\",\"minions or heroes\",\"murlocs\",\"beasts\",\"demons\",\"totems\"],[\"enemy\",\"friendly\",\"all\"],null);p.register_effect(\"Destroy\",\"des\",[\"randomly\",\"targeted\",\"all\"],null,[\"minions\",\"murlocs\",\"beasts\",\"demons\",\"totems\",\"weapons\"],[\"enemy\",\"friendly\",\"all\"],null);p.register_effect(\"Heal\",\"hea\",[\"randomly\",\"targeted\",\"all\"],[\"x\"],[\"minions\",\"heroes\",\"minions or heroes\",\"murlocs\",\"beasts\",\"demons\",\"totems\"],[\"enemy\",\"friendly\",\"all\"],null);p.register_effect(\"Gain armour\",\"arm\",null,[\"x\"],null,null,null);p.register_effect(\"Change stats\",\"cha\",[\"randomly\",\"targeted\",\"all\",\"aura\"],[\"x/x\"],[\"minions\",\"heroes\",\"minions or heroes\",\"murlocs\",\"beasts\",\"demons\",\"totems\",\"weapons\"],[\"enemy\",\"friendly\",\"all\"],[\"turn\",\"permanently\"]);p.register_effect(\"Set stats\",\"set\",[\"randomly\",\"targeted\",\"all\",\"aura\"],[\"x/x\"],[\"minions\",\"heroes\",\"minions or heroes\",\"murlocs\",\"beasts\",\"demons\",\"totems\",\"weapons\"],[\"enemy\",\"friendly\",\"all\"],[\"turn\",\"permanently\"]);p.register_effect(\"Give keyword\",\"giv\",[\"randomly\",\"targeted\",\"all\",\"aura\"],[\"k\"],[\"minions\",\"heroes\",\"minions or heroes\",\"murlocs\",\"beasts\",\"demons\",\"totems\",\"weapons\"],[\"enemy\",\"friendly\",\"all\"],[\"turn\",\"permanently\"]);p.register_effect(\"Return to hand\",\"ret\",[\"randomly\",\"targeted\",\"all\"],null,[\"minions\",\"murlocs\",\"beasts\",\"demons\",\"totems\"],[\"enemy\",\"friendly\",\"all\"],null);p.register_effect(\"Draw\",\"dra\",null,[\"x\"],null,[\"enemy\",\"friendly\",\"all\"],null);p.register_effect(\"Gain mana\",\"gai\",null,[\"x\"],null,[\"enemy\",\"friendly\",\"all\"],null);p.register_effect(\"Summon\",\"sum\",null,[\"x/x\"],null,null,null);p.register_effect(\"Keyword\",\"key\",null,[\"k\"],null,null,null);p.register_effect(\"Creature type\",\"cre\",null,[\"c\"],null,null,null);};p.FancyMouse=function(fm){fm.constuctor=function(){_this.busy=false;_this.xOffset=0;_this.yOffset=0;_this.effect=null;};fm.setOffset=function(buttonX,buttonY){_this.xOffset=p.mouseX-buttonX;_this.yOffset=p.mouseY-buttonY;};};p.Effect=function(ef){ef.constructor=function(label_name,effect_short,methods,param_format,targets,filters,duration){_this.x=0;_this.y=0;_this.effect_string=\"\";_this.effect_string_height=0;_this.effect_string_width=blank_spell_img.width*0.5;_this.label_name=label_name;_this.effect_short=effect_short;_this.settings={methods:[methods,\"\"],params:[param_format,\"\"],targets:[targets,\"\"],filters:[filters,\"\"],duration:[duration,\"\"]};};};p.Card=function(cd){cd.constructor=function(card_id,card_experiment){_this.y=0;_this.x=0;_this.w=blank_spell_img.width*0.75;_this.h=blank_spell_img.height*0.75;_this.oversized=false;_this.class=\"mage\";_this.type_id=1;_this.card_id=card_id;_this.card_experiment=card_experiment;_this.creature_type=\"\";_this.mana=5;_this.power=5;_this.toughness=5;_this.keywords=[];_this.effects=[];_this.hovered_effect=null;_this.mouse_over_card_effect=false;_this.mouse_over_mana=false;_this.mouse_over_power=false;_this.mouse_over_toughness=false;};cd.resized=function(){_this.x=p.map(_this.card_id+1,0,cards.length,w_padding,p.width-w_padding);_this.y=p.height/2;};cd.run=function(){_this.generate_effect_text();_this.check_mouse_hovers();_this.display();};cd.generate_effect_text=function(){var _iterator11=_createForOfIteratorHelper(_this.effects),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var e=_step11.value;e.effect_string=\"\";if(e.label_name==\"Keyword\"||e.label_name==\"Creature type\"){e.effect_string=e.settings.params[1];}else if(e.label_name==\"Deal damage\"){if(e.settings.methods[1]==\"randomly\"){e.effect_string=\"Randomly deal \"+e.settings.params[1]+\" damage to a \";}else if(e.settings.methods[1]==\"targeted\"){e.effect_string=\"Deal \"+e.settings.params[1]+\" damage to target \";}else{e.effect_string=\"Deal \"+e.settings.params[1]+\" damage to all \";}e.effect_string+=e.settings.filters[1]==\"all\"?\"\":e.settings.filters[1]+\" \";//remove \"all all\"\nif(e.settings.methods[1]==\"all\"){e.effect_string+=e.settings.targets[1];}else{e.effect_string+=target_names_singular[target_names.indexOf(e.settings.targets[1])];}}else if(e.label_name==\"Destroy\"){if(e.settings.methods[1]==\"randomly\"){e.effect_string=\"Randomly destroy a \";}else if(e.settings.methods[1]==\"targeted\"){e.effect_string=\"Destroy a target \";}else{e.effect_string=\"Destroy all \";}e.effect_string+=e.settings.filters[1]==\"all\"?\"\":e.settings.filters[1]+\" \";//remove \"all all\"\nif(e.settings.methods[1]==\"all\"){e.effect_string+=e.settings.targets[1];}else{e.effect_string+=target_names_singular[target_names.indexOf(e.settings.targets[1])];}}else if(e.label_name==\"Heal\"){if(e.settings.methods[1]==\"randomly\"){e.effect_string=\"Restore \"+e.settings.params[1]+\" health to a random \";}else if(e.settings.methods[1]==\"targeted\"){e.effect_string=\"Restore \"+e.settings.params[1]+\" health to a target \";}else{e.effect_string=\"Restore \"+e.settings.params[1]+\" health to all \";}e.effect_string+=e.settings.filters[1]==\"all\"?\"\":e.settings.filters[1]+\" \";//remove \"all all\"\nif(e.settings.methods[1]==\"all\"){e.effect_string+=e.settings.targets[1];}else{e.effect_string+=target_names_singular[target_names.indexOf(e.settings.targets[1])];}}else{e.effect_string=e.label_name;}var estimatedCharactersPerLine=20;var estimatedLines=e.effect_string.length/estimatedCharactersPerLine;e.effect_string_height=smaller_font_size*estimatedLines+30;}}catch(err){_iterator11.e(err);}finally{_iterator11.f();}};cd.display=function(){p.push();p.fill(0);p.textAlign(p.CENTER,p.CENTER);if(_this.effects.length>2){_this.oversized=true;}else{_this.oversized=false;}var flav;var forg;if(card_types[_this.type_id]==\"spell\"){flav=masked_flavour_rect;forg=blank_spell_img;}else if(card_types[_this.type_id]==\"minion\"){flav=masked_flavour_ellipse;forg=_this.oversized?full_blank_creature_img:blank_creature_img;}else{flav=masked_flavour_rect;forg=blank_weapon_img;}if(!_this.oversized){p.image(flav,_this.x+5,_this.y-50,300,300);}p.image(forg,_this.x,_this.y,_this.w,_this.h);p.push();p.textSize(60);p.fill(255);p.strokeWeight(3);p.stroke(0);if(card_types[_this.type_id]==\"minion\"){p.text(_this.power,_this.x-_this.w/2.99,_this.y+_this.h/2.8);p.text(_this.toughness,_this.x+_this.w/2.6,_this.y+_this.h/2.8);}p.text(_this.mana,_this.x-_this.w/2.99,_this.y-_this.h/2.3);p.pop();p.push();p.fill(0);p.textSize(smaller_font_size);var translation_offset_y;if(_this.oversized){translation_offset_y=_this.y-_this.h/2+80;p.translate(_this.x,_this.y-_this.h/2+80);}else{translation_offset_y=_this.y+50;p.translate(_this.x,_this.y+50);}_this.mouse_over_card_effect=false;_this.hovered_effect=null;var _iterator12=_createForOfIteratorHelper(_this.effects),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var e=_step12.value;translation_offset_y+=e.effect_string_height/2;p.translate(0,e.effect_string_height/2);if(p.mouseY>translation_offset_y-e.effect_string_height/2&&p.mouseY<translation_offset_y+e.effect_string_height/2&&p.mouseX>_this.x-e.effect_string_width/2&&p.mouseX<_this.x+e.effect_string_width/2){_this.mouse_over_card_effect=true;_this.hovered_effect=e;_this.hovered_effect.x=_this.x-e.effect_string_width/2;_this.hovered_effect.y=translation_offset_y-e.effect_string_height;p.fill(0,100);}else{p.fill(0,50);}p.rect(0,0,e.effect_string_width,e.effect_string_height,4,4);p.fill(255,255);p.text(e.effect_string,0,0,blank_spell_img.width/2,blank_spell_img.height/2);translation_offset_y+=e.effect_string_height/2+5;p.translate(0,e.effect_string_height/2+5);}}catch(err){_iterator12.e(err);}finally{_iterator12.f();}p.pop();p.push();if(editing_card==_this){if(editing==\"mana\"){editX=_this.x-_this.w/2.99;editY=_this.y-_this.h/2.3;}else if(editing==\"power\"){editX=_this.x-_this.w/2.99;editY=_this.y+_this.h/2.8;}else if(editing==\"toughness\"){editX=_this.x+_this.w/2.6;editY=_this.y+_this.h/2.8;}}p.pop();};cd.mouseInImg=function(){return p.mouseX>_this.x-_this.w/2-mouse_padding&&p.mouseX<_this.x+_this.w/2+mouse_padding&&p.mouseY>_this.y-_this.h/2-mouse_padding&&p.mouseY<_this.y+_this.h/2+mouse_padding;};cd.check_mouse_hovers=function(){if(card_types[_this.type_id]==\"minion\"){_this.mouse_over_power=p.dist(p.mouseX,p.mouseY,_this.x-_this.w/2.99,_this.y+_this.h/2.8)<50;_this.mouse_over_toughness=p.dist(p.mouseX,p.mouseY,_this.x+_this.w/2.6,_this.y+_this.h/2.8)<50;}_this.mouse_over_mana=p.dist(p.mouseX,p.mouseY,_this.x-_this.w/2.99,_this.y-_this.h/2.3)<50;};};p.Button=function(btn){btn.constructor=function(button_name,button_id){_this.button_name=button_name;_this.button_id=button_id;_this.x=0;_this.y=0;_this.w=p.textWidth(button_name)+14;_this.h=font_pixels+10;_this.fillAlpha=100;_this.text_x=0;_this.text_y=0;};btn.mouseInRegion=function(){return p.mouseX>_this.x-_this.w/2-mouse_padding&&p.mouseX<_this.x+_this.w/2+mouse_padding&&p.mouseY>_this.y-_this.h/2-mouse_padding&&p.mouseY<_this.y+_this.h/2+mouse_padding;};btn.resized=function(){_this.x=w_padding-150+_this.w/2-7;_this.y=p.map(_this.button_id,0,buttons.length,h_padding,p.height-h_padding);_this.text_x=_this.x-_this.w/2+7;_this.text_y=_this.y-6;};btn.run=function(){_this.update();_this.display();};btn.update=function(){if(_this.mouseInRegion()&&current_survey_topic==0){_this.fillAlpha=255;}else{_this.fillAlpha=100;}};btn.display=function(){p.textSize(font_pixels);p.textAlign(p.LEFT,p.CENTER);p.fill(255,_this.fillAlpha);p.rect(_this.x,_this.y,_this.w,_this.h,4,4);p.fill(0,255);p.text(_this.button_name,_this.text_x,_this.text_y);};};document.oncontextmenu=function(){return false;};}","map":{"version":3,"sources":["/Users/aep/phd/hearth-mici/src/sketch_stuff/sketch.js"],"names":["sketch","p","blank_spell_img","blank_creature_img","blank_weapon_img","full_blank_creature_img","bg","GAN_imgs","flavour_img","masked_flavour_ellipse","masked_flavour_rect","buttons","button_id","effects","experiments","user","cards","card_num","card_types","method_names","target_names","target_names_singular","filter_names","duration_names","param_format_names","effect_names","keywords","all_creature_types","creature_types","survey_topics","current_survey_topic","survey_drop_target","font_pixels","smaller_font_size","hearthstone_font","mouse_padding","w_padding","h_padding","grid_w_padding","grid_h_padding","theMouse","hoveredOption","editing","editing_card","effect_to_remove","editX","editY","simCount","simulating","simDuration","simTime","mouse_over_queuer","simResults","simTurns","preload","loadImage","push","floor","random","loadFont","setup","createCanvas","windowWidth","windowHeight","getURLParams","height","width","imageMode","CENTER","rectMode","textFont","textSize","fill","noStroke","FancyMouse","register_all","i","Card","resize_all","ellipse_mask","createGraphics","ellipse","rect_mask","rect","get","mask","draw","background","textAlign","LEFT","image","c","run","b","busy","translate","mouseX","xOffset","mouseY","yOffset","text","effect","label_name","pop","draw_edit_overlay","sim_overlay","draw_survey","setting","settings","options","attack","defense","xPos","map","yPos","boxWidth","boxHeight","optionButtonWidth","length","optionButtonHeight","optionButtonsPadding","entries","index","option","optionString","toString","toUpperCase","substring","split","join","mousePressedWhileSurveying","progressSurveyThroughIssues","x","y","mousePressedWhileNotSurveying","clickedCard","mouseInImg","dropEffectOnCard","clickToEditCard","setOffset","add_to_queue","mouse_click_while_editing","mouseInRegion","text_x","text_y","JSON","parse","stringify","button_name","finished_survey","includes","mouse_over_mana","mouse_over_power","mouse_over_toughness","dist","mouse_over_card_effect","hovered_effect","effect_string_height","splice","indexOf","mana","constrain","power","toughness","rotate","QUARTER_PI","mousePressed","keyPressed","key","submit","windowResized","resizeCanvas","millis","queur_x","queur_y","CORNER","submissions","card_submission","id","card_id","exp","card_experiment","t","m","repeat_checker","e","effect_short","undefined","methods","params","targets","filters","duration","send_to_google_sheets","submission","resized","register_effect","effect_text","method","param","Effect","Button","fm","constuctor","buttonX","buttonY","ef","constructor","param_format","effect_string","effect_string_width","cd","w","h","oversized","class","type_id","creature_type","generate_effect_text","check_mouse_hovers","display","estimatedCharactersPerLine","estimatedLines","flav","forg","strokeWeight","stroke","translation_offset_y","btn","textWidth","fillAlpha","update","document","oncontextmenu"],"mappings":"kPACA,cAAe,SAASA,CAAAA,MAAT,CAAgBC,CAAhB,CAAkB,gBAEjC,GAAIC,CAAAA,eAAJ,CAAqBC,kBAArB,CAAyCC,gBAAzC,CAA2DC,uBAA3D,CACA,GAAIC,CAAAA,EAAJ,CACA,GAAIC,CAAAA,QAAQ,CAAG,EAAf,CACA,GAAIC,CAAAA,WAAJ,CAAiBC,sBAAjB,CAAyCC,mBAAzC,CAGA,GAAMC,CAAAA,OAAO,CAAG,EAAhB,CACA,GAAIC,CAAAA,SAAS,CAAG,CAAhB,CAEA,GAAMC,CAAAA,OAAO,CAAG,EAAhB,CAEA,GAAIC,CAAAA,WAAW,CAAG,CAAC,KAAD,CAAQ,MAAR,CAAgB,aAAhB,CAAlB,CACA,GAAIC,CAAAA,IAAI,CAAG,EAAX,CAEA,GAAMC,CAAAA,KAAK,CAAG,EAAd,CACA,GAAMC,CAAAA,QAAQ,CAAG,CAAjB,CACA,GAAMC,CAAAA,UAAU,CAAG,CAAC,OAAD,CAAU,QAAV,CAAoB,QAApB,CAAnB,CAEA,GAAMC,CAAAA,YAAY,CAAG,CAAC,UAAD,CAAa,UAAb,CAAyB,KAAzB,CAAgC,MAAhC,CAArB,CACA,GAAMC,CAAAA,YAAY,CAAG,CAAC,SAAD,CAAY,QAAZ,CAAsB,mBAAtB,CAA2C,SAA3C,CAAsD,QAAtD,CAAgE,QAAhE,CAA0E,QAA1E,CAAoF,SAApF,CAArB,CACA,GAAMC,CAAAA,qBAAqB,CAAG,CAAC,QAAD,CAAW,MAAX,CAAmB,gBAAnB,CAAqC,QAArC,CAA+C,OAA/C,CAAwD,OAAxD,CAAiE,OAAjE,CAA0E,QAA1E,CAA9B,CACA,GAAMC,CAAAA,YAAY,CAAG,CAAC,OAAD,CAAU,UAAV,CAAsB,KAAtB,CAArB,CACA,GAAMC,CAAAA,cAAc,CAAG,CAAC,MAAD,CAAS,aAAT,CAAvB,CACA,GAAMC,CAAAA,kBAAkB,CAAG,CAAC,GAAD,CAAM,KAAN,CAAa,GAAb,CAAkB,GAAlB,CAA3B,CACA,GAAMC,CAAAA,YAAY,CAAG,CAAC,aAAD,CAAgB,SAAhB,CAA2B,MAA3B,CAAmC,aAAnC,CAAkD,cAAlD,CAAkE,WAAlE,CAA+E,cAA/E,CAA+F,gBAA/F,CAAiH,MAAjH,CAAyH,WAAzH,CAAsI,UAAtI,CAAkJ,aAAlJ,CAAiK,eAAjK,CAArB,CACA,GAAMC,CAAAA,QAAQ,CAAG,CAAC,OAAD,CAAU,QAAV,CAAoB,WAApB,CAAiC,iBAAjC,CAAoD,eAApD,CAAqE,WAArE,CAAkF,UAAlF,CAA8F,QAA9F,CAAjB,CACA,GAAMC,CAAAA,kBAAkB,CAAG,CAAC,QAAD,CAAW,OAAX,CAAoB,OAApB,CAA6B,OAA7B,CAAsC,QAAtC,CAAgD,QAAhD,CAA0D,MAA1D,CAAkE,WAAlE,CAA3B,CACA,GAAMC,CAAAA,cAAc,CAAG,CAAC,QAAD,CAAW,OAAX,CAAoB,OAApB,CAA6B,OAA7B,CAAvB,CAEA,GAAMC,CAAAA,aAAa,CAAG,CAAC,MAAD,CAAS,SAAT,CAAoB,SAApB,CAA+B,SAA/B,CAA0C,UAA1C,CAAsD,QAAtD,CAAtB,CACA,GAAIC,CAAAA,oBAAoB,CAAG,CAA3B,CAEA,GAAIC,CAAAA,kBAAkB,CAAG,IAAzB,CAGA,GAAMC,CAAAA,WAAW,CAAG,EAApB,CACA,GAAMC,CAAAA,iBAAiB,CAAG,EAA1B,CACA,GAAIC,CAAAA,gBAAJ,CACA,GAAMC,CAAAA,aAAa,CAAG,CAAtB,CACA,GAAIC,CAAAA,SAAJ,CAAeC,SAAf,CACA,GAAIC,CAAAA,cAAJ,CAAoBC,cAApB,CAEA,GAAIC,CAAAA,QAAJ,CACA,GAAIC,CAAAA,aAAa,CAAG,CAAC,CAArB,CAEA,GAAIC,CAAAA,OAAO,CAAG,MAAd,CACA,GAAIC,CAAAA,YAAY,CAAG,IAAnB,CACA,GAAIC,CAAAA,gBAAgB,CAAG,IAAvB,CACA,GAAIC,CAAAA,KAAK,CAAG,CAAZ,CACA,GAAIC,CAAAA,KAAK,CAAG,CAAZ,CAEA,GAAIC,CAAAA,QAAQ,CAAG,CAAf,CACA,GAAIC,CAAAA,UAAU,CAAG,KAAjB,CACA,GAAIC,CAAAA,WAAW,CAAG,IAAlB,CACA,GAAIC,CAAAA,OAAO,CAAG,CAACD,WAAf,CAEA,GAAIE,CAAAA,iBAAJ,CAEA,GAAIC,CAAAA,UAAU,CAAG,IAAjB,CACA,GAAIC,CAAAA,QAAQ,CAAG,IAAf,CAIApD,CAAC,CAACqD,OAAF,CAAY,UAAM,CAChBpD,eAAe,CAAGD,CAAC,CAACsD,SAAF,CAAY,uBAAZ,CAAlB,CACAnD,gBAAgB,CAAGH,CAAC,CAACsD,SAAF,CAAY,wBAAZ,CAAnB,CACApD,kBAAkB,CAAGF,CAAC,CAACsD,SAAF,CAAY,0BAAZ,CAArB,CACAlD,uBAAuB,CAAGJ,CAAC,CAACsD,SAAF,CAAY,mCAAZ,CAA1B,CAEAhD,QAAQ,CAACiD,IAAT,CAAcvD,CAAC,CAACsD,SAAF,CAAY,sBAAsBtD,CAAC,CAACwD,KAAF,CAAQxD,CAAC,CAACyD,MAAF,CAAS,IAAT,CAAR,CAAtB,CAA8C,MAA1D,CAAd,EACAlD,WAAW,CAAGP,CAAC,CAACyD,MAAF,CAASnD,QAAT,CAAd,CAEA2B,gBAAgB,CAAGjC,CAAC,CAAC0D,QAAF,CAAW,iBAAX,CAAnB,CACArD,EAAE,CAAGL,CAAC,CAACsD,SAAF,CAAY,4BAAZ,CAAL,CACD,CAXD,CAcAtD,CAAC,CAAC2D,KAAF,CAAU,UAAM,CACd3D,CAAC,CAAC4D,YAAF,CAAe5D,CAAC,CAAC6D,WAAjB,CAA8B7D,CAAC,CAAC8D,YAAhC,EACAhD,IAAI,CAAGd,CAAC,CAAC+D,YAAF,GAAiBjD,IAAxB,CAEAsB,SAAS,CAAGpC,CAAC,CAACgE,MAAF,CAAW,GAAvB,CACA7B,SAAS,CAAGnC,CAAC,CAACiE,KAAF,CAAU,GAAtB,CACA3B,cAAc,CAAGtC,CAAC,CAACgE,MAAF,CAAW,GAA5B,CACA3B,cAAc,CAAGrC,CAAC,CAACiE,KAAF,CAAU,GAA3B,CACAjE,CAAC,CAACkE,SAAF,CAAYlE,CAAC,CAACmE,MAAd,EACAnE,CAAC,CAACoE,QAAF,CAAWpE,CAAC,CAACmE,MAAb,EACAnE,CAAC,CAACqE,QAAF,CAAWpC,gBAAX,EACAjC,CAAC,CAACsE,QAAF,CAAWvC,WAAX,EACA/B,CAAC,CAACuE,IAAF,CAAO,GAAP,EACAvE,CAAC,CAACwE,QAAF,GAKAjC,QAAQ,CAAG,GAAIvC,CAAAA,CAAC,CAACyE,UAAN,EAAX,CAGAzE,CAAC,CAAC0E,YAAF,GAGA,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG3D,QAApB,CAA8B2D,CAAC,EAA/B,CAAmC,CACjC5D,KAAK,CAACwC,IAAN,CAAW,GAAIvD,CAAAA,CAAC,CAAC4E,IAAN,CAAWD,CAAX,CAAc,KAAd,CAAX,EACD,CAED3E,CAAC,CAAC6E,UAAF,GAGA,GAAIC,CAAAA,YAAY,CAAG9E,CAAC,CAAC+E,cAAF,CAAiB/E,CAAC,CAACiE,KAAnB,CAA0BjE,CAAC,CAACgE,MAA5B,CAAnB,CACAhE,CAAC,CAAC8E,YAAF,CAAeE,OAAf,CAAuBhF,CAAC,CAACiE,KAAF,CAAU,CAAjC,CAAoCjE,CAAC,CAACgE,MAAF,CAAW,CAAX,CAAa,EAAjD,CAAqD,GAArD,CAA0D,GAA1D,EAEA,GAAIiB,CAAAA,SAAS,CAAGjF,CAAC,CAAC+E,cAAF,CAAiB/E,CAAC,CAACiE,KAAnB,CAA0BjE,CAAC,CAACgE,MAA5B,CAAhB,CACAhE,CAAC,CAACiF,SAAF,CAAYC,IAAZ,CAAiBlF,CAAC,CAACiE,KAAF,CAAU,CAAV,CAAY,GAA7B,CAAkCjE,CAAC,CAACgE,MAAF,CAAW,CAAX,CAAe,GAAjD,CAAsD,GAAtD,CAA2D,GAA3D,EAEAxD,sBAAsB,CAAGD,WAAW,CAAC4E,GAAZ,EAAzB,CACA3E,sBAAsB,CAAC4E,IAAvB,CAA4BN,YAA5B,EACArE,mBAAmB,CAAGF,WAAW,CAAC4E,GAAZ,EAAtB,CACA1E,mBAAmB,CAAC2E,IAApB,CAAyBH,SAAzB,EAID,CA5CD,CA+CAjF,CAAC,CAACqF,IAAF,CAAS,UAAM,CACbrF,CAAC,CAACsF,UAAF,CAAa,GAAb,EACAtF,CAAC,CAACuF,SAAF,CAAYvF,CAAC,CAACwF,IAAd,CAAoBxF,CAAC,CAACmE,MAAtB,EACAnE,CAAC,CAACyF,KAAF,CAAQpF,EAAR,CAAYL,CAAC,CAACiE,KAAF,CAAU,CAAtB,CAAyBjE,CAAC,CAACgE,MAAF,CAAW,CAApC,CAAuChE,CAAC,CAACiE,KAAzC,CAAgDjE,CAAC,CAACgE,MAAlD,EAHa,yCAKCjD,KALD,YAKb,+CAAqB,IAAZ2E,CAAAA,CAAY,aACnBA,CAAC,CAACC,GAAF,GACD,CAPY,+FASCjF,OATD,aASb,kDAAuB,IAAdkF,CAAAA,CAAc,cACrBA,CAAC,CAACD,GAAF,GACD,CAXY,uDAab,GAAGpD,QAAQ,CAACsD,IAAT,EAAiBhE,oBAAoB,EAAI,CAA5C,CAA8C,CAC5C7B,CAAC,CAACuD,IAAF,GACAvD,CAAC,CAAC8F,SAAF,CAAY9F,CAAC,CAAC+F,MAAF,CAASxD,QAAQ,CAACyD,OAA9B,CAAuChG,CAAC,CAACiG,MAAF,CAAS1D,QAAQ,CAAC2D,OAAzD,EACAlG,CAAC,CAACsE,QAAF,CAAW,EAAX,EACAtE,CAAC,CAACmG,IAAF,CAAO5D,QAAQ,CAAC6D,MAAT,CAAgBC,UAAvB,CAAmC,CAAnC,CAAsC,CAAtC,EACArG,CAAC,CAACsG,GAAF,GACD,CAEDtG,CAAC,CAACuG,iBAAF,GAEAvG,CAAC,CAACwG,WAAF,GAGA,GAAG5E,aAAa,CAACC,oBAAD,CAAb,EAAuC,MAA1C,CAAiD,CAC/C7B,CAAC,CAACyG,WAAF,GACD,CAEF,CA9BD,CAkCAzG,CAAC,CAACyG,WAAF,CAAgB,UAAM,CACpBzG,CAAC,CAACuD,IAAF,GACAvD,CAAC,CAACuF,SAAF,CAAYvF,CAAC,CAACmE,MAAd,CAAsBnE,CAAC,CAACmE,MAAxB,EACAnE,CAAC,CAACsE,QAAF,CAAWvC,WAAX,EAEA/B,CAAC,CAACoE,QAAF,CAAWpE,CAAC,CAACmE,MAAb,EACAnE,CAAC,CAACsF,UAAF,CAAa,CAAb,CAAgB,GAAhB,EAEA,GAAIoB,CAAAA,OAAO,CAAGnE,QAAQ,CAAC6D,MAAT,CAAgBO,QAAhB,CAAyB/E,aAAa,CAACC,oBAAD,CAAtC,CAAd,CACA,GAAI+E,CAAAA,OAAO,CAAGF,OAAO,CAAC,CAAD,CAArB,CAGA,GAAGA,OAAO,CAAC,CAAD,CAAP,CAAW,CAAX,GAAiB,GAApB,CAAwB,CACtBE,OAAO,CAAG,CAAC,CAAD,CAAI,CAAJ,CAAO,CAAP,CAAU,CAAV,CAAa,CAAb,CAAgB,CAAhB,CAAmB,CAAnB,CAAsB,CAAtB,CAAyB,CAAzB,CAA4B,EAA5B,CAAV,CACD,CAFD,IAEO,IAAGF,OAAO,CAAC,CAAD,CAAP,CAAW,CAAX,GAAiB,GAApB,CAAwB,CAC7BE,OAAO,CAAGnF,QAAV,CACD,CAFM,IAEA,IAAGiF,OAAO,CAAC,CAAD,CAAP,CAAW,CAAX,GAAiB,GAApB,CAAwB,CAC7BE,OAAO,CAAGjF,cAAV,CACD,CAGD,GAAGiF,OAAO,CAAC,CAAD,CAAP,EAAc,KAAjB,CAAuB,CACrB,IAAI,GAAIC,CAAAA,MAAM,CAAG,CAAjB,CAAoBA,MAAM,CAAG,EAA7B,CAAiCA,MAAM,EAAvC,CAA0C,CACxC,IAAI,GAAIC,CAAAA,OAAO,CAAG,CAAlB,CAAqBA,OAAO,CAAG,EAA/B,CAAmCA,OAAO,EAA1C,CAA6C,CAC3C,GAAIC,CAAAA,IAAI,CAAG/G,CAAC,CAACgH,GAAF,CAAMH,MAAN,CAAc,CAAd,CAAiB,EAAjB,CAAqBxE,cAArB,CAAqCrC,CAAC,CAACiE,KAAF,CAAQ5B,cAA7C,CAAX,CACA,GAAI4E,CAAAA,IAAI,CAAGjH,CAAC,CAACgH,GAAF,CAAMF,OAAN,CAAe,CAAf,CAAkB,EAAlB,CAAsBxE,cAAtB,CAAsCtC,CAAC,CAACgE,MAAF,CAAS1B,cAA/C,CAAX,CACA,GAAI4E,CAAAA,QAAQ,CAAG,CAAClH,CAAC,CAACiE,KAAF,CAAQ5B,cAAc,CAAC,CAAxB,EAA2B,EAA1C,CACA,GAAI8E,CAAAA,SAAS,CAAG,CAACnH,CAAC,CAACgE,MAAF,CAAS1B,cAAc,CAAC,CAAzB,EAA4B,EAA5C,CAEA,GAAGtC,CAAC,CAAC+F,MAAF,CAAWgB,IAAI,CAAGG,QAAQ,CAAC,CAA3B,EAAgClH,CAAC,CAAC+F,MAAF,CAAWgB,IAAI,CAAGG,QAAQ,CAAC,CAA3D,EACDlH,CAAC,CAACiG,MAAF,CAAWgB,IAAI,CAAGE,SAAS,CAAC,CAD3B,EACgCnH,CAAC,CAACiG,MAAF,CAAWgB,IAAI,CAACE,SAAS,CAAC,CAD7D,CAC+D,CACzDnH,CAAC,CAACuE,IAAF,CAAO,GAAP,CAAY,GAAZ,EACH,CAHH,IAGS,CACLvE,CAAC,CAACuE,IAAF,CAAO,GAAP,CAAY,CAAZ,EACD,CACDvE,CAAC,CAACkF,IAAF,CAAO6B,IAAP,CAAaE,IAAb,CAAmBC,QAAnB,CAA6BC,SAA7B,EACAnH,CAAC,CAACuE,IAAF,CAAO,GAAP,EACAvE,CAAC,CAACmG,IAAF,CAAOU,MAAM,CAAG,GAAT,CAAeC,OAAtB,CAA+BC,IAA/B,CAAqCE,IAAI,CAAC,EAA1C,EACH,CACF,CACF,CAnBD,IAmBO,CAGPjH,CAAC,CAACsE,QAAF,CAAW,EAAX,EACAtE,CAAC,CAACuE,IAAF,CAAO,GAAP,EACAvE,CAAC,CAACmG,IAAF,CAAO5D,QAAQ,CAAC6D,MAAT,CAAgBC,UAAhB,CAA6B,KAApC,CAA2CrG,CAAC,CAACiE,KAAF,CAAQ,CAAnD,CAAsDjE,CAAC,CAACgE,MAAF,CAAS,GAA/D,EAEAhE,CAAC,CAACsE,QAAF,CAAWvC,WAAX,EACA/B,CAAC,CAACoE,QAAF,CAAWpE,CAAC,CAACmE,MAAb,EAEA,GAAIiD,CAAAA,iBAAiB,CAAIpH,CAAC,CAACiE,KAAF,CAAQ2C,OAAO,CAACS,MAAjB,CAAyB,GAAjD,CACA,GAAIC,CAAAA,kBAAkB,CAAGtH,CAAC,CAACgE,MAAF,CAAS,IAAlC,CACA,GAAIuD,CAAAA,oBAAoB,CAAGvH,CAAC,CAACiE,KAAF,CAAQ,IAAnC,CAZO,0CAcoB2C,OAAO,CAACY,OAAR,EAdpB,aAcP,kDAA6C,iDAApCC,KAAoC,iBAA7BC,MAA6B,iBAC3C,GAAIX,CAAAA,KAAI,CAAG/G,CAAC,CAACgH,GAAF,CAAMS,KAAN,CAAa,CAAb,CAAgBb,OAAO,CAACS,MAAR,CAAe,CAA/B,CAAkCE,oBAAlC,CAAwDvH,CAAC,CAACiE,KAAF,CAAQsD,oBAAhE,CAAX,CACA,GAAGvH,CAAC,CAAC+F,MAAF,CAAWgB,KAAI,CAACK,iBAAiB,CAAC,CAAlC,EAAuCpH,CAAC,CAAC+F,MAAF,CAAWgB,KAAI,CAAGK,iBAAiB,CAAC,CAA9E,CAAgF,CAC9EpH,CAAC,CAACuE,IAAF,CAAO,GAAP,CAAY,GAAZ,EACA/B,aAAa,CAAGiF,KAAhB,CACD,CAHD,IAGO,CACLzH,CAAC,CAACuE,IAAF,CAAO,GAAP,CAAY,EAAZ,EACD,CACDvE,CAAC,CAACkF,IAAF,CAAO6B,KAAP,CAAa/G,CAAC,CAACgE,MAAF,CAAS,GAAtB,CAA2BoD,iBAA3B,CAA8CE,kBAA9C,CAAkE,EAAlE,EACAtH,CAAC,CAACuE,IAAF,CAAO,GAAP,EAEA,GAAIoD,CAAAA,YAAY,CAAGD,MAAM,CAACE,QAAP,EAAnB,CACAD,YAAY,CAAGA,YAAY,CAAC,CAAD,CAAZ,CAAgBE,WAAhB,GAAgCF,YAAY,CAACG,SAAb,CAAuB,CAAvB,CAA/C,CACAH,YAAY,CAAGA,YAAY,CAACI,KAAb,CAAmB,GAAnB,EAAwBC,IAAxB,CAA6B,IAA7B,CAAf,CAEAhI,CAAC,CAACmG,IAAF,CAAOwB,YAAP,CAAqBZ,KAArB,CAA2B/G,CAAC,CAACgE,MAAF,CAAS,CAApC,EACD,CA9BM,uDA+BR,CAEDhE,CAAC,CAACsG,GAAF,GACC,CA1ED,CA6EAtG,CAAC,CAACiI,0BAAF,CAA+B,UAAM,CACnC,GAAGjI,CAAC,CAACkI,2BAAF,EAAH,CAAmC,CACjC,OACD,CAGD,GAAIxB,CAAAA,OAAO,CAAGnE,QAAQ,CAAC6D,MAAT,CAAgBO,QAAhB,CAAyB/E,aAAa,CAACC,oBAAD,CAAtC,CAAd,CACA,GAAI+E,CAAAA,OAAO,CAAGF,OAAO,CAAC,CAAD,CAArB,CACA,GAAGE,OAAO,CAAC,CAAD,CAAP,EAAc,GAAjB,CAAqB,CACnBA,OAAO,CAAG,CAAC,CAAD,CAAI,CAAJ,CAAO,CAAP,CAAU,CAAV,CAAa,CAAb,CAAgB,CAAhB,CAAmB,CAAnB,CAAsB,CAAtB,CAAyB,CAAzB,CAA4B,EAA5B,CAAV,CACD,CAFD,IAEO,IAAIA,OAAO,CAAC,CAAD,CAAP,EAAc,GAAlB,CAAsB,CAC3BA,OAAO,CAAGnF,QAAV,CACD,CAFM,IAEA,IAAImF,OAAO,CAAC,CAAD,CAAP,EAAc,GAAlB,CAAsB,CAC3BA,OAAO,CAAGjF,cAAV,CACD,CAED,GAAGiF,OAAO,CAAC,CAAD,CAAP,EAAc,KAAjB,CAAuB,CACrBF,OAAO,CAAC,CAAD,CAAP,CAAa,CAACyB,CAAC,CAAEnI,CAAC,CAACwD,KAAF,CAAQxD,CAAC,CAACgH,GAAF,CAAMhH,CAAC,CAAC+F,MAAR,CAAgB,CAAhB,CAAmB/F,CAAC,CAACiE,KAArB,CAA4B,CAA5B,CAA+B,EAA/B,CAAR,CAAJ,CACCmE,CAAC,CAAEpI,CAAC,CAACwD,KAAF,CAAQxD,CAAC,CAACgH,GAAF,CAAMhH,CAAC,CAACiG,MAAR,CAAgB,CAAhB,CAAmBjG,CAAC,CAACgE,MAArB,CAA6B,CAA7B,CAAgC,EAAhC,CAAR,CADJ,CAAb,CAED,CAHD,IAGO,CACL0C,OAAO,CAAC,CAAD,CAAP,CAAaE,OAAO,CAACpE,aAAD,CAApB,CACD,CAEDX,oBAAoB,GAEpB,GAAG7B,CAAC,CAACkI,2BAAF,EAAH,CAAmC,CACjC,OACD,CAEF,CA7BD,CAgCAlI,CAAC,CAACqI,6BAAF,CAAkC,UAAM,CACtC,GAAIC,CAAAA,WAAW,CAAG,IAAlB,CADsC,0CAGxBvH,KAHwB,aAGtC,kDAAqB,IAAZ2E,CAAAA,CAAY,cACnB,GAAIA,CAAC,CAAC6C,UAAF,EAAJ,CAAoB,CAClBD,WAAW,CAAG5C,CAAd,CACD,CACF,CAPqC,uDAUtC,GAAG4C,WAAH,CAAe,CACb,GAAG/F,QAAQ,CAACsD,IAAZ,CAAiB,CAAE;AACjB7F,CAAC,CAACwI,gBAAF,CAAmBF,WAAnB,EACD,CAFD,IAEO,CAAE;AACPtI,CAAC,CAACyI,eAAF,CAAkBH,WAAlB,EACD,CACF,CAND,IAMO,CACL,GAAG/F,QAAQ,CAACsD,IAAZ,CAAiB,CAAE;AACjBtD,QAAQ,CAACsD,IAAT,CAAgB,KAAhB,CACAtD,QAAQ,CAACmG,SAAT,CAAmB,CAAnB,CAAsB,CAAtB,EACAnG,QAAQ,CAAC6D,MAAT,CAAkB,IAAlB,CACD,CAJD,IAIO,CAAE;AAEP,GAAGlD,iBAAH,CAAqB,CACnBlD,CAAC,CAAC2I,YAAF,GACD,CAED3I,CAAC,CAAC4I,yBAAF,GANK,0CASSlI,OATT,aASL,kDAAuB,IAAdkF,CAAAA,CAAc,cAAE;AACvB,GAAIA,CAAC,CAACiD,aAAF,EAAJ,CAAuB,CACrBtG,QAAQ,CAACsD,IAAT,CAAgB,IAAhB,CACAtD,QAAQ,CAACmG,SAAT,CAAmB9C,CAAC,CAACkD,MAArB,CAA6BlD,CAAC,CAACmD,MAA/B,EACAxG,QAAQ,CAAC6D,MAAT,CAAkB4C,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAetI,OAAO,CAACgF,CAAC,CAACuD,WAAH,CAAtB,CAAX,CAAlB,CAEA,MACD,CACF,CAjBI,uDAkBN,CACF,CAEF,CA1CD,CA8CA;AACAnJ,CAAC,CAACkI,2BAAF,CAAgC,UAAM,CACpC,GAAGrG,oBAAoB,EAAID,aAAa,CAACyF,MAAzC,CAAgD,CAC9CrH,CAAC,CAACoJ,eAAF,GACA,MAAO,KAAP,CACD,CAED,IAAI,GAAIzE,CAAAA,CAAC,CAAG,CAAZ,CAAeA,CAAC,CAAG/C,aAAa,CAACyF,MAAjC,CAAyC1C,CAAC,EAA1C,CAA6C,CAC3C,GAAGpC,QAAQ,CAAC6D,MAAT,CAAgBO,QAAhB,CAAyB/E,aAAa,CAACC,oBAAD,CAAtC,EAA8D,CAA9D,GAAoE,IAApE,EACA,CAACN,kBAAkB,CAAC8H,QAAnB,CAA4B9G,QAAQ,CAAC6D,MAAT,CAAgBO,QAAhB,CAAyB/E,aAAa,CAACC,oBAAD,CAAtC,EAA8D,CAA9D,EAAiE,CAAjE,CAA5B,CAAD,EACAU,QAAQ,CAAC6D,MAAT,CAAgBO,QAAhB,CAAyB/E,aAAa,CAACC,oBAAD,CAAtC,EAA8D,CAA9D,EAAiEwF,MAAjE,EAA2E,CAF9E,CAEiF,CAC/ExF,oBAAoB,GACpB,GAAGA,oBAAoB,EAAID,aAAa,CAACyF,MAAzC,CAAgD,CAC9CrH,CAAC,CAACoJ,eAAF,GACA,MAAO,KAAP,CACD,CACF,CACF,CAGD,GAAGvH,oBAAoB,EAAID,aAAa,CAACyF,MAAzC,CAAgD,CAC9CrH,CAAC,CAACoJ,eAAF,GACA,MAAO,KAAP,CACD,CAGD,MAAO,MAAP,CACD,CA1BD,CA4BApJ,CAAC,CAACwI,gBAAF,CAAqB,SAAC9C,CAAD,CAAO,CACxB7D,oBAAoB,CAAG,CAAvB,CACAC,kBAAkB,CAAG4D,CAArB,CAEA,GAAG1F,CAAC,CAACkI,2BAAF,EAAH,CAAmC,CAEjC,OACD,CACJ,CARD,CAWAlI,CAAC,CAACyI,eAAF,CAAoB,SAAC/C,CAAD,CAAO,CAEzB,GAAGA,CAAC,CAAC4D,eAAL,CAAqB,CACnB7G,OAAO,CAAG,MAAV,CACAC,YAAY,CAAGgD,CAAf,CACD,CAHD,IAGO,IAAGA,CAAC,CAAC6D,gBAAL,CAAsB,CAC3B9G,OAAO,CAAG,OAAV,CACAC,YAAY,CAAGgD,CAAf,CACD,CAHM,IAGA,IAAGA,CAAC,CAAC8D,oBAAF,EAA0B,EAAE/G,OAAO,EAAG,QAAV,EAAsBzC,CAAC,CAACyJ,IAAF,CAAOzJ,CAAC,CAAC+F,MAAT,CAAiB/F,CAAC,CAACiG,MAAnB,CAA2BrD,KAA3B,CAAkCC,KAAlC,EAA2C,EAAnE,CAA7B,CAAoG,CACzGJ,OAAO,CAAG,WAAV,CACAC,YAAY,CAAGgD,CAAf,CACD,CAHM,IAGA,IAAGA,CAAC,CAACgE,sBAAF,EAA4B,EAAEjH,OAAO,EAAG,QAAV,EAAsBzC,CAAC,CAACyJ,IAAF,CAAOzJ,CAAC,CAAC+F,MAAT,CAAiB/F,CAAC,CAACiG,MAAnB,CAA2BrD,KAA3B,CAAkCC,KAAlC,EAA2C,EAAnE,CAA/B,CAAuG,CAC5GJ,OAAO,CAAG,QAAV,CACAG,KAAK,CAAG8C,CAAC,CAACiE,cAAF,CAAiBxB,CAAjB,CAAqBlI,eAAe,CAACgE,KAAhB,CAAsB,CAAnD,CACApB,KAAK,CAAG6C,CAAC,CAACiE,cAAF,CAAiBvB,CAAjB,CAAqB1C,CAAC,CAACiE,cAAF,CAAiBC,oBAAjB,CAAsC,CAAnE,CACAlH,YAAY,CAAGgD,CAAf,CACA/C,gBAAgB,CAAG+C,CAAC,CAACiE,cAArB,CACA,CANK,IAMC,IAAGlH,OAAO,EAAE,QAAT,EAAqBzC,CAAC,CAACyJ,IAAF,CAAOzJ,CAAC,CAAC+F,MAAT,CAAiB/F,CAAC,CAACiG,MAAnB,CAA2BrD,KAA3B,CAAkCC,KAAlC,EAA2C,EAAnE,CAAsE,CAC1EH,YAAY,CAAC9B,OAAb,CAAqBiJ,MAArB,CAA4BnH,YAAY,CAAC9B,OAAb,CAAqBkJ,OAArB,CAA6BnH,gBAA7B,CAA5B,CAA4E,CAA5E,EACAF,OAAO,CAAG,MAAV,CACD,CAHK,IAGC,CACPA,OAAO,CAAG,MAAV,CACD,CACF,CAvBD,CA0BAzC,CAAC,CAAC4I,yBAAF,CAA8B,UAAM,CAClC,GAAGnG,OAAO,EAAI,MAAd,CAAqB,CACnB,GAAGzC,CAAC,CAACyJ,IAAF,CAAOzJ,CAAC,CAAC+F,MAAT,CAAiB/F,CAAC,CAACiG,MAAnB,CAA2BrD,KAAK,CAAC,EAAjC,CAAqCC,KAAK,CAAC,EAA3C,EAA+C,EAAlD,CAAqD,CACnDH,YAAY,CAACqH,IAAb,GACD,CAFD,IAEO,IAAG/J,CAAC,CAACyJ,IAAF,CAAOzJ,CAAC,CAAC+F,MAAT,CAAiB/F,CAAC,CAACiG,MAAnB,CAA2BrD,KAAK,CAAC,EAAjC,CAAqCC,KAAK,CAAC,EAA3C,EAA+C,EAAlD,CAAqD,CAC1DH,YAAY,CAACqH,IAAb,GACD,CAFM,IAEA,CACLtH,OAAO,CAAG,MAAV,CACD,CACDC,YAAY,CAACqH,IAAb,CAAoB/J,CAAC,CAACgK,SAAF,CAAYtH,YAAY,CAACqH,IAAzB,CAA+B,CAA/B,CAAkC,EAAlC,CAApB,CACD,CATD,IASO,IAAGtH,OAAO,EAAI,OAAd,CAAsB,CAE3B,GAAGzC,CAAC,CAACyJ,IAAF,CAAOzJ,CAAC,CAAC+F,MAAT,CAAiB/F,CAAC,CAACiG,MAAnB,CAA2BrD,KAAK,CAAC,EAAjC,CAAqCC,KAAK,CAAC,EAA3C,EAA+C,EAAlD,CAAqD,CACnDH,YAAY,CAACuH,KAAb,GACD,CAFD,IAEO,IAAGjK,CAAC,CAACyJ,IAAF,CAAOzJ,CAAC,CAAC+F,MAAT,CAAiB/F,CAAC,CAACiG,MAAnB,CAA2BrD,KAAK,CAAC,EAAjC,CAAqCC,KAAK,CAAC,EAA3C,EAA+C,EAAlD,CAAqD,CAC1DH,YAAY,CAACuH,KAAb,GACD,CAFM,IAEA,CACLxH,OAAO,CAAG,MAAV,CACD,CACDC,YAAY,CAACuH,KAAb,CAAqBjK,CAAC,CAACgK,SAAF,CAAYtH,YAAY,CAACuH,KAAzB,CAAgC,CAAhC,CAAmC,EAAnC,CAArB,CACD,CAVM,IAUA,IAAGxH,OAAO,EAAI,WAAd,CAA0B,CAE/B,GAAGzC,CAAC,CAACyJ,IAAF,CAAOzJ,CAAC,CAAC+F,MAAT,CAAiB/F,CAAC,CAACiG,MAAnB,CAA2BrD,KAAK,CAAC,EAAjC,CAAqCC,KAAK,CAAC,EAA3C,EAA+C,EAAlD,CAAqD,CACnDH,YAAY,CAACwH,SAAb,GACD,CAFD,IAEO,IAAGlK,CAAC,CAACyJ,IAAF,CAAOzJ,CAAC,CAAC+F,MAAT,CAAiB/F,CAAC,CAACiG,MAAnB,CAA2BrD,KAAK,CAAC,EAAjC,CAAqCC,KAAK,CAAC,EAA3C,EAA+C,EAAlD,CAAqD,CAC1DH,YAAY,CAACwH,SAAb,GACD,CAFM,IAEA,CACLzH,OAAO,CAAG,MAAV,CACD,CACDC,YAAY,CAACwH,SAAb,CAAyBlK,CAAC,CAACgK,SAAF,CAAYtH,YAAY,CAACwH,SAAzB,CAAoC,CAApC,CAAuC,EAAvC,CAAzB,CACD,CAVM,IAUA,IAAGzH,OAAO,CAAG,QAAb,CAAsB,CAC3BA,OAAO,CAAG,MAAV,CACD,CACF,CAjCD,CAoCAzC,CAAC,CAACuG,iBAAF,CAAsB,UAAM,CAC1BvG,CAAC,CAACuD,IAAF,GACA,GAAGd,OAAO,EAAI,MAAd,CAAqB,CACnBzC,CAAC,CAAC8F,SAAF,CAAYlD,KAAZ,CAAmBC,KAAnB,EACA7C,CAAC,CAACwE,QAAF,GACA,GAAG/B,OAAO,EAAE,QAAZ,CAAqB,CACnBzC,CAAC,CAACmK,MAAF,CAASnK,CAAC,CAACoK,UAAX,EACApK,CAAC,CAACuE,IAAF,CAAO,CAAP,EACAvE,CAAC,CAACkF,IAAF,CAAO,CAAP,CAAU,CAAV,CAAa,EAAb,CAAiB,CAAjB,EACAlF,CAAC,CAACkF,IAAF,CAAO,CAAP,CAAU,CAAV,CAAa,CAAb,CAAgB,EAAhB,EACAlF,CAAC,CAACuE,IAAF,CAAO,GAAP,EACAvE,CAAC,CAACkF,IAAF,CAAO,CAAP,CAAU,CAAV,CAAa,EAAb,CAAiB,CAAjB,EACAlF,CAAC,CAACkF,IAAF,CAAO,CAAP,CAAU,CAAV,CAAa,CAAb,CAAgB,EAAhB,EAED,CATD,IASO,CACLlF,CAAC,CAACuE,IAAF,CAAO,CAAP,EACAvE,CAAC,CAACkF,IAAF,CAAO,CAAC,EAAR,CAAYzC,OAAO,EAAE,MAAT,CAAgB,CAAC,EAAjB,CAAoB,EAAhC,CAAoC,EAApC,CAAwC,CAAxC,EACAzC,CAAC,CAACkF,IAAF,CAAO,EAAP,CAAWzC,OAAO,EAAE,MAAT,CAAgB,CAAC,EAAjB,CAAoB,EAA/B,CAAmC,EAAnC,CAAuC,CAAvC,EACAzC,CAAC,CAACkF,IAAF,CAAO,EAAP,CAAWzC,OAAO,EAAE,MAAT,CAAgB,CAAC,EAAjB,CAAoB,EAA/B,CAAmC,CAAnC,CAAsC,EAAtC,EACAzC,CAAC,CAACuE,IAAF,CAAO,GAAP,EACAvE,CAAC,CAACkF,IAAF,CAAO,CAAC,EAAR,CAAYzC,OAAO,EAAE,MAAT,CAAgB,CAAC,EAAjB,CAAoB,EAAhC,CAAoC,EAApC,CAAwC,CAAxC,EACAzC,CAAC,CAACkF,IAAF,CAAO,EAAP,CAAWzC,OAAO,EAAE,MAAT,CAAgB,CAAC,EAAjB,CAAoB,EAA/B,CAAmC,EAAnC,CAAuC,CAAvC,EACAzC,CAAC,CAACkF,IAAF,CAAO,EAAP,CAAWzC,OAAO,EAAE,MAAT,CAAgB,CAAC,EAAjB,CAAoB,EAA/B,CAAmC,CAAnC,CAAsC,EAAtC,EACD,CACF,CACDzC,CAAC,CAACsG,GAAF,GACD,CA1BD,CA4BAtG,CAAC,CAACqK,YAAF,CAAiB,UAAM,CAErB,GAAGzI,aAAa,CAACC,oBAAD,CAAb,EAAuC,MAA1C,CAAiD,CAC/C7B,CAAC,CAACiI,0BAAF,GACD,CAFD,IAEO,CACLjI,CAAC,CAACqI,6BAAF,GACD,CACF,CAPD,CASArI,CAAC,CAACoJ,eAAF,CAAoB,UAAM,CAExBtH,kBAAkB,CAAClB,OAAnB,CAA2B2C,IAA3B,CAAgCyF,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAe3G,QAAQ,CAAC6D,MAAxB,CAAX,CAAhC,EACAvE,oBAAoB,CAAG,CAAvB,CACAU,QAAQ,CAAC6D,MAAT,CAAkB,IAAlB,CACA7D,QAAQ,CAACsD,IAAT,CAAgB,KAAhB,CACD,CAND,CAQA7F,CAAC,CAACsK,UAAF,CAAe,UAAM,CACnB,GAAItK,CAAC,CAACuK,GAAF,EAAS,GAAT,EAAgB,CAACxH,UAArB,CAAiC,CAC/BI,UAAU,CAAG,IAAb,CACAC,QAAQ,CAAG,IAAX,CACAL,UAAU,CAAG,IAAb,CACAE,OAAO,CAAGH,QAAV,CACA9C,CAAC,CAACwK,MAAF,GACD,CAEF,CATD,CAWAxK,CAAC,CAACyK,aAAF,CAAkB,UAAM,CACtBzK,CAAC,CAAC0K,YAAF,CAAe1K,CAAC,CAAC6D,WAAjB,CAA8B7D,CAAC,CAAC8D,YAAhC,EACA9D,CAAC,CAAC6E,UAAF,GACD,CAHD,CAKA7E,CAAC,CAAC2I,YAAF,CAAiB,UAAM,CACrB,GAAG,CAAC5F,UAAJ,CAAe,CACbA,UAAU,CAAG,IAAb,CACAE,OAAO,CAAGjD,CAAC,CAAC2K,MAAF,EAAV,CACA3K,CAAC,CAACwK,MAAF,GACD,CACF,CAND,CAQAxK,CAAC,CAACwG,WAAF,CAAgB,UAAM,CACpBxG,CAAC,CAACuD,IAAF,GACA,GAAIqH,CAAAA,OAAO,CAAG5K,CAAC,CAACgH,GAAF,CAAM,CAAN,CAAS,CAAT,CAAY,CAAZ,CAAe7E,SAAf,CAA0BnC,CAAC,CAACiE,KAAF,CAAQ9B,SAAlC,CAAd,CACA,GAAI0I,CAAAA,OAAO,CAAG7K,CAAC,CAACgE,MAAF,CAAS,IAAvB,CACAd,iBAAiB,CAAIlD,CAAC,CAAC+F,MAAF,CAAW6E,OAAO,CAAG,GAArB,EAA4B5K,CAAC,CAAC+F,MAAF,CAAW6E,OAAO,CAAG,GAAjD,EAAwD5K,CAAC,CAACiG,MAAF,CAAW4E,OAAO,CAAC,EAA3E,EAAiF7K,CAAC,CAACiG,MAAF,CAAW4E,OAAO,CAAC,EAAzH,CAEA7K,CAAC,CAAC8F,SAAF,CAAY8E,OAAZ,CAAqBC,OAArB,EAEA,GAAG3H,iBAAiB,EAAI,CAACH,UAAzB,CAAoC,CAClC/C,CAAC,CAACuE,IAAF,CAAO,GAAP,CAAY,GAAZ,EACD,CAFD,IAEO,CACLvE,CAAC,CAACuE,IAAF,CAAOvE,CAAC,CAACgH,GAAF,CAAMhH,CAAC,CAAC2K,MAAF,EAAN,CAAkB1H,OAAlB,CAA2BA,OAAO,CAACD,WAAnC,CAAgD,GAAhD,CAAqD,GAArD,CAA0D,IAA1D,CAAP,CAAwE,GAAxE,EACD,CACDhD,CAAC,CAACkF,IAAF,CAAO,CAAP,CAAU,CAAV,CAAa,GAAb,CAAkB,EAAlB,CAAsB,CAAtB,EAGAlF,CAAC,CAACuE,IAAF,CAAO,CAAP,CAAU,GAAV,EACAvE,CAAC,CAACuF,SAAF,CAAYvF,CAAC,CAACmE,MAAd,CAAsBnE,CAAC,CAACmE,MAAxB,EACAnE,CAAC,CAACmG,IAAF,CAAOpD,UAAU,CAAC,WAAD,CAAa,cAA9B,CAA8C,CAA9C,CAAiD,CAAC,CAAlD,EAEA/C,CAAC,CAACoE,QAAF,CAAWpE,CAAC,CAAC8K,MAAb,EAEA;AACA;AACA;AAGA9K,CAAC,CAACsG,GAAF,GAEA,GAAGvD,UAAH,CAAc,CACZ,GAAG/C,CAAC,CAAC2K,MAAF,GAAa1H,OAAO,CAACD,WAAxB,CAAoC,CAClCD,UAAU,CAAG,KAAb,CACD,CACF,CACD;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACD,CAvDD,CAyDA/C,CAAC,CAACwK,MAAF,CAAW,UAAM,CACf,GAAIO,CAAAA,WAAW,CAAG,EAAlB,CADe,0CAEFhK,KAFE,aAEf,kDAAmB,IAAX2E,CAAAA,CAAW,cAEjB,GAAIsF,CAAAA,eAAe,CAAG,CACpBC,EAAE,CAAEvF,CAAC,CAACwF,OADc,CAEpBC,GAAG,CAAEzF,CAAC,CAAC0F,eAFa,CAGpBtK,IAAI,CAAEA,IAHc,CAIpBd,CAAC,CAAE0F,CAAC,CAACuE,KAJe,CAKpBoB,CAAC,CAAE3F,CAAC,CAACwE,SALe,CAMpBoB,CAAC,CAAE5F,CAAC,CAACqE,IANe,CAAtB,CAWA,GAAIwB,CAAAA,cAAc,CAAG,EAArB,CAbiB,0CAeH7F,CAAC,CAAC9E,OAfC,aAejB,kDAAyB,IAAhB4K,CAAAA,CAAgB,cACvB,GAAGD,cAAc,CAACC,CAAC,CAACC,YAAH,CAAd,EAAkCC,SAArC,CAA+C,CAC7CH,cAAc,CAACC,CAAC,CAACC,YAAH,CAAd,CAAiC,CAAjC,CACD,CAFD,IAEO,CACLF,cAAc,CAACC,CAAC,CAACC,YAAH,CAAd,GACD,CAED,GAAGD,CAAC,CAAC7E,QAAF,CAAWgF,OAAX,CAAmB,CAAnB,GAAyB,IAA5B,CAAkCX,eAAe,CAACQ,CAAC,CAACC,YAAF,CAAe,UAAf,CAA0BF,cAAc,CAACC,CAAC,CAACC,YAAH,CAAzC,CAAf,CAA4ED,CAAC,CAAC7E,QAAF,CAAWgF,OAAX,CAAmB,CAAnB,CAA5E,CAClC,GAAGH,CAAC,CAAC7E,QAAF,CAAWiF,MAAX,CAAkB,CAAlB,GAAwB,IAA3B,CAAiCZ,eAAe,CAACQ,CAAC,CAACC,YAAF,CAAe,SAAf,CAAyBF,cAAc,CAACC,CAAC,CAACC,YAAH,CAAxC,CAAf,CAA2ED,CAAC,CAAC7E,QAAF,CAAWiF,MAAX,CAAkB,CAAlB,CAA3E,CACjC,GAAGJ,CAAC,CAAC7E,QAAF,CAAWkF,OAAX,CAAmB,CAAnB,GAAyB,IAA5B,CAAkCb,eAAe,CAACQ,CAAC,CAACC,YAAF,CAAe,UAAf,CAA0BF,cAAc,CAACC,CAAC,CAACC,YAAH,CAAzC,CAAf,CAA4ED,CAAC,CAAC7E,QAAF,CAAWkF,OAAX,CAAmB,CAAnB,CAA5E,CAClC,GAAGL,CAAC,CAAC7E,QAAF,CAAWmF,OAAX,CAAmB,CAAnB,GAAyB,IAA5B,CAAkCd,eAAe,CAACQ,CAAC,CAACC,YAAF,CAAe,UAAf,CAA0BF,cAAc,CAACC,CAAC,CAACC,YAAH,CAAzC,CAAf,CAA4ED,CAAC,CAAC7E,QAAF,CAAWmF,OAAX,CAAmB,CAAnB,CAA5E,CAClC,GAAGN,CAAC,CAAC7E,QAAF,CAAWoF,QAAX,CAAoB,CAApB,GAA0B,IAA7B,CAAmCf,eAAe,CAACQ,CAAC,CAACC,YAAF,CAAe,YAAf,CAA4BF,cAAc,CAACC,CAAC,CAACC,YAAH,CAA3C,CAAf,CAA8ED,CAAC,CAAC7E,QAAF,CAAWoF,QAAX,CAAoB,CAApB,CAA9E,CAEpC,CA5BgB,uDA6BjBhB,WAAW,CAACrF,CAAC,CAAC0F,eAAF,CAAkB,GAAlB,CAAsB1F,CAAC,CAACwF,OAAzB,CAAX,CAA+CF,eAA/C,CACF,CAhCe,uDAmChBhL,CAAC,CAACgM,qBAAF,CAAwBjB,WAAxB,EAEA,CArCD,CAwCA/K,CAAC,CAACgM,qBAAF,CAA0B,SAACjB,WAAD,CAAiB,2CAEnBA,WAFmB,aAEzC,kDAAkC,IAA1BkB,CAAAA,UAA0B,cAGjC,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAQA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5CyC,uDA8C1C,CA9CD,CAgDAjM,CAAC,CAAC6E,UAAF,CAAe,UAAM,2CACLnE,OADK,aACnB,kDAAuB,IAAdkF,CAAAA,CAAc,cACrBA,CAAC,CAACsG,OAAF,GACD,CAHkB,kGAKLnL,KALK,cAKnB,qDAAqB,IAAZ2E,CAAAA,CAAY,eACnBA,CAAC,CAACwG,OAAF,GACD,CAPkB,yDASpB,CATD,CAWAlM,CAAC,CAACmM,eAAF,CAAoB,SAACC,WAAD,CAAcX,YAAd,CAA4BY,MAA5B,CAAoCC,KAApC,CAA2CT,OAA3C,CAAoDC,OAApD,CAA6DC,QAA7D,CAA0E,CAE5FnL,OAAO,CAACwL,WAAD,CAAP,CAAuB,GAAIpM,CAAAA,CAAC,CAACuM,MAAN,CAAaH,WAAb,CAA0BX,YAA1B,CAAwCY,MAAxC,CAAgDC,KAAhD,CAAuDT,OAAvD,CAAgEC,OAAhE,CAAyEC,QAAzE,CAAvB,CACArL,OAAO,CAAC6C,IAAR,CAAa,GAAIvD,CAAAA,CAAC,CAACwM,MAAN,CAAaJ,WAAb,CAA0BzL,SAAS,EAAnC,CAAb,EACD,CAJD,CAMAX,CAAC,CAAC0E,YAAF,CAAiB,UAAM,CAErB1E,CAAC,CAACmM,eAAF,CAAkB,aAAlB,CAAiC,KAAjC,CACE,CAAC,UAAD,CAAa,UAAb,CAAyB,KAAzB,CADF,CAEE,CAAC,GAAD,CAFF,CAGE,CAAC,SAAD,CAAY,QAAZ,CAAsB,mBAAtB,CAA2C,SAA3C,CAAsD,QAAtD,CAAgE,QAAhE,CAA0E,QAA1E,CAHF,CAIE,CAAC,OAAD,CAAU,UAAV,CAAsB,KAAtB,CAJF,CAKE,IALF,EAOAnM,CAAC,CAACmM,eAAF,CAAkB,SAAlB,CAA6B,KAA7B,CACE,CAAC,UAAD,CAAa,UAAb,CAAyB,KAAzB,CADF,CAEE,IAFF,CAGE,CAAC,SAAD,CAAY,SAAZ,CAAuB,QAAvB,CAAiC,QAAjC,CAA2C,QAA3C,CAAqD,SAArD,CAHF,CAIE,CAAC,OAAD,CAAU,UAAV,CAAsB,KAAtB,CAJF,CAKE,IALF,EAOAnM,CAAC,CAACmM,eAAF,CAAkB,MAAlB,CAA0B,KAA1B,CACE,CAAC,UAAD,CAAa,UAAb,CAAyB,KAAzB,CADF,CAEE,CAAC,GAAD,CAFF,CAGE,CAAC,SAAD,CAAY,QAAZ,CAAsB,mBAAtB,CAA2C,SAA3C,CAAsD,QAAtD,CAAgE,QAAhE,CAA0E,QAA1E,CAHF,CAIE,CAAC,OAAD,CAAU,UAAV,CAAsB,KAAtB,CAJF,CAKE,IALF,EAOAnM,CAAC,CAACmM,eAAF,CAAkB,aAAlB,CAAiC,KAAjC,CACE,IADF,CAEE,CAAC,GAAD,CAFF,CAGE,IAHF,CAIE,IAJF,CAKE,IALF,EAOAnM,CAAC,CAACmM,eAAF,CAAkB,cAAlB,CAAkC,KAAlC,CACE,CAAC,UAAD,CAAa,UAAb,CAAyB,KAAzB,CAAgC,MAAhC,CADF,CAEE,CAAC,KAAD,CAFF,CAGE,CAAC,SAAD,CAAY,QAAZ,CAAsB,mBAAtB,CAA2C,SAA3C,CAAsD,QAAtD,CAAgE,QAAhE,CAA0E,QAA1E,CAAoF,SAApF,CAHF,CAIE,CAAC,OAAD,CAAU,UAAV,CAAsB,KAAtB,CAJF,CAKE,CAAC,MAAD,CAAS,aAAT,CALF,EAOAnM,CAAC,CAACmM,eAAF,CAAkB,WAAlB,CAA+B,KAA/B,CACE,CAAC,UAAD,CAAa,UAAb,CAAyB,KAAzB,CAAgC,MAAhC,CADF,CAEE,CAAC,KAAD,CAFF,CAGE,CAAC,SAAD,CAAY,QAAZ,CAAsB,mBAAtB,CAA2C,SAA3C,CAAsD,QAAtD,CAAgE,QAAhE,CAA0E,QAA1E,CAAoF,SAApF,CAHF,CAIE,CAAC,OAAD,CAAU,UAAV,CAAsB,KAAtB,CAJF,CAKE,CAAC,MAAD,CAAS,aAAT,CALF,EAQAnM,CAAC,CAACmM,eAAF,CAAkB,cAAlB,CAAkC,KAAlC,CACE,CAAC,UAAD,CAAa,UAAb,CAAyB,KAAzB,CAAgC,MAAhC,CADF,CAEE,CAAC,GAAD,CAFF,CAGE,CAAC,SAAD,CAAY,QAAZ,CAAsB,mBAAtB,CAA2C,SAA3C,CAAsD,QAAtD,CAAgE,QAAhE,CAA0E,QAA1E,CAAoF,SAApF,CAHF,CAIE,CAAC,OAAD,CAAU,UAAV,CAAsB,KAAtB,CAJF,CAKE,CAAC,MAAD,CAAS,aAAT,CALF,EAOAnM,CAAC,CAACmM,eAAF,CAAkB,gBAAlB,CAAoC,KAApC,CACE,CAAC,UAAD,CAAa,UAAb,CAAyB,KAAzB,CADF,CAEE,IAFF,CAGE,CAAC,SAAD,CAAY,SAAZ,CAAuB,QAAvB,CAAiC,QAAjC,CAA2C,QAA3C,CAHF,CAIE,CAAC,OAAD,CAAU,UAAV,CAAsB,KAAtB,CAJF,CAKE,IALF,EAQAnM,CAAC,CAACmM,eAAF,CAAkB,MAAlB,CAA0B,KAA1B,CACE,IADF,CAEE,CAAC,GAAD,CAFF,CAGE,IAHF,CAIE,CAAC,OAAD,CAAU,UAAV,CAAsB,KAAtB,CAJF,CAKE,IALF,EAQAnM,CAAC,CAACmM,eAAF,CAAkB,WAAlB,CAA+B,KAA/B,CACE,IADF,CAEE,CAAC,GAAD,CAFF,CAGE,IAHF,CAIE,CAAC,OAAD,CAAU,UAAV,CAAsB,KAAtB,CAJF,CAKE,IALF,EAOAnM,CAAC,CAACmM,eAAF,CAAkB,QAAlB,CAA4B,KAA5B,CACE,IADF,CAEE,CAAC,KAAD,CAFF,CAGE,IAHF,CAIE,IAJF,CAKE,IALF,EAOEnM,CAAC,CAACmM,eAAF,CAAkB,SAAlB,CAA6B,KAA7B,CACA,IADA,CAEA,CAAC,GAAD,CAFA,CAGA,IAHA,CAIA,IAJA,CAKA,IALA,EAOAnM,CAAC,CAACmM,eAAF,CAAkB,eAAlB,CAAmC,KAAnC,CACA,IADA,CAEA,CAAC,GAAD,CAFA,CAGA,IAHA,CAIA,IAJA,CAKA,IALA,EASH,CAlGD,CAqGAnM,CAAC,CAACyE,UAAF,CAAe,SAACgI,EAAD,CAAQ,CACrBA,EAAE,CAACC,UAAH,CAAgB,UAAM,CACpB,KAAI,CAAC7G,IAAL,CAAY,KAAZ,CACA,KAAI,CAACG,OAAL,CAAe,CAAf,CACA,KAAI,CAACE,OAAL,CAAe,CAAf,CACA,KAAI,CAACE,MAAL,CAAc,IAAd,CACD,CALD,CAMAqG,EAAE,CAAC/D,SAAH,CAAe,SAACiE,OAAD,CAAUC,OAAV,CAAsB,CACnC,KAAI,CAAC5G,OAAL,CAAehG,CAAC,CAAC+F,MAAF,CAAW4G,OAA1B,CACA,KAAI,CAACzG,OAAL,CAAelG,CAAC,CAACiG,MAAF,CAAW2G,OAA1B,CACD,CAHD,CAID,CAXD,CAiBA5M,CAAC,CAACuM,MAAF,CAAW,SAACM,EAAD,CAAQ,CACjBA,EAAE,CAACC,WAAH,CAAiB,SAACzG,UAAD,CAAYoF,YAAZ,CAAyBE,OAAzB,CAAkCoB,YAAlC,CAAgDlB,OAAhD,CAAyDC,OAAzD,CAAkEC,QAAlE,CAA+E,CAC9F,KAAI,CAAC5D,CAAL,CAAS,CAAT,CACA,KAAI,CAACC,CAAL,CAAS,CAAT,CAEA,KAAI,CAAC4E,aAAL,CAAqB,EAArB,CACA,KAAI,CAACpD,oBAAL,CAA4B,CAA5B,CACA,KAAI,CAACqD,mBAAL,CAA2BhN,eAAe,CAACgE,KAAhB,CAAwB,GAAnD,CACA,KAAI,CAACoC,UAAL,CAAkBA,UAAlB,CACA,KAAI,CAACoF,YAAL,CAAoBA,YAApB,CAEA,KAAI,CAAC9E,QAAL,CAAgB,CACdgF,OAAO,CAAE,CAACA,OAAD,CAAU,EAAV,CADK,CAEdC,MAAM,CAAE,CAACmB,YAAD,CAAe,EAAf,CAFM,CAGdlB,OAAO,CAAE,CAACA,OAAD,CAAU,EAAV,CAHK,CAIdC,OAAO,CAAE,CAACA,OAAD,CAAU,EAAV,CAJK,CAKdC,QAAQ,CAAE,CAACA,QAAD,CAAW,EAAX,CALI,CAAhB,CAOD,CAjBD,CAkBD,CAnBD,CAsBA/L,CAAC,CAAC4E,IAAF,CAAS,SAACsI,EAAD,CAAQ,CACfA,EAAE,CAACJ,WAAH,CAAiB,SAAC5B,OAAD,CAAUE,eAAV,CAA8B,CAC3C,KAAI,CAAChD,CAAL,CAAS,CAAT,CACA,KAAI,CAACD,CAAL,CAAS,CAAT,CACA,KAAI,CAACgF,CAAL,CAASlN,eAAe,CAACgE,KAAhB,CAAwB,IAAjC,CACA,KAAI,CAACmJ,CAAL,CAASnN,eAAe,CAAC+D,MAAhB,CAAyB,IAAlC,CACA,KAAI,CAACqJ,SAAL,CAAiB,KAAjB,CAGA,KAAI,CAACC,KAAL,CAAa,MAAb,CACA,KAAI,CAACC,OAAL,CAAe,CAAf,CACA,KAAI,CAACrC,OAAL,CAAeA,OAAf,CACA,KAAI,CAACE,eAAL,CAAuBA,eAAvB,CAEA,KAAI,CAACoC,aAAL,CAAqB,EAArB,CACA,KAAI,CAACzD,IAAL,CAAY,CAAZ,CACA,KAAI,CAACE,KAAL,CAAa,CAAb,CACA,KAAI,CAACC,SAAL,CAAiB,CAAjB,CACA,KAAI,CAACzI,QAAL,CAAgB,EAAhB,CACA,KAAI,CAACb,OAAL,CAAe,EAAf,CAEA,KAAI,CAAC+I,cAAL,CAAsB,IAAtB,CACA,KAAI,CAACD,sBAAL,CAA8B,KAA9B,CACA,KAAI,CAACJ,eAAL,CAAuB,KAAvB,CACA,KAAI,CAACC,gBAAL,CAAwB,KAAxB,CACA,KAAI,CAACC,oBAAL,CAA4B,KAA5B,CAGH,CA3BD,CA6BA0D,EAAE,CAAChB,OAAH,CAAa,UAAM,CACf,KAAI,CAAC/D,CAAL,CAASnI,CAAC,CAACgH,GAAF,CAAM,KAAI,CAACkE,OAAL,CAAe,CAArB,CAAwB,CAAxB,CAA2BnK,KAAK,CAACsG,MAAjC,CAAyClF,SAAzC,CAAoDnC,CAAC,CAACiE,KAAF,CAAU9B,SAA9D,CAAT,CACA,KAAI,CAACiG,CAAL,CAASpI,CAAC,CAACgE,MAAF,CAAW,CAApB,CACH,CAHD,CAKAkJ,EAAE,CAACvH,GAAH,CAAS,UAAM,CACX,KAAI,CAAC8H,oBAAL,GACA,KAAI,CAACC,kBAAL,GACA,KAAI,CAACC,OAAL,GACH,CAJD,CAMAT,EAAE,CAACO,oBAAH,CAA0B,UAAM,4CACd,KAAI,CAAC7M,OADS,cAC5B,qDAA4B,IAAnB4K,CAAAA,CAAmB,eACxBA,CAAC,CAACwB,aAAF,CAAkB,EAAlB,CACA,GAAGxB,CAAC,CAACnF,UAAF,EAAgB,SAAhB,EAA6BmF,CAAC,CAACnF,UAAF,EAAgB,eAAhD,CAAgE,CAC5DmF,CAAC,CAACwB,aAAF,CAAkBxB,CAAC,CAAC7E,QAAF,CAAWiF,MAAX,CAAkB,CAAlB,CAAlB,CACH,CAFD,IAEO,IAAGJ,CAAC,CAACnF,UAAF,EAAgB,aAAnB,CAAiC,CACpC,GAAGmF,CAAC,CAAC7E,QAAF,CAAWgF,OAAX,CAAmB,CAAnB,GAAyB,UAA5B,CAAuC,CACnCH,CAAC,CAACwB,aAAF,CAAkB,iBAAmBxB,CAAC,CAAC7E,QAAF,CAAWiF,MAAX,CAAkB,CAAlB,CAAnB,CAA0C,eAA5D,CACH,CAFD,IAEO,IAAGJ,CAAC,CAAC7E,QAAF,CAAWgF,OAAX,CAAmB,CAAnB,GAAyB,UAA5B,CAAuC,CAC1CH,CAAC,CAACwB,aAAF,CAAkB,QAAUxB,CAAC,CAAC7E,QAAF,CAAWiF,MAAX,CAAkB,CAAlB,CAAV,CAAiC,oBAAnD,CACH,CAFM,IAEA,CACHJ,CAAC,CAACwB,aAAF,CAAkB,QAAUxB,CAAC,CAAC7E,QAAF,CAAWiF,MAAX,CAAkB,CAAlB,CAAV,CAAiC,iBAAnD,CACH,CAEDJ,CAAC,CAACwB,aAAF,EAAmBxB,CAAC,CAAC7E,QAAF,CAAWmF,OAAX,CAAmB,CAAnB,GAAuB,KAAvB,CAA6B,EAA7B,CAAgCN,CAAC,CAAC7E,QAAF,CAAWmF,OAAX,CAAmB,CAAnB,EAAwB,GAA3E,CAA+E;AAC/E,GAAGN,CAAC,CAAC7E,QAAF,CAAWgF,OAAX,CAAmB,CAAnB,GAAyB,KAA5B,CAAkC,CAC9BH,CAAC,CAACwB,aAAF,EAAmBxB,CAAC,CAAC7E,QAAF,CAAWkF,OAAX,CAAmB,CAAnB,CAAnB,CACH,CAFD,IAEO,CACHL,CAAC,CAACwB,aAAF,EAAmB5L,qBAAqB,CAACD,YAAY,CAAC2I,OAAb,CAAqB0B,CAAC,CAAC7E,QAAF,CAAWkF,OAAX,CAAmB,CAAnB,CAArB,CAAD,CAAxC,CACH,CACJ,CAfM,IAeA,IAAGL,CAAC,CAACnF,UAAF,EAAe,SAAlB,CAA4B,CAC/B,GAAGmF,CAAC,CAAC7E,QAAF,CAAWgF,OAAX,CAAmB,CAAnB,GAAyB,UAA5B,CAAuC,CACnCH,CAAC,CAACwB,aAAF,CAAkB,qBAAlB,CACH,CAFD,IAEO,IAAGxB,CAAC,CAAC7E,QAAF,CAAWgF,OAAX,CAAmB,CAAnB,GAAyB,UAA5B,CAAuC,CAC1CH,CAAC,CAACwB,aAAF,CAAkB,mBAAlB,CACH,CAFM,IAEA,CACHxB,CAAC,CAACwB,aAAF,CAAkB,cAAlB,CACH,CACDxB,CAAC,CAACwB,aAAF,EAAmBxB,CAAC,CAAC7E,QAAF,CAAWmF,OAAX,CAAmB,CAAnB,GAAuB,KAAvB,CAA6B,EAA7B,CAAgCN,CAAC,CAAC7E,QAAF,CAAWmF,OAAX,CAAmB,CAAnB,EAAwB,GAA3E,CAA+E;AAC/E,GAAGN,CAAC,CAAC7E,QAAF,CAAWgF,OAAX,CAAmB,CAAnB,GAAyB,KAA5B,CAAkC,CAC9BH,CAAC,CAACwB,aAAF,EAAmBxB,CAAC,CAAC7E,QAAF,CAAWkF,OAAX,CAAmB,CAAnB,CAAnB,CACH,CAFD,IAEO,CACHL,CAAC,CAACwB,aAAF,EAAmB5L,qBAAqB,CAACD,YAAY,CAAC2I,OAAb,CAAqB0B,CAAC,CAAC7E,QAAF,CAAWkF,OAAX,CAAmB,CAAnB,CAArB,CAAD,CAAxC,CACH,CACJ,CAdM,IAcA,IAAGL,CAAC,CAACnF,UAAF,EAAe,MAAlB,CAAyB,CAC5B,GAAGmF,CAAC,CAAC7E,QAAF,CAAWgF,OAAX,CAAmB,CAAnB,GAAyB,UAA5B,CAAuC,CACnCH,CAAC,CAACwB,aAAF,CAAkB,WAAaxB,CAAC,CAAC7E,QAAF,CAAWiF,MAAX,CAAkB,CAAlB,CAAb,CAAoC,sBAAtD,CACH,CAFD,IAEO,IAAGJ,CAAC,CAAC7E,QAAF,CAAWgF,OAAX,CAAmB,CAAnB,GAAyB,UAA5B,CAAuC,CAC1CH,CAAC,CAACwB,aAAF,CAAkB,WAAaxB,CAAC,CAAC7E,QAAF,CAAWiF,MAAX,CAAkB,CAAlB,CAAb,CAAoC,sBAAtD,CACH,CAFM,IAEA,CACHJ,CAAC,CAACwB,aAAF,CAAkB,WAAaxB,CAAC,CAAC7E,QAAF,CAAWiF,MAAX,CAAkB,CAAlB,CAAb,CAAoC,iBAAtD,CACH,CACDJ,CAAC,CAACwB,aAAF,EAAmBxB,CAAC,CAAC7E,QAAF,CAAWmF,OAAX,CAAmB,CAAnB,GAAuB,KAAvB,CAA6B,EAA7B,CAAgCN,CAAC,CAAC7E,QAAF,CAAWmF,OAAX,CAAmB,CAAnB,EAAwB,GAA3E,CAA+E;AAC/E,GAAGN,CAAC,CAAC7E,QAAF,CAAWgF,OAAX,CAAmB,CAAnB,GAAyB,KAA5B,CAAkC,CAC9BH,CAAC,CAACwB,aAAF,EAAmBxB,CAAC,CAAC7E,QAAF,CAAWkF,OAAX,CAAmB,CAAnB,CAAnB,CACH,CAFD,IAEO,CACHL,CAAC,CAACwB,aAAF,EAAmB5L,qBAAqB,CAACD,YAAY,CAAC2I,OAAb,CAAqB0B,CAAC,CAAC7E,QAAF,CAAWkF,OAAX,CAAmB,CAAnB,CAArB,CAAD,CAAxC,CACH,CACJ,CAdM,IAcA,CACHL,CAAC,CAACwB,aAAF,CAAkBxB,CAAC,CAACnF,UAApB,CACH,CAID,GAAIuH,CAAAA,0BAA0B,CAAG,EAAjC,CACA,GAAIC,CAAAA,cAAc,CAAIrC,CAAC,CAACwB,aAAF,CAAgB3F,MAAhB,CAAuBuG,0BAA7C,CACApC,CAAC,CAAC5B,oBAAF,CAAyB5H,iBAAiB,CAAG6L,cAApB,CAAqC,EAA9D,CAEH,CA1D2B,yDA4D/B,CA5DD,CA8DAX,EAAE,CAACS,OAAH,CAAa,UAAM,CACjB3N,CAAC,CAACuD,IAAF,GACAvD,CAAC,CAACuE,IAAF,CAAO,CAAP,EACAvE,CAAC,CAACuF,SAAF,CAAYvF,CAAC,CAACmE,MAAd,CAAsBnE,CAAC,CAACmE,MAAxB,EACE,GAAG,KAAI,CAACvD,OAAL,CAAayG,MAAb,CAAsB,CAAzB,CAA2B,CACvB,KAAI,CAACgG,SAAL,CAAiB,IAAjB,CACH,CAFD,IAEO,CACH,KAAI,CAACA,SAAL,CAAiB,KAAjB,CACH,CACD,GAAIS,CAAAA,IAAJ,CACA,GAAIC,CAAAA,IAAJ,CAEA,GAAI9M,UAAU,CAAC,KAAI,CAACsM,OAAN,CAAV,EAA4B,OAAhC,CAAyC,CACrCO,IAAI,CAAGrN,mBAAP,CACAsN,IAAI,CAAG9N,eAAP,CACH,CAHD,IAGO,IAAIgB,UAAU,CAAC,KAAI,CAACsM,OAAN,CAAV,EAA4B,QAAhC,CAA0C,CAC7CO,IAAI,CAAGtN,sBAAP,CACAuN,IAAI,CAAG,KAAI,CAACV,SAAL,CAAiBjN,uBAAjB,CAAyCF,kBAAhD,CACH,CAHM,IAGA,CACH4N,IAAI,CAAGrN,mBAAP,CACAsN,IAAI,CAAG5N,gBAAP,CACH,CAED,GAAG,CAAC,KAAI,CAACkN,SAAT,CAAmB,CACjBrN,CAAC,CAACyF,KAAF,CAAQqI,IAAR,CAAc,KAAI,CAAC3F,CAAL,CAAS,CAAvB,CAA0B,KAAI,CAACC,CAAL,CAAS,EAAnC,CAAuC,GAAvC,CAA4C,GAA5C,EACD,CACDpI,CAAC,CAACyF,KAAF,CAAQsI,IAAR,CAAc,KAAI,CAAC5F,CAAnB,CAAsB,KAAI,CAACC,CAA3B,CAA8B,KAAI,CAAC+E,CAAnC,CAAsC,KAAI,CAACC,CAA3C,EAEApN,CAAC,CAACuD,IAAF,GACAvD,CAAC,CAACsE,QAAF,CAAW,EAAX,EACAtE,CAAC,CAACuE,IAAF,CAAO,GAAP,EACAvE,CAAC,CAACgO,YAAF,CAAe,CAAf,EACAhO,CAAC,CAACiO,MAAF,CAAS,CAAT,EAEA,GAAIhN,UAAU,CAAC,KAAI,CAACsM,OAAN,CAAV,EAA4B,QAAhC,CAA0C,CACxCvN,CAAC,CAACmG,IAAF,CAAO,KAAI,CAAC8D,KAAZ,CAAmB,KAAI,CAAC9B,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,IAAjC,CAAuC,KAAI,CAAC/E,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,GAArD,EACApN,CAAC,CAACmG,IAAF,CAAO,KAAI,CAAC+D,SAAZ,CAAuB,KAAI,CAAC/B,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,GAArC,CAA0C,KAAI,CAAC/E,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,GAAxD,EACD,CAGDpN,CAAC,CAACmG,IAAF,CAAO,KAAI,CAAC4D,IAAZ,CAAkB,KAAI,CAAC5B,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,IAAhC,CAAsC,KAAI,CAAC/E,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,GAApD,EAEApN,CAAC,CAACsG,GAAF,GAGAtG,CAAC,CAACuD,IAAF,GACAvD,CAAC,CAACuE,IAAF,CAAO,CAAP,EACAvE,CAAC,CAACsE,QAAF,CAAWtC,iBAAX,EACA,GAAIkM,CAAAA,oBAAJ,CACA,GAAG,KAAI,CAACb,SAAR,CAAkB,CACda,oBAAoB,CAAG,KAAI,CAAC9F,CAAL,CAAS,KAAI,CAACgF,CAAL,CAAO,CAAhB,CAAoB,EAA3C,CACApN,CAAC,CAAC8F,SAAF,CAAY,KAAI,CAACqC,CAAjB,CAAoB,KAAI,CAACC,CAAL,CAAS,KAAI,CAACgF,CAAL,CAAO,CAAhB,CAAoB,EAAxC,EACH,CAHD,IAGO,CACHc,oBAAoB,CAAG,KAAI,CAAC9F,CAAL,CAAU,EAAjC,CACApI,CAAC,CAAC8F,SAAF,CAAY,KAAI,CAACqC,CAAjB,CAAoB,KAAI,CAACC,CAAL,CAAS,EAA7B,EACH,CAED,KAAI,CAACsB,sBAAL,CAA8B,KAA9B,CACA,KAAI,CAACC,cAAL,CAAsB,IAAtB,CA1De,2CA2DF,KAAI,CAAC/I,OA3DH,cA2Df,qDAA0B,IAAlB4K,CAAAA,CAAkB,eAEtB0C,oBAAoB,EAAI1C,CAAC,CAAC5B,oBAAF,CAAuB,CAA/C,CACA5J,CAAC,CAAC8F,SAAF,CAAY,CAAZ,CAAe0F,CAAC,CAAC5B,oBAAF,CAAuB,CAAtC,EAEA,GAAG5J,CAAC,CAACiG,MAAF,CAAWiI,oBAAoB,CAAG1C,CAAC,CAAC5B,oBAAF,CAAuB,CAAzD,EACD5J,CAAC,CAACiG,MAAF,CAAWiI,oBAAoB,CAAG1C,CAAC,CAAC5B,oBAAF,CAAuB,CADxD,EAED5J,CAAC,CAAC+F,MAAF,CAAW,KAAI,CAACoC,CAAL,CAASqD,CAAC,CAACyB,mBAAF,CAAsB,CAFzC,EAGDjN,CAAC,CAAC+F,MAAF,CAAW,KAAI,CAACoC,CAAL,CAASqD,CAAC,CAACyB,mBAAF,CAAsB,CAH5C,CAG8C,CAE1C,KAAI,CAACvD,sBAAL,CAA8B,IAA9B,CAEA,KAAI,CAACC,cAAL,CAAsB6B,CAAtB,CACA,KAAI,CAAC7B,cAAL,CAAoBxB,CAApB,CAAwB,KAAI,CAACA,CAAL,CAASqD,CAAC,CAACyB,mBAAF,CAAsB,CAAvD,CACA,KAAI,CAACtD,cAAL,CAAoBvB,CAApB,CAAwB8F,oBAAoB,CAAG1C,CAAC,CAAC5B,oBAAjD,CACA5J,CAAC,CAACuE,IAAF,CAAO,CAAP,CAAU,GAAV,EACH,CAXD,IAWO,CACHvE,CAAC,CAACuE,IAAF,CAAO,CAAP,CAAU,EAAV,EACH,CAEDvE,CAAC,CAACkF,IAAF,CAAO,CAAP,CAAU,CAAV,CAAasG,CAAC,CAACyB,mBAAf,CAAoCzB,CAAC,CAAC5B,oBAAtC,CAA4D,CAA5D,CAA+D,CAA/D,EACA5J,CAAC,CAACuE,IAAF,CAAO,GAAP,CAAY,GAAZ,EACAvE,CAAC,CAACmG,IAAF,CAAOqF,CAAC,CAACwB,aAAT,CAAwB,CAAxB,CAA2B,CAA3B,CAA8B/M,eAAe,CAACgE,KAAhB,CAAsB,CAApD,CAAuDhE,eAAe,CAAC+D,MAAhB,CAAuB,CAA9E,EACAkK,oBAAoB,EAAI1C,CAAC,CAAC5B,oBAAF,CAAuB,CAAvB,CAAyB,CAAjD,CACA5J,CAAC,CAAC8F,SAAF,CAAY,CAAZ,CAAe0F,CAAC,CAAC5B,oBAAF,CAAuB,CAAvB,CAAyB,CAAxC,EAEH,CArFc,yDAsFf5J,CAAC,CAACsG,GAAF,GAGAtG,CAAC,CAACuD,IAAF,GAEA,GAAGb,YAAY,EAAI,KAAnB,CAAwB,CACpB,GAAGD,OAAO,EAAI,MAAd,CAAqB,CACjBG,KAAK,CAAG,KAAI,CAACuF,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,IAAtB,CACAtK,KAAK,CAAG,KAAI,CAACuF,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,GAAtB,CACH,CAHD,IAGO,IAAG3K,OAAO,EAAI,OAAd,CAAsB,CACzBG,KAAK,CAAG,KAAI,CAACuF,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,IAAtB,CACAtK,KAAK,CAAG,KAAI,CAACuF,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,GAAtB,CACH,CAHM,IAGA,IAAG3K,OAAO,EAAI,WAAd,CAA0B,CAC7BG,KAAK,CAAG,KAAI,CAACuF,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,GAAtB,CACAtK,KAAK,CAAG,KAAI,CAACuF,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,GAAtB,CACH,CACJ,CAEDpN,CAAC,CAACsG,GAAF,GACH,CAzGD,CA4GA4G,EAAE,CAAC3E,UAAH,CAAgB,UAAM,CAClB,MAAQvI,CAAAA,CAAC,CAAC+F,MAAF,CAAW,KAAI,CAACoC,CAAL,CAAS,KAAI,CAACgF,CAAL,CAAS,CAAlB,CAAsBjL,aAAjC,EACNlC,CAAC,CAAC+F,MAAF,CAAW,KAAI,CAACoC,CAAL,CAAS,KAAI,CAACgF,CAAL,CAAS,CAAlB,CAAsBjL,aAD3B,EAENlC,CAAC,CAACiG,MAAF,CAAW,KAAI,CAACmC,CAAL,CAAS,KAAI,CAACgF,CAAL,CAAS,CAAlB,CAAsBlL,aAF3B,EAGNlC,CAAC,CAACiG,MAAF,CAAW,KAAI,CAACmC,CAAL,CAAS,KAAI,CAACgF,CAAL,CAAS,CAAlB,CAAsBlL,aAHnC,CAKH,CAND,CAOAgL,EAAE,CAACQ,kBAAH,CAAwB,UAAM,CAC1B,GAAIzM,UAAU,CAAC,KAAI,CAACsM,OAAN,CAAV,EAA4B,QAAhC,CAA0C,CACtC,KAAI,CAAChE,gBAAL,CAAwBvJ,CAAC,CAACyJ,IAAF,CAAOzJ,CAAC,CAAC+F,MAAT,CAAiB/F,CAAC,CAACiG,MAAnB,CAA2B,KAAI,CAACkC,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,IAAzC,CAA+C,KAAI,CAAC/E,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,GAA7D,EAAoE,EAA5F,CACA,KAAI,CAAC5D,oBAAL,CAA4BxJ,CAAC,CAACyJ,IAAF,CAAOzJ,CAAC,CAAC+F,MAAT,CAAiB/F,CAAC,CAACiG,MAAnB,CAA2B,KAAI,CAACkC,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,GAAzC,CAA8C,KAAI,CAAC/E,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,GAA5D,EAAmE,EAA/F,CACH,CACD,KAAI,CAAC9D,eAAL,CAAuBtJ,CAAC,CAACyJ,IAAF,CAAOzJ,CAAC,CAAC+F,MAAT,CAAiB/F,CAAC,CAACiG,MAAnB,CAA2B,KAAI,CAACkC,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,IAAzC,CAA+C,KAAI,CAAC/E,CAAL,CAAO,KAAI,CAACgF,CAAL,CAAO,GAA7D,EAAoE,EAA3F,CACH,CAND,CAOD,CAjOD,CAuOApN,CAAC,CAACwM,MAAF,CAAW,SAAC2B,GAAD,CAAQ,CAEjBA,GAAG,CAACrB,WAAJ,CAAkB,SAAC3D,WAAD,CAAcxI,SAAd,CAA4B,CAC5C,KAAI,CAACwI,WAAL,CAAmBA,WAAnB,CACA,KAAI,CAACxI,SAAL,CAAiBA,SAAjB,CAEA,KAAI,CAACwH,CAAL,CAAS,CAAT,CACA,KAAI,CAACC,CAAL,CAAS,CAAT,CACA,KAAI,CAAC+E,CAAL,CAASnN,CAAC,CAACoO,SAAF,CAAYjF,WAAZ,EAA2B,EAApC,CACA,KAAI,CAACiE,CAAL,CAASrL,WAAW,CAAG,EAAvB,CACA,KAAI,CAACsM,SAAL,CAAiB,GAAjB,CAEA,KAAI,CAACvF,MAAL,CAAc,CAAd,CACA,KAAI,CAACC,MAAL,CAAc,CAAd,CACD,CAZD,CAaAoF,GAAG,CAACtF,aAAJ,CAAoB,UAAM,CACxB,MAAQ7I,CAAAA,CAAC,CAAC+F,MAAF,CAAW,KAAI,CAACoC,CAAL,CAAS,KAAI,CAACgF,CAAL,CAAS,CAAlB,CAAsBjL,aAAjC,EACNlC,CAAC,CAAC+F,MAAF,CAAW,KAAI,CAACoC,CAAL,CAAS,KAAI,CAACgF,CAAL,CAAS,CAAlB,CAAsBjL,aAD3B,EAENlC,CAAC,CAACiG,MAAF,CAAW,KAAI,CAACmC,CAAL,CAAS,KAAI,CAACgF,CAAL,CAAS,CAAlB,CAAsBlL,aAF3B,EAGNlC,CAAC,CAACiG,MAAF,CAAW,KAAI,CAACmC,CAAL,CAAS,KAAI,CAACgF,CAAL,CAAS,CAAlB,CAAsBlL,aAHnC,CAID,CALD,CAOAiM,GAAG,CAACjC,OAAJ,CAAc,UAAM,CAClB,KAAI,CAAC/D,CAAL,CAAShG,SAAS,CAAG,GAAZ,CAAkB,KAAI,CAACgL,CAAL,CAAS,CAA3B,CAA+B,CAAxC,CACA,KAAI,CAAC/E,CAAL,CAASpI,CAAC,CAACgH,GAAF,CAAM,KAAI,CAACrG,SAAX,CAAsB,CAAtB,CAAyBD,OAAO,CAAC2G,MAAjC,CAAyCjF,SAAzC,CAAoDpC,CAAC,CAACgE,MAAF,CAAW5B,SAA/D,CAAT,CACA,KAAI,CAAC0G,MAAL,CAAc,KAAI,CAACX,CAAL,CAAS,KAAI,CAACgF,CAAL,CAAS,CAAlB,CAAsB,CAApC,CACA,KAAI,CAACpE,MAAL,CAAc,KAAI,CAACX,CAAL,CAAS,CAAvB,CACD,CALD,CAOA+F,GAAG,CAACxI,GAAJ,CAAU,UAAM,CACd,KAAI,CAAC2I,MAAL,GACA,KAAI,CAACX,OAAL,GACD,CAHD,CAKAQ,GAAG,CAACG,MAAJ,CAAa,UAAM,CAEjB,GAAI,KAAI,CAACzF,aAAL,IAAwBhH,oBAAoB,EAAI,CAApD,CAAuD,CACrD,KAAI,CAACwM,SAAL,CAAiB,GAAjB,CACD,CAFD,IAEO,CACL,KAAI,CAACA,SAAL,CAAiB,GAAjB,CACD,CAEF,CARD,CAUAF,GAAG,CAACR,OAAJ,CAAc,UAAM,CAGlB3N,CAAC,CAACsE,QAAF,CAAWvC,WAAX,EACA/B,CAAC,CAACuF,SAAF,CAAYvF,CAAC,CAACwF,IAAd,CAAoBxF,CAAC,CAACmE,MAAtB,EACAnE,CAAC,CAACuE,IAAF,CAAO,GAAP,CAAY,KAAI,CAAC8J,SAAjB,EACArO,CAAC,CAACkF,IAAF,CAAO,KAAI,CAACiD,CAAZ,CAAe,KAAI,CAACC,CAApB,CAAuB,KAAI,CAAC+E,CAA5B,CAA+B,KAAI,CAACC,CAApC,CAAuC,CAAvC,CAA0C,CAA1C,EACApN,CAAC,CAACuE,IAAF,CAAO,CAAP,CAAU,GAAV,EACAvE,CAAC,CAACmG,IAAF,CAAO,KAAI,CAACgD,WAAZ,CAAyB,KAAI,CAACL,MAA9B,CAAsC,KAAI,CAACC,MAA3C,EACD,CATD,CAYD,CAxDD,CA2DAwF,QAAQ,CAACC,aAAT,CAAyB,UAAW,CAClC,MAAO,MAAP,CACD,CAFD,CAKC","sourcesContent":["\nexport default function sketch(p){\n\nlet blank_spell_img, blank_creature_img, blank_weapon_img, full_blank_creature_img;\nlet bg;\nlet GAN_imgs = [];\nlet flavour_img, masked_flavour_ellipse, masked_flavour_rect;\n\n\nconst buttons = [];\nlet button_id = 0;\n\nconst effects = [];\n\nlet experiments = [\"mvw\", \"2mur\", \"longer_game\"];\nlet user = \"\"\n\nconst cards = [];\nconst card_num = 3;\nconst card_types = [\"spell\", \"minion\", \"weapon\"]\n\nconst method_names = [\"randomly\", \"targeted\", \"all\", \"aura\"];\nconst target_names = [\"minions\", \"heroes\", \"minions or heroes\", \"murlocs\", \"beasts\", \"demons\", \"totems\", \"weapons\"];\nconst target_names_singular = [\"minion\", \"hero\", \"minion or hero\", \"murloc\", \"beast\", \"demon\", \"totem\", \"weapon\"]\nconst filter_names = [\"enemy\", \"friendly\", \"all\"];\nconst duration_names = [\"turn\", \"permanently\"];\nconst param_format_names = [\"x\", \"x/x\", \"k\", \"c\"];\nconst effect_names = [\"Deal damage\", \"Destroy\", \"Heal\", \"Gain armour\", \"Change stats\", \"Set stats\", \"Give keyword\", \"Return to hand\", \"Draw\", \"Gain mana\", \"Summon: \", \"Battlecry: \", \"Deathrattle: \"]\nconst keywords = [\"Taunt\", \"Charge\", \"Lifesteal\", \"Spell damage +1\", \"Divine shield\", \"Poisonous\", \"Windfury\", \"Frozen\"]\nconst all_creature_types = [\"murloc\", \"beast\", \"demon\", \"totem\", \"dragon\", \"pirate\", \"mech\", \"elemental\"]\nconst creature_types = [\"Murloc\", \"Beast\", \"Demon\", \"Totem\"]\n\nconst survey_topics = [\"none\", \"methods\", \"filters\", \"targets\", \"duration\", \"params\"];\nlet current_survey_topic = 0;\n\nlet survey_drop_target = null;\n\n\nconst font_pixels = 24;\nconst smaller_font_size = 20;\nlet hearthstone_font;\nconst mouse_padding = 1;\nlet w_padding, h_padding;\nlet grid_w_padding, grid_h_padding;\n\nlet theMouse;\nlet hoveredOption = -1;\n\nlet editing = \"none\";\nlet editing_card = null;\nlet effect_to_remove = null;\nlet editX = 0;\nlet editY = 0;\n\nlet simCount = 3;\nlet simulating = false;\nlet simDuration = 2000;\nlet simTime = -simDuration;\n\nlet mouse_over_queuer;\n\nlet simResults = null;\nlet simTurns = null;\n\n\n\np.preload = () => {\n  blank_spell_img = p.loadImage(\"blank_cards/spell.png\");\n  blank_weapon_img = p.loadImage(\"blank_cards/weapon.png\")\n  blank_creature_img = p.loadImage(\"blank_cards/creature.png\")\n  full_blank_creature_img = p.loadImage(\"blank_cards/fullBlankCreature.png\");\n  \n  GAN_imgs.push(p.loadImage(\"gan_samples/sample_\"+p.floor(p.random(1000))+\".jpg\"));\n  flavour_img = p.random(GAN_imgs);\n\n  hearthstone_font = p.loadFont(\"BelweBoldBT.otf\");\n  bg = p.loadImage(\"../images/bigger_paper.jpg\");\n}\n\n\np.setup = () => {\n  p.createCanvas(p.windowWidth, p.windowHeight);\n  user = p.getURLParams().user;\n\n  h_padding = p.height * 0.1;\n  w_padding = p.width * 0.2;\n  grid_h_padding = p.height * 0.2;\n  grid_w_padding = p.width * 0.1;\n  p.imageMode(p.CENTER)\n  p.rectMode(p.CENTER);\n  p.textFont(hearthstone_font);\n  p.textSize(font_pixels);\n  p.fill(255);\n  p.noStroke();\n\n\n\n\n  theMouse = new p.FancyMouse();\n\n\n  p.register_all();\n\n\n  for (let i = 0; i < card_num; i++) {\n    cards.push(new p.Card(i, \"mvw\"));\n  }\n\n  p.resize_all();\n\n\n  let ellipse_mask = p.createGraphics(p.width, p.height);\n  p.ellipse_mask.ellipse(p.width / 2, p.height / 2+50, 900, 840)\n\n  let rect_mask = p.createGraphics(p.width, p.height);\n  p.rect_mask.rect(p.width / 2-450, p.height / 2 - 300, 900, 800)\n\n  masked_flavour_ellipse = flavour_img.get();\n  masked_flavour_ellipse.mask(ellipse_mask)\n  masked_flavour_rect = flavour_img.get();\n  masked_flavour_rect.mask(rect_mask)\n\n\n\n}\n\n\np.draw = () => {\n  p.background(255)\n  p.textAlign(p.LEFT, p.CENTER);\n  p.image(bg, p.width / 2, p.height / 2, p.width, p.height);\n\n  for (let c of cards) {\n    c.run();\n  }\n\n  for (let b of buttons) {\n    b.run();\n  }\n\n  if(theMouse.busy && current_survey_topic == 0){\n    p.push();\n    p.translate(p.mouseX-theMouse.xOffset, p.mouseY-theMouse.yOffset)\n    p.textSize(28)\n    p.text(theMouse.effect.label_name, 0, 0)\n    p.pop();\n  }\n\n  p.draw_edit_overlay();\n\n  p.sim_overlay();\n\n\n  if(survey_topics[current_survey_topic] != \"none\"){\n    p.draw_survey(); \n  }\n    \n}\n\n\n\np.draw_survey = () => {\n  p.push();\n  p.textAlign(p.CENTER, p.CENTER)\n  p.textSize(font_pixels)\n\n  p.rectMode(p.CENTER)\n  p.background(0, 100)\n\n  let setting = theMouse.effect.settings[survey_topics[current_survey_topic]]\n  let options = setting[0]\n\n    \n  if(setting[0][0] == \"x\"){\n    options = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];\n  } else if(setting[0][0] == \"k\"){\n    options = keywords\n  } else if(setting[0][0] == \"c\"){\n    options = creature_types;\n  }\n  \n\n  if(options[0] == \"x/x\"){\n    for(let attack = 1; attack < 11; attack++){\n      for(let defense = 1; defense < 11; defense++){\n        let xPos = p.map(attack, 1, 10, grid_w_padding, p.width-grid_w_padding);\n        let yPos = p.map(defense, 1, 10, grid_h_padding, p.height-grid_h_padding);\n        let boxWidth = (p.width-grid_w_padding*2)/10;\n        let boxHeight = (p.height-grid_h_padding*2)/10;\n\n        if(p.mouseX > xPos - boxWidth/2 && p.mouseX < xPos + boxWidth/2 &&\n          p.mouseY > yPos - boxHeight/2 && p.mouseY < yPos+boxHeight/2){\n              p.fill(255, 100);\n          } else {\n            p.fill(255, 0);\n          }\n          p.rect(xPos, yPos, boxWidth, boxHeight);\n          p.fill(255);\n          p.text(attack + \"/\" + defense, xPos, yPos-10)\n      }\n    }\n  } else {\n\n\n  p.textSize(40);\n  p.fill(255)\n  p.text(theMouse.effect.label_name + \"...\", p.width/2, p.height*0.1);\n\n  p.textSize(font_pixels)\n  p.rectMode(p.CENTER)\n\n  let optionButtonWidth = (p.width/options.length)*0.5;\n  let optionButtonHeight = p.height*0.10;\n  let optionButtonsPadding = p.width*0.25;\n\n  for(let [index, option] of options.entries()){\n    let xPos = p.map(index, 0, options.length-1, optionButtonsPadding, p.width-optionButtonsPadding);\n    if(p.mouseX > xPos-optionButtonWidth/2 && p.mouseX < xPos + optionButtonWidth/2){\n      p.fill(255, 100)\n      hoveredOption = index;\n    } else {\n      p.fill(255, 50)\n    }\n    p.rect(xPos, p.height*0.5, optionButtonWidth, optionButtonHeight, 16);\n    p.fill(255);\n\n    let optionString = option.toString();\n    optionString = optionString[0].toUpperCase() + optionString.substring(1)\n    optionString = optionString.split(\" \").join(\"\\n\");\n\n    p.text(optionString, xPos, p.height/2)\n  }\n}\n  \np.pop();\n}\n\n\np.mousePressedWhileSurveying = () => {\n  if(p.progressSurveyThroughIssues()){\n    return\n  }\n\n\n  let setting = theMouse.effect.settings[survey_topics[current_survey_topic]];\n  let options = setting[0]\n  if(options[0] == \"x\"){\n    options = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n  } else if (options[0] == \"k\"){\n    options = keywords;\n  } else if (options[0] == \"c\"){\n    options = creature_types;\n  }\n  \n  if(options[0] == \"x/x\"){\n    setting[1] = {x: p.floor(p.map(p.mouseX, 0, p.width, 1, 11)),\n                  y: p.floor(p.map(p.mouseY, 0, p.height, 1, 11))}\n  } else {\n    setting[1] = options[hoveredOption];\n  }\n  \n  current_survey_topic++;\n\n  if(p.progressSurveyThroughIssues()){\n    return\n  }\n\n}\n\n\np.mousePressedWhileNotSurveying = () => {\n  let clickedCard = null;\n\n  for (let c of cards) {\n    if (c.mouseInImg()) {\n      clickedCard = c;\n    }\n  }\n\n\n  if(clickedCard){\n    if(theMouse.busy){ //dropping effect onto a card\n      p.dropEffectOnCard(clickedCard)\n    } else { //clicking on a card generally\n      p.clickToEditCard(clickedCard)\n    }\n  } else {\n    if(theMouse.busy){ //clicked away to drop label\n      theMouse.busy = false;\n      theMouse.setOffset(0, 0);\n      theMouse.effect = null;\n    } else { //other clicks\n\n      if(mouse_over_queuer){\n        p.add_to_queue();\n      }\n\n      p.mouse_click_while_editing();\n      \n\n      for (let b of buttons) { //clicking on a button with an empty hand\n        if (b.mouseInRegion()) {\n          theMouse.busy = true;\n          theMouse.setOffset(b.text_x, b.text_y);\n          theMouse.effect = JSON.parse(JSON.stringify(effects[b.button_name]));\n\n          break;\n        }\n      }\n    }\n  }\n\n}\n\n\n\n//returns true if you need to return out of mouse\np.progressSurveyThroughIssues = () => {\n  if(current_survey_topic == survey_topics.length){\n    p.finished_survey();\n    return true;\n  }\n\n  for(let i = 0; i < survey_topics.length; i++){\n    if(theMouse.effect.settings[survey_topics[current_survey_topic]][0] == null ||\n      (!param_format_names.includes(theMouse.effect.settings[survey_topics[current_survey_topic]][0][0]) &&\n       theMouse.effect.settings[survey_topics[current_survey_topic]][0].length == 1)){\n      current_survey_topic++;\n      if(current_survey_topic == survey_topics.length){\n        p.finished_survey();\n        return true;\n      }\n    }\n  }\n\n\n  if(current_survey_topic == survey_topics.length){\n    p.finished_survey();\n    return true;\n  }\n\n\n  return false;\n}\n\np.dropEffectOnCard = (c) => {\n    current_survey_topic = 1;\n    survey_drop_target = c;\n\n    if(p.progressSurveyThroughIssues()){\n\n      return\n    }\n}\n\n\np.clickToEditCard = (c) => {\n\n  if(c.mouse_over_mana){\n    editing = \"mana\";\n    editing_card = c;\n  } else if(c.mouse_over_power){\n    editing = \"power\";\n    editing_card = c;\n  } else if(c.mouse_over_toughness && !(editing ==\"effect\" && p.dist(p.mouseX, p.mouseY, editX, editY) < 10)){\n    editing = \"toughness\";\n    editing_card = c;\n  } else if(c.mouse_over_card_effect && !(editing ==\"effect\" && p.dist(p.mouseX, p.mouseY, editX, editY) < 10 )){\n    editing = \"effect\";\n    editX = c.hovered_effect.x + blank_spell_img.width/2;\n    editY = c.hovered_effect.y + c.hovered_effect.effect_string_height/2;\n    editing_card = c;\n    effect_to_remove = c.hovered_effect;\n   } else if(editing==\"effect\" && p.dist(p.mouseX, p.mouseY, editX, editY) < 10){\n      editing_card.effects.splice(editing_card.effects.indexOf(effect_to_remove), 1);\n      editing = \"none\";\n    } else {\n    editing = \"none\";\n  }\n}\n\n\np.mouse_click_while_editing = () => {\n  if(editing == \"mana\"){\n    if(p.dist(p.mouseX, p.mouseY, editX-60, editY-50)<40){\n      editing_card.mana--;\n    } else if(p.dist(p.mouseX, p.mouseY, editX+60, editY-50)<40){\n      editing_card.mana++;\n    } else {\n      editing = \"none\"\n    }\n    editing_card.mana = p.constrain(editing_card.mana, 0, 10)\n  } else if(editing == \"power\"){\n\n    if(p.dist(p.mouseX, p.mouseY, editX-60, editY+50)<40){\n      editing_card.power--;\n    } else if(p.dist(p.mouseX, p.mouseY, editX+60, editY+50)<40){\n      editing_card.power++;\n    } else {\n      editing = \"none\"\n    }\n    editing_card.power = p.constrain(editing_card.power, 0, 10)\n  } else if(editing == \"toughness\"){\n\n    if(p.dist(p.mouseX, p.mouseY, editX-60, editY+50)<40){\n      editing_card.toughness--;\n    } else if(p.dist(p.mouseX, p.mouseY, editX+60, editY+50)<40){\n      editing_card.toughness++;\n    } else {\n      editing = \"none\"\n    }\n    editing_card.toughness = p.constrain(editing_card.toughness, 1, 10)\n  } else if(editing = \"effect\"){\n    editing = \"none\";\n  }\n} \n\n\np.draw_edit_overlay = () => {\n  p.push();\n  if(editing != \"none\"){\n    p.translate(editX, editY)\n    p.noStroke();\n    if(editing==\"effect\"){\n      p.rotate(p.QUARTER_PI);\n      p.fill(0);\n      p.rect(0, 0, 22, 6);\n      p.rect(0, 0, 6, 22);\n      p.fill(255);\n      p.rect(0, 0, 20, 4);\n      p.rect(0, 0, 4, 20);\n \n    } else {\n      p.fill(0);\n      p.rect(-60, editing==\"mana\"?-50:75, 32, 8);\n      p.rect(60, editing==\"mana\"?-50:75, 32, 8);\n      p.rect(60, editing==\"mana\"?-50:75, 8, 32);\n      p.fill(255);\n      p.rect(-60, editing==\"mana\"?-50:75, 30, 6);\n      p.rect(60, editing==\"mana\"?-50:75, 30, 6);\n      p.rect(60, editing==\"mana\"?-50:75, 6, 30);\n    }\n  }\n  p.pop();\n}\n\np.mousePressed = () => {\n\n  if(survey_topics[current_survey_topic] != \"none\"){\n    p.mousePressedWhileSurveying();\n  } else {\n    p.mousePressedWhileNotSurveying();\n  }\n}\n\np.finished_survey = () => {\n\n  survey_drop_target.effects.push(JSON.parse(JSON.stringify(theMouse.effect)))\n  current_survey_topic = 0;\n  theMouse.effect = null;\n  theMouse.busy = false;\n}\n\np.keyPressed = () => {\n  if (p.key == ' ' && !simulating) {\n    simResults = null;\n    simTurns = null;\n    simulating = true;\n    simTime = simCount;\n    p.submit();\n  }\n\n}\n\np.windowResized = () => {\n  p.resizeCanvas(p.windowWidth, p.windowHeight);\n  p.resize_all();\n}\n\np.add_to_queue = () => {\n  if(!simulating){\n    simulating = true;\n    simTime = p.millis();\n    p.submit();\n  }\n}\n\np.sim_overlay = () => {\n  p.push();\n  let queur_x = p.map(2, 0, 3, w_padding, p.width-w_padding);\n  let queur_y = p.height*0.85\n  mouse_over_queuer = (p.mouseX > queur_x - 100 && p.mouseX < queur_x + 100 && p.mouseY > queur_y-30 && p.mouseY < queur_y+30)\n\n  p.translate(queur_x, queur_y);\n\n  if(mouse_over_queuer && !simulating){\n    p.fill(255, 255);\n  } else {\n    p.fill(p.map(p.millis(), simTime, simTime+simDuration, 100, 255, true), 100)\n  } \n  p.rect(0, 0, 200, 60, 4)\n\n\n  p.fill(0, 255);\n  p.textAlign(p.CENTER, p.CENTER)\n  p.text(simulating?\"Adding...\":\"Add to queue\", 0, -4)\n\n  p.rectMode(p.CORNER)\n\n  // if(simulating)\n  // p.fill(0)\n  // p.rect(-100, -30, map(millis(), simTime, simTime+simDuration, 0, 200, true), 60, 4)\n\n\n  p.pop();\n\n  if(simulating){\n    if(p.millis() > simTime+simDuration){\n      simulating = false;\n    }\n  }\n  // if (simulating) {\n  //   simTime = constrain(simTime - random(0.001, 0.002), 0, simCount);\n\n  //   let lw = map(simTime, 0, simCount, 0, 200);\n  //   noStroke();\n  //   p.fill(200);\n  //   p.rect(width * 0.5 - 100, height * 0.85 - 16, 200, 40)\n  //   p.fill(0)\n  //   p.rect(width * 0.5 - 100, height * 0.85 - 16, lw, 40)\n  //   p.fill(255);\n  //   text(\"Simulating...\", width * 0.5, height * 0.85)\n  // } else {\n  //   text(\"Press Spacebar to simulate\", width / 2, height * 0.9);\n  // }\n\n  // if (simResults != null) {\n\n  //   text(\"The win rate with your card is: \" + simResults +\n  //     \"%\\n\" + \"The average game lasted \" + simTurns +\n  //     \" turns.\", width * 0.5, height * 0.10);\n  // }\n}\n\np.submit = () => {\n  let submissions = [];\n  for(let c of cards){\n\n    let card_submission = {\n      id: c.card_id,\n      exp: c.card_experiment,\n      user: user,\n      p: c.power,\n      t: c.toughness,\n      m: c.mana,\n\n    }\n\n    \n    let repeat_checker = {};\n\n    for (let e of c.effects) {\n      if(repeat_checker[e.effect_short] == undefined){\n        repeat_checker[e.effect_short] = 0;\n      } else {\n        repeat_checker[e.effect_short]++;\n      }\n\n      if(e.settings.methods[0] != null) card_submission[e.effect_short+\"-method-\"+repeat_checker[e.effect_short]] = e.settings.methods[1];\n      if(e.settings.params[0] != null) card_submission[e.effect_short+\"-param-\"+repeat_checker[e.effect_short]] = e.settings.params[1];\n      if(e.settings.targets[0] != null) card_submission[e.effect_short+\"-target-\"+repeat_checker[e.effect_short]] = e.settings.targets[1];\n      if(e.settings.filters[0] != null) card_submission[e.effect_short+\"-filter-\"+repeat_checker[e.effect_short]] = e.settings.filters[1];\n      if(e.settings.duration[0] != null) card_submission[e.effect_short+\"-duration-\"+repeat_checker[e.effect_short]] = e.settings.duration[1];\n\n    }\n    submissions[c.card_experiment+\"-\"+c.card_id] = card_submission;\n }\n\n\n p.send_to_google_sheets(submissions);\n\n}\n\n\np.send_to_google_sheets = (submissions) => {\n\n  for(let submission of submissions){\n\n    \n  }\n\n  // gapi.load('client', ()=>{\n  //   gapi.client.init({ 'apiKey':  config.sheets_api_key}).then(()=>{\n  //     gapi.client.sheets.spreadsheets.values.get({\n  //       spreadsheetId: config.sheet_id,\n  //       range: \"queue!A1:D5\"\n  //     }).then((response) => {\n  //       var result = response.result;\n  //       var numRows = result.values ? result.values.length : 0;\n  //       console.log(`${numRows} rows retrieved.`);\n  //     });\n  //   }); \n  // });\n\n\n\n\n\n\n\n  // httpPost('https://hearth-mici-backend.loca.lt/get_winrates', submission, (response) => {\n  //   simulating = false;\n  //   simResults = round(JSON.parse(response).win_rate, 2);\n  //   simTurns = round(JSON.parse(response).num_turns, 2);\n  //   console.log(simResults, simTurns)\n  // });\n\n\n  // httpPost('https://sheets.googleapis.com/v4/spreadsheets/1TlgFYV4zwkyfwGq1DNU39Sq1kOsOaL3jfppokpmgX0w/values/queue!A1:E1:append?key='+config.sheets_api_key, {\n  //   range: \"queue!A1:E1\",\n  //   key: config.sheets_api_key,\n  //   majorDimension: \"ROWS\",\n  //   values: [\n  //     [\"Door\", \"$15\", \"2\", \"3/15/2016\"],\n  //     [\"Engine\", \"$100\", \"1\", \"3/20/2016\"],\n  //   ],\n  // }, (response) => {\n  //   console.log(response)\n  // });\n\n}\n\np.resize_all = () => {\n  for (let b of buttons) {\n    b.resized();\n  }\n\n  for (let c of cards) {\n    c.resized();\n  }\n\n}\n\np.register_effect = (effect_text, effect_short, method, param, targets, filters, duration) => {\n\n  effects[effect_text] = new p.Effect(effect_text, effect_short, method, param, targets, filters, duration);\n  buttons.push(new p.Button(effect_text, button_id++));\n}\n\np.register_all = () => {\n\n  p.register_effect(\"Deal damage\", \"dam\",\n    [\"randomly\", \"targeted\", \"all\"],\n    [\"x\"],\n    [\"minions\", \"heroes\", \"minions or heroes\", \"murlocs\", \"beasts\", \"demons\", \"totems\"],\n    [\"enemy\", \"friendly\", \"all\"],\n    null);\n\n  p.register_effect(\"Destroy\", \"des\",\n    [\"randomly\", \"targeted\", \"all\"],\n    null,\n    [\"minions\", \"murlocs\", \"beasts\", \"demons\", \"totems\", \"weapons\"],\n    [\"enemy\", \"friendly\", \"all\"],\n    null);\n\n  p.register_effect(\"Heal\", \"hea\",\n    [\"randomly\", \"targeted\", \"all\"],\n    [\"x\"],\n    [\"minions\", \"heroes\", \"minions or heroes\", \"murlocs\", \"beasts\", \"demons\", \"totems\"],\n    [\"enemy\", \"friendly\", \"all\"],\n    null);\n\n  p.register_effect(\"Gain armour\", \"arm\",\n    null,\n    [\"x\"],\n    null,\n    null,\n    null);\n\n  p.register_effect(\"Change stats\", \"cha\",\n    [\"randomly\", \"targeted\", \"all\", \"aura\"],\n    [\"x/x\"],\n    [\"minions\", \"heroes\", \"minions or heroes\", \"murlocs\", \"beasts\", \"demons\", \"totems\", \"weapons\"],\n    [\"enemy\", \"friendly\", \"all\"],\n    [\"turn\", \"permanently\"]);\n\n  p.register_effect(\"Set stats\", \"set\",\n    [\"randomly\", \"targeted\", \"all\", \"aura\"],\n    [\"x/x\"],\n    [\"minions\", \"heroes\", \"minions or heroes\", \"murlocs\", \"beasts\", \"demons\", \"totems\", \"weapons\"],\n    [\"enemy\", \"friendly\", \"all\"],\n    [\"turn\", \"permanently\"]);\n\n\n  p.register_effect(\"Give keyword\", \"giv\",\n    [\"randomly\", \"targeted\", \"all\", \"aura\"],\n    [\"k\"],\n    [\"minions\", \"heroes\", \"minions or heroes\", \"murlocs\", \"beasts\", \"demons\", \"totems\", \"weapons\"],\n    [\"enemy\", \"friendly\", \"all\"],\n    [\"turn\", \"permanently\"]);\n\n  p.register_effect(\"Return to hand\", \"ret\",\n    [\"randomly\", \"targeted\", \"all\"],\n    null,\n    [\"minions\", \"murlocs\", \"beasts\", \"demons\", \"totems\"],\n    [\"enemy\", \"friendly\", \"all\"],\n    null);\n\n\n  p.register_effect(\"Draw\", \"dra\",\n    null,\n    [\"x\"],\n    null,\n    [\"enemy\", \"friendly\", \"all\"],\n    null);\n\n\n  p.register_effect(\"Gain mana\", \"gai\",\n    null,\n    [\"x\"],\n    null,\n    [\"enemy\", \"friendly\", \"all\"],\n    null);\n\n  p.register_effect(\"Summon\", \"sum\",\n    null,\n    [\"x/x\"],\n    null,\n    null,\n    null);\n\n    p.register_effect(\"Keyword\", \"key\",\n    null,\n    [\"k\"],\n    null,\n    null,\n    null);\n\n    p.register_effect(\"Creature type\", \"cre\",\n    null,\n    [\"c\"],\n    null,\n    null,\n    null);\n\n\n\n}\n\n\np.FancyMouse = (fm) => {\n  fm.constuctor = () => {\n    this.busy = false;\n    this.xOffset = 0;\n    this.yOffset = 0;\n    this.effect = null;\n  }\n  fm.setOffset = (buttonX, buttonY) => {\n    this.xOffset = p.mouseX - buttonX;\n    this.yOffset = p.mouseY - buttonY;\n  }\n}\n\n\n\n\n\np.Effect = (ef) => {\n  ef.constructor = (label_name,effect_short,methods, param_format, targets, filters, duration) => {\n    this.x = 0;\n    this.y = 0;\n\n    this.effect_string = \"\";\n    this.effect_string_height = 0;\n    this.effect_string_width = blank_spell_img.width * 0.5;\n    this.label_name = label_name;\n    this.effect_short = effect_short;\n\n    this.settings = {\n      methods: [methods, \"\"],\n      params: [param_format, \"\"],\n      targets: [targets, \"\"],\n      filters: [filters, \"\"],\n      duration: [duration, \"\"]\n    };\n  }\n}\n\n\np.Card = (cd) => {\n  cd.constructor = (card_id, card_experiment) => {\n      this.y = 0;\n      this.x = 0;\n      this.w = blank_spell_img.width * 0.75;\n      this.h = blank_spell_img.height * 0.75;\n      this.oversized = false;\n\n\n      this.class = \"mage\";\n      this.type_id = 1;\n      this.card_id = card_id;\n      this.card_experiment = card_experiment;\n\n      this.creature_type = \"\";\n      this.mana = 5;\n      this.power = 5;\n      this.toughness = 5;\n      this.keywords = [];\n      this.effects = [];\n\n      this.hovered_effect = null;\n      this.mouse_over_card_effect = false;\n      this.mouse_over_mana = false;\n      this.mouse_over_power = false;\n      this.mouse_over_toughness = false;\n\n\n  }\n\n  cd.resized = () => {\n      this.x = p.map(this.card_id + 1, 0, cards.length, w_padding, p.width - w_padding)\n      this.y = p.height / 2;\n  }\n\n  cd.run = () => {\n      this.generate_effect_text();\n      this.check_mouse_hovers();\n      this.display();\n  }\n\n  cd.generate_effect_text = () => {\n      for (let e of this.effects) {\n          e.effect_string = \"\";\n          if(e.label_name == \"Keyword\" || e.label_name == \"Creature type\"){\n              e.effect_string = e.settings.params[1];\n          } else if(e.label_name == \"Deal damage\"){\n              if(e.settings.methods[1] == \"randomly\"){\n                  e.effect_string = \"Randomly deal \" + e.settings.params[1] + \" damage to a \";\n              } else if(e.settings.methods[1] == \"targeted\"){\n                  e.effect_string = \"Deal \" + e.settings.params[1] + \" damage to target \";\n              } else {\n                  e.effect_string = \"Deal \" + e.settings.params[1] + \" damage to all \"\n              }\n\n              e.effect_string += e.settings.filters[1]==\"all\"?\"\":e.settings.filters[1] + \" \" //remove \"all all\"\n              if(e.settings.methods[1] == \"all\"){\n                  e.effect_string += e.settings.targets[1]\n              } else {\n                  e.effect_string += target_names_singular[target_names.indexOf(e.settings.targets[1])]\n              }\n          } else if(e.label_name ==\"Destroy\"){\n              if(e.settings.methods[1] == \"randomly\"){\n                  e.effect_string = \"Randomly destroy a \";\n              } else if(e.settings.methods[1] == \"targeted\"){\n                  e.effect_string = \"Destroy a target \";\n              } else {\n                  e.effect_string = \"Destroy all \"\n              }\n              e.effect_string += e.settings.filters[1]==\"all\"?\"\":e.settings.filters[1] + \" \" //remove \"all all\"\n              if(e.settings.methods[1] == \"all\"){\n                  e.effect_string += e.settings.targets[1]\n              } else {\n                  e.effect_string += target_names_singular[target_names.indexOf(e.settings.targets[1])]\n              }\n          } else if(e.label_name ==\"Heal\"){\n              if(e.settings.methods[1] == \"randomly\"){\n                  e.effect_string = \"Restore \" + e.settings.params[1] + \" health to a random \";\n              } else if(e.settings.methods[1] == \"targeted\"){\n                  e.effect_string = \"Restore \" + e.settings.params[1] + \" health to a target \";\n              } else {\n                  e.effect_string = \"Restore \" + e.settings.params[1] + \" health to all \";\n              }\n              e.effect_string += e.settings.filters[1]==\"all\"?\"\":e.settings.filters[1] + \" \" //remove \"all all\"\n              if(e.settings.methods[1] == \"all\"){\n                  e.effect_string += e.settings.targets[1]\n              } else {\n                  e.effect_string += target_names_singular[target_names.indexOf(e.settings.targets[1])]\n              }                \n          } else {\n              e.effect_string = e.label_name\n          }\n\n          \n\n          let estimatedCharactersPerLine = 20;\n          let estimatedLines =  e.effect_string.length/estimatedCharactersPerLine;\n          e.effect_string_height = smaller_font_size * estimatedLines + 30;\n          \n      }\n\n  }\n\n  cd.display = () => {\n    p.push();\n    p.fill(0);\n    p.textAlign(p.CENTER, p.CENTER)\n      if(this.effects.length > 2){\n          this.oversized = true;\n      } else {\n          this.oversized = false;\n      }\n      let flav;\n      let forg;\n\n      if (card_types[this.type_id] == \"spell\") {\n          flav = masked_flavour_rect;\n          forg = blank_spell_img;\n      } else if (card_types[this.type_id] == \"minion\") {\n          flav = masked_flavour_ellipse;\n          forg = this.oversized ? full_blank_creature_img:blank_creature_img;\n      } else {\n          flav = masked_flavour_rect;\n          forg = blank_weapon_img;\n      }\n\n      if(!this.oversized){\n        p.image(flav, this.x + 5, this.y - 50, 300, 300)\n      }\n      p.image(forg, this.x, this.y, this.w, this.h);\n\n      p.push();\n      p.textSize(60);\n      p.fill(255);\n      p.strokeWeight(3);\n      p.stroke(0);\n\n      if (card_types[this.type_id] == \"minion\") {\n        p.text(this.power, this.x-this.w/2.99, this.y+this.h/2.8)\n        p.text(this.toughness, this.x+this.w/2.6, this.y+this.h/2.8)\n      }\n\n    \n      p.text(this.mana, this.x-this.w/2.99, this.y-this.h/2.3)\n     \n      p.pop();\n\n     \n      p.push();\n      p.fill(0);\n      p.textSize(smaller_font_size);\n      let translation_offset_y;\n      if(this.oversized){\n          translation_offset_y = this.y - this.h/2 + 80;\n          p.translate(this.x, this.y - this.h/2 + 80);\n      } else {\n          translation_offset_y = this.y  + 50;\n          p.translate(this.x, this.y + 50);\n      }\n      \n      this.mouse_over_card_effect = false;\n      this.hovered_effect = null;\n      for(let e of this.effects){\n          \n          translation_offset_y += e.effect_string_height/2;\n          p.translate(0, e.effect_string_height/2)\n\n          if(p.mouseY > translation_offset_y - e.effect_string_height/2 &&\n            p.mouseY < translation_offset_y + e.effect_string_height/2 &&\n            p.mouseX > this.x - e.effect_string_width/2 &&\n            p.mouseX < this.x + e.effect_string_width/2){\n\n              this.mouse_over_card_effect = true;\n\n              this.hovered_effect = e;\n              this.hovered_effect.x = this.x - e.effect_string_width/2;\n              this.hovered_effect.y = translation_offset_y - e.effect_string_height;\n              p.fill(0, 100);\n          } else {\n              p.fill(0, 50)\n          }\n\n          p.rect(0, 0, e.effect_string_width, e.effect_string_height, 4, 4)\n          p.fill(255, 255)\n          p.text(e.effect_string, 0, 0, blank_spell_img.width/2, blank_spell_img.height/2)\n          translation_offset_y += e.effect_string_height/2+5;\n          p.translate(0, e.effect_string_height/2+5)\n\n      }\n      p.pop();\n\n\n      p.push();\n\n      if(editing_card == this){\n          if(editing == \"mana\"){\n              editX = this.x-this.w/2.99;\n              editY = this.y-this.h/2.3;\n          } else if(editing == \"power\"){\n              editX = this.x-this.w/2.99;\n              editY = this.y+this.h/2.8;\n          } else if(editing == \"toughness\"){\n              editX = this.x+this.w/2.6;\n              editY = this.y+this.h/2.8;\n          } \n      }\n\n      p.pop();\n  }\n\n\n  cd.mouseInImg = () => {\n      return (p.mouseX > this.x - this.w / 2 - mouse_padding &&\n        p.mouseX < this.x + this.w / 2 + mouse_padding &&\n        p.mouseY > this.y - this.h / 2 - mouse_padding &&\n        p.mouseY < this.y + this.h / 2 + mouse_padding);\n\n  }\n  cd.check_mouse_hovers = () => {\n      if (card_types[this.type_id] == \"minion\") {\n          this.mouse_over_power = p.dist(p.mouseX, p.mouseY, this.x-this.w/2.99, this.y+this.h/2.8) < 50\n          this.mouse_over_toughness = p.dist(p.mouseX, p.mouseY, this.x+this.w/2.6, this.y+this.h/2.8) < 50\n      }\n      this.mouse_over_mana = p.dist(p.mouseX, p.mouseY, this.x-this.w/2.99, this.y-this.h/2.3) < 50\n  }\n}\n\n\n\n\n\np.Button = (btn) =>{\n\n  btn.constructor = (button_name, button_id) => {\n    this.button_name = button_name;\n    this.button_id = button_id;\n\n    this.x = 0;\n    this.y = 0;\n    this.w = p.textWidth(button_name) + 14;\n    this.h = font_pixels + 10;\n    this.fillAlpha = 100;\n\n    this.text_x = 0;\n    this.text_y = 0;\n  }\n  btn.mouseInRegion = () => {\n    return (p.mouseX > this.x - this.w / 2 - mouse_padding &&\n      p.mouseX < this.x + this.w / 2 + mouse_padding &&\n      p.mouseY > this.y - this.h / 2 - mouse_padding &&\n      p.mouseY < this.y + this.h / 2 + mouse_padding);\n  }\n\n  btn.resized = () => {\n    this.x = w_padding - 150 + this.w / 2 - 7;\n    this.y = p.map(this.button_id, 0, buttons.length, h_padding, p.height - h_padding);\n    this.text_x = this.x - this.w / 2 + 7;\n    this.text_y = this.y - 6;\n  }\n\n  btn.run = () => {\n    this.update();\n    this.display();\n  }\n\n  btn.update = () => {\n\n    if (this.mouseInRegion() && current_survey_topic == 0) {\n      this.fillAlpha = 255;\n    } else {\n      this.fillAlpha = 100;\n    }\n\n  }\n\n  btn.display = () => {\n\n\n    p.textSize(font_pixels)\n    p.textAlign(p.LEFT, p.CENTER)\n    p.fill(255, this.fillAlpha);\n    p.rect(this.x, this.y, this.w, this.h, 4, 4);\n    p.fill(0, 255);\n    p.text(this.button_name, this.text_x, this.text_y);\n  }\n\n  \n}\n\n\ndocument.oncontextmenu = function() {\n  return false;\n}\n\n\n}"]},"metadata":{},"sourceType":"module"}